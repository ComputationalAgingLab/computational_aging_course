
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>DOSI construction using Cox Proportional Hazards Model &#8212; Computational aging book</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../_static/symbol.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Computational aging book</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    Welcome to the Computational Biology of Aging coursebook
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Biology of Aging
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../bio/intro_aging_biology.html">
   1. Introduction to Aging Biology
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Statistical view
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../stat/differential_analysis_practice.html">
   2. Differential expression analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../stat/survival_analysis.html">
   3. Survival analysis
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Machine learning view
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../ml/aging_clocks.html">
   4. Aging Clocks
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Dynamic system view
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../dyn/complex_systems.html">
   5. Complex systems approach
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../dyn/system_resilience.html">
   6. System resilience
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Student projects
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../template.html">
   7. Project report template
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="simple">
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/ComputationalAgingLab/computational_aging_course/master?urlpath=tree/projects/2023/dosi/code.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/ComputationalAgingLab/computational_aging_course"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/ComputationalAgingLab/computational_aging_course/issues/new?title=Issue%20on%20page%20%2Fprojects/2023/dosi/code.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../../_sources/projects/2023/dosi/code.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   DOSI construction using Cox Proportional Hazards Model
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-preparation">
     Data preparation
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#get-cbc-data">
       Get CBC data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#get-age-and-sex-data">
       Get Age and Sex data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#merge-cbc-age-and-sex-data-using-patients-ids">
       Merge CBC, Age and Sex data using patients ids
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#get-rid-of-patients-with-nans-as-in-the-article">
       Get rid of patients with Nans (as in the article)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#converting-white-blood-cell-percentages-into-cell-counts-as-in-the-article">
       Converting white blood cell percentages into cell counts (as in the article)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#get-mortality-data">
       Get mortality data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#merge-mortality-data-with-previous-patients-data-using-patients-ids">
       Merge mortality data with previous patients data using patients ids
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#log-transformation-of-cbc-parameters-as-in-the-article">
       log-transformation of CBC parameters (as in the article)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#train-test-split-as-in-the-article">
       Train-test split as in the article:
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#scaling">
       Scaling
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-pca">
     1A: PCA
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cox">
     Cox
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#train-test-split">
       Train-test split
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#evaluation-metrics">
       Evaluation metrics
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#cox-predictions-for-all-patients">
       Cox predictions for all patients
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#get-weight-data">
       Get weight data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dosi-log-hazards">
       DOSI = log-hazards
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#body-mass-and-treoretical-projectory">
       Body mass and treoretical projectory
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#b-hazard-and-bogy-mass-on-one-plot">
       1B: Hazard and bogy mass on one plot
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#frialty-investigation">
   Frialty investigation
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Data preparation
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#get-frial-data">
       Get frial data
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#c-distribution-of-dosi-in-cohorts-by-frialty">
     1C: Distribution of DOSI in cohorts by frialty
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#normalization-of-dosi-by-age-sex-group">
       Normalization of DOSI by age- sex- group
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-excess-dosi-depends-on-frail-fraction">
     2A: Excess DOSI depends on frail fraction
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-frail-fraction-depends-on-age">
     2B: Frail fraction depends on age
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dosi-level-depends-on-smoking-habits">
     2С: DOSI level depends on smoking habits
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#d-distribution-of-the-inverse-variance-of-dosi-and-activity">
     3D: Distribution of the inverse variance of DOSI and activity
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#add-steps-data">
       Add steps data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#add-age-column-number-of-diagnosis">
       Add age column, number of diagnosis
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#log-transformation-removement-of-most-frial">
       Log-transformation, removement of most frial
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plotting-steps">
       Plotting steps
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plotting-dosi">
       Plotting DOSI
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lifespan-prediction">
       Lifespan prediction
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>DOSI construction using Cox Proportional Hazards Model</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   DOSI construction using Cox Proportional Hazards Model
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-preparation">
     Data preparation
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#get-cbc-data">
       Get CBC data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#get-age-and-sex-data">
       Get Age and Sex data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#merge-cbc-age-and-sex-data-using-patients-ids">
       Merge CBC, Age and Sex data using patients ids
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#get-rid-of-patients-with-nans-as-in-the-article">
       Get rid of patients with Nans (as in the article)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#converting-white-blood-cell-percentages-into-cell-counts-as-in-the-article">
       Converting white blood cell percentages into cell counts (as in the article)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#get-mortality-data">
       Get mortality data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#merge-mortality-data-with-previous-patients-data-using-patients-ids">
       Merge mortality data with previous patients data using patients ids
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#log-transformation-of-cbc-parameters-as-in-the-article">
       log-transformation of CBC parameters (as in the article)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#train-test-split-as-in-the-article">
       Train-test split as in the article:
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#scaling">
       Scaling
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-pca">
     1A: PCA
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cox">
     Cox
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#train-test-split">
       Train-test split
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#evaluation-metrics">
       Evaluation metrics
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#cox-predictions-for-all-patients">
       Cox predictions for all patients
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#get-weight-data">
       Get weight data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dosi-log-hazards">
       DOSI = log-hazards
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#body-mass-and-treoretical-projectory">
       Body mass and treoretical projectory
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#b-hazard-and-bogy-mass-on-one-plot">
       1B: Hazard and bogy mass on one plot
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#frialty-investigation">
   Frialty investigation
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Data preparation
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#get-frial-data">
       Get frial data
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#c-distribution-of-dosi-in-cohorts-by-frialty">
     1C: Distribution of DOSI in cohorts by frialty
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#normalization-of-dosi-by-age-sex-group">
       Normalization of DOSI by age- sex- group
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-excess-dosi-depends-on-frail-fraction">
     2A: Excess DOSI depends on frail fraction
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-frail-fraction-depends-on-age">
     2B: Frail fraction depends on age
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dosi-level-depends-on-smoking-habits">
     2С: DOSI level depends on smoking habits
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#d-distribution-of-the-inverse-variance-of-dosi-and-activity">
     3D: Distribution of the inverse variance of DOSI and activity
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#add-steps-data">
       Add steps data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#add-age-column-number-of-diagnosis">
       Add age column, number of diagnosis
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#log-transformation-removement-of-most-frial">
       Log-transformation, removement of most frial
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plotting-steps">
       Plotting steps
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plotting-dosi">
       Plotting DOSI
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lifespan-prediction">
       Lifespan prediction
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">join</span>
<span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/shappiron/Desktop/CAL/computational_aging_course/projects/2023/dosi
</pre></div>
</div>
</div>
</div>
<section id="dosi-construction-using-cox-proportional-hazards-model">
<h1>DOSI construction using Cox Proportional Hazards Model<a class="headerlink" href="#dosi-construction-using-cox-proportional-hazards-model" title="Permalink to this headline">#</a></h1>
<section id="data-preparation">
<h2>Data preparation<a class="headerlink" href="#data-preparation" title="Permalink to this headline">#</a></h2>
<section id="get-cbc-data">
<h3>Get CBC data<a class="headerlink" href="#get-cbc-data" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;.../CBC/&#39;</span>
<span class="n">files</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sas</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
    <span class="n">data_new</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sas</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file</span><span class="p">)))</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">data</span><span class="p">,</span> <span class="n">data_new</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;.../CBC/&#39;</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">files</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="nb">print</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sas</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;.../CBC/&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Choose covariates as in the article:</span>

<span class="n">studied</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;SEQN&quot;</span><span class="p">,</span> <span class="s2">&quot;LBXWBCSI&quot;</span><span class="p">,</span> <span class="s2">&quot;LBXHGB&quot;</span><span class="p">,</span> <span class="s2">&quot;LBXRBCSI&quot;</span><span class="p">,</span> <span class="s2">&quot;LBXMCVSI&quot;</span><span class="p">,</span> <span class="s2">&quot;LBXMC&quot;</span><span class="p">,</span> <span class="s2">&quot;LBXRDW&quot;</span><span class="p">,</span> <span class="s2">&quot;LBXPLTSI&quot;</span><span class="p">,</span> <span class="s2">&quot;LBXNEPCT&quot;</span><span class="p">,</span> <span class="s2">&quot;LBXLYPCT&quot;</span><span class="p">,</span> <span class="s2">&quot;LBXMOPCT&quot;</span><span class="p">,</span> <span class="s2">&quot;LBXEOPCT&quot;</span><span class="p">]</span>
<span class="n">data_CBC</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">studied</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;SEQN&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data_CBC</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>


<span class="c1"># Chech if some patients occur more than once in data:</span>

<span class="n">data_CBC</span><span class="p">[</span><span class="s2">&quot;SEQN&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(74900, 12)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(74900,)
</pre></div>
</div>
</div>
</div>
</section>
<section id="get-age-and-sex-data">
<h3>Get Age and Sex data<a class="headerlink" href="#get-age-and-sex-data" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path2</span> <span class="o">=</span> <span class="s1">&#39;.../Age_sex/&#39;</span>
<span class="n">files2</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">files2</span><span class="p">)</span>

<span class="n">data2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sas</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">path2</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">files2</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
<span class="k">for</span> <span class="n">file2</span> <span class="ow">in</span> <span class="n">files2</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
    <span class="n">data_new2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sas</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">path2</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file2</span><span class="p">)))</span> 
    <span class="n">data2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">data2</span><span class="p">,</span> <span class="n">data_new2</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;DEMO_A.XPT&#39;, &#39;DEMO_B.XPT&#39;, &#39;DEMO_C.XPT&#39;, &#39;DEMO_D.XPT&#39;, &#39;DEMO_E.XPT&#39;, &#39;DEMO_F.XPT&#39;, &#39;DEMO_G.XPT&#39;, &#39;DEMO_H.XPT&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\sidma\anaconda3\lib\site-packages\pandas\io\sas\sas_xport.py:475: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  df[x] = v
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agesex</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;SEQN&quot;</span><span class="p">,</span> <span class="s2">&quot;RIAGENDR&quot;</span><span class="p">,</span> <span class="s2">&quot;RIDAGEYR&quot;</span><span class="p">]</span>
<span class="n">data_agesex</span> <span class="o">=</span> <span class="n">data2</span><span class="p">[</span><span class="n">agesex</span><span class="p">]</span>
<span class="n">data_agesex</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(82091, 3)
</pre></div>
</div>
</div>
</div>
</section>
<section id="merge-cbc-age-and-sex-data-using-patients-ids">
<h3>Merge CBC, Age and Sex data using patients ids<a class="headerlink" href="#merge-cbc-age-and-sex-data-using-patients-ids" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ids_CBC</span> <span class="o">=</span> <span class="n">data_CBC</span><span class="p">[</span><span class="s2">&quot;SEQN&quot;</span><span class="p">]</span>
<span class="n">ids_agesex</span> <span class="o">=</span> <span class="n">data_agesex</span><span class="p">[</span><span class="s2">&quot;SEQN&quot;</span><span class="p">]</span>
<span class="n">data_agesex</span> <span class="o">=</span> <span class="n">data_agesex</span><span class="p">[</span><span class="n">ids_agesex</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">ids_CBC</span><span class="p">)]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;SEQN&quot;</span><span class="p">])</span>
<span class="n">data_agesex</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(74900, 3)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_CBC</span> <span class="o">=</span> <span class="n">data_CBC</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data_agesex</span> <span class="o">=</span> <span class="n">data_agesex</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data_live</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">data_CBC</span><span class="p">,</span><span class="n">data_agesex</span><span class="p">[[</span><span class="s2">&quot;RIAGENDR&quot;</span><span class="p">,</span> <span class="s2">&quot;RIDAGEYR&quot;</span><span class="p">]]],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">data_live</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(74900, 14)
</pre></div>
</div>
</div>
</div>
</section>
<section id="get-rid-of-patients-with-nans-as-in-the-article">
<h3>Get rid of patients with Nans (as in the article)<a class="headerlink" href="#get-rid-of-patients-with-nans-as-in-the-article" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_live</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SEQN        74900
LBXWBCSI    67278
LBXHGB      67281
LBXRBCSI    67281
LBXMCVSI    67281
LBXMC       67281
LBXRDW      67281
LBXPLTSI    67279
LBXNEPCT    67105
LBXLYPCT    67105
LBXMOPCT    67105
LBXEOPCT    67105
RIAGENDR    74900
RIDAGEYR    74900
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_live</span> <span class="o">=</span> <span class="n">data_live</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data_live</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SEQN        2.000000e+00
LBXWBCSI    1.400000e+00
LBXHGB      5.800000e+00
LBXRBCSI    1.670000e+00
LBXMCVSI    5.050000e+01
LBXMC       2.510000e+01
LBXRDW      6.300000e+00
LBXPLTSI    4.000000e+00
LBXNEPCT    8.000000e-01
LBXLYPCT    2.600000e+00
LBXMOPCT    6.000000e-01
LBXEOPCT    5.397605e-79
RIAGENDR    1.000000e+00
RIDAGEYR    1.000000e+00
dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="converting-white-blood-cell-percentages-into-cell-counts-as-in-the-article">
<h3>Converting white blood cell percentages into cell counts (as in the article)<a class="headerlink" href="#converting-white-blood-cell-percentages-into-cell-counts-as-in-the-article" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">white_blood</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;LBXNEPCT&quot;</span><span class="p">,</span> <span class="s2">&quot;LBXLYPCT&quot;</span><span class="p">,</span> <span class="s2">&quot;LBXMOPCT&quot;</span><span class="p">,</span> <span class="s2">&quot;LBXEOPCT&quot;</span><span class="p">]</span>
<span class="n">data_live</span><span class="p">[</span><span class="n">white_blood</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_live</span><span class="p">[</span><span class="n">white_blood</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.01</span>
<span class="n">data_live</span><span class="p">[</span><span class="n">white_blood</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_live</span><span class="p">[</span><span class="n">white_blood</span><span class="p">]</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">data_live</span><span class="p">[</span><span class="s2">&quot;LBXWBCSI&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">)</span>
<span class="n">data_live</span> <span class="o">=</span> <span class="n">data_live</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;LBXWBCSI&quot;</span><span class="p">],</span>  <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;SEQN&quot;</span><span class="p">])</span>
<span class="n">data_live</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(67101, 13)
</pre></div>
</div>
</div>
</div>
</section>
<section id="get-mortality-data">
<h3>Get mortality data<a class="headerlink" href="#get-mortality-data" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path_death</span> <span class="o">=</span> <span class="s1">&#39;.../Mortality/CSV/&#39;</span>
<span class="n">files_death</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path_death</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">files_death</span><span class="p">)</span>

<span class="n">data_death</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">path_death</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">files_death</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span> <span class="n">sep</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">file_death</span> <span class="ow">in</span> <span class="n">files_death</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
    <span class="n">data_new_death</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">path_death</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file_death</span><span class="p">)),</span> <span class="n">sep</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">data_death</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">data_death</span><span class="p">,</span> <span class="n">data_new_death</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;NHANES_1999_2000.csv&#39;, &#39;NHANES_2001_2002.csv&#39;, &#39;NHANES_2003_2004.csv&#39;, &#39;NHANES_2005_2006.csv&#39;, &#39;NHANES_2007_2008.csv&#39;, &#39;NHANES_2009_2010.csv&#39;, &#39;NHANES_2011_2012.csv&#39;, &#39;NHANES_2013_2014.csv&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_death</span> <span class="o">=</span> <span class="n">data_death</span><span class="p">[[</span><span class="s2">&quot;seqn&quot;</span><span class="p">,</span> <span class="s2">&quot;mortstat&quot;</span><span class="p">,</span> <span class="s2">&quot;permth_exm&quot;</span><span class="p">]]</span>
<span class="n">data_death</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(82091, 3)
</pre></div>
</div>
</div>
</div>
</section>
<section id="merge-mortality-data-with-previous-patients-data-using-patients-ids">
<h3>Merge mortality data with previous patients data using patients ids<a class="headerlink" href="#merge-mortality-data-with-previous-patients-data-using-patients-ids" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ids_live</span> <span class="o">=</span> <span class="n">data_live</span><span class="p">[</span><span class="s2">&quot;SEQN&quot;</span><span class="p">]</span>
<span class="n">ids_death</span> <span class="o">=</span> <span class="n">data_death</span><span class="p">[</span><span class="s2">&quot;seqn&quot;</span><span class="p">]</span>
<span class="n">data_death</span> <span class="o">=</span> <span class="n">data_death</span><span class="p">[</span><span class="n">ids_death</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">ids_live</span><span class="p">)]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;seqn&quot;</span><span class="p">])</span>
<span class="n">data_death</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(67101, 3)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_live</span> <span class="o">=</span> <span class="n">data_live</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data_death</span> <span class="o">=</span> <span class="n">data_death</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">data_live</span><span class="p">,</span><span class="n">data_death</span><span class="p">[[</span><span class="s2">&quot;mortstat&quot;</span><span class="p">,</span> <span class="s2">&quot;permth_exm&quot;</span><span class="p">]]],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">data_all</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(67101, 15)
</pre></div>
</div>
</div>
</div>
</section>
<section id="log-transformation-of-cbc-parameters-as-in-the-article">
<h3>log-transformation of CBC parameters (as in the article)<a class="headerlink" href="#log-transformation-of-cbc-parameters-as-in-the-article" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">CBC_params</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;LBXHGB&quot;</span><span class="p">,</span> <span class="s2">&quot;LBXRBCSI&quot;</span><span class="p">,</span> <span class="s2">&quot;LBXMCVSI&quot;</span><span class="p">,</span> <span class="s2">&quot;LBXMC&quot;</span><span class="p">,</span> <span class="s2">&quot;LBXRDW&quot;</span><span class="p">,</span> <span class="s2">&quot;LBXPLTSI&quot;</span><span class="p">,</span> <span class="s2">&quot;LBXNEPCT&quot;</span><span class="p">,</span> <span class="s2">&quot;LBXLYPCT&quot;</span><span class="p">,</span> <span class="s2">&quot;LBXMOPCT&quot;</span><span class="p">,</span> <span class="s2">&quot;LBXEOPCT&quot;</span><span class="p">]</span>
<span class="n">data_all</span><span class="p">[</span><span class="n">CBC_params</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">data_all</span><span class="p">[</span><span class="n">CBC_params</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_all</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SEQN</th>
      <th>LBXHGB</th>
      <th>LBXRBCSI</th>
      <th>LBXMCVSI</th>
      <th>LBXMC</th>
      <th>LBXRDW</th>
      <th>LBXPLTSI</th>
      <th>LBXNEPCT</th>
      <th>LBXLYPCT</th>
      <th>LBXMOPCT</th>
      <th>LBXEOPCT</th>
      <th>RIAGENDR</th>
      <th>RIDAGEYR</th>
      <th>mortstat</th>
      <th>permth_exm</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.0</td>
      <td>2.646175</td>
      <td>1.553925</td>
      <td>4.483003</td>
      <td>3.514526</td>
      <td>2.617396</td>
      <td>5.365976</td>
      <td>1.624681</td>
      <td>0.472251</td>
      <td>-0.616927</td>
      <td>-1.095417</td>
      <td>1.0</td>
      <td>77.0</td>
      <td>1.0</td>
      <td>177.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.0</td>
      <td>2.617396</td>
      <td>1.508512</td>
      <td>4.464758</td>
      <td>3.549617</td>
      <td>2.459589</td>
      <td>5.598422</td>
      <td>1.073294</td>
      <td>1.042042</td>
      <td>-0.498403</td>
      <td>0.111094</td>
      <td>2.0</td>
      <td>10.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.0</td>
      <td>2.230014</td>
      <td>1.562346</td>
      <td>4.119037</td>
      <td>3.453157</td>
      <td>2.727853</td>
      <td>6.154858</td>
      <td>0.751793</td>
      <td>1.624839</td>
      <td>-0.605869</td>
      <td>0.003195</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5.0</td>
      <td>2.674149</td>
      <td>1.635106</td>
      <td>4.441474</td>
      <td>3.505557</td>
      <td>2.572612</td>
      <td>5.342334</td>
      <td>1.124865</td>
      <td>0.802091</td>
      <td>-1.005669</td>
      <td>-1.606442</td>
      <td>1.0</td>
      <td>49.0</td>
      <td>0.0</td>
      <td>244.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6.0</td>
      <td>2.572612</td>
      <td>1.439835</td>
      <td>4.518522</td>
      <td>3.517498</td>
      <td>2.549445</td>
      <td>6.115892</td>
      <td>1.978073</td>
      <td>0.621866</td>
      <td>-1.119632</td>
      <td>-1.650260</td>
      <td>2.0</td>
      <td>19.0</td>
      <td>0.0</td>
      <td>245.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>67096</th>
      <td>83725.0</td>
      <td>2.541602</td>
      <td>1.521699</td>
      <td>4.426044</td>
      <td>3.505557</td>
      <td>2.587764</td>
      <td>5.598422</td>
      <td>1.007045</td>
      <td>1.074080</td>
      <td>-0.730226</td>
      <td>0.104000</td>
      <td>1.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>67097</th>
      <td>83727.0</td>
      <td>2.701361</td>
      <td>1.623341</td>
      <td>4.487512</td>
      <td>3.493473</td>
      <td>2.541602</td>
      <td>5.420535</td>
      <td>1.070624</td>
      <td>0.486676</td>
      <td>-1.119632</td>
      <td>-1.640929</td>
      <td>1.0</td>
      <td>26.0</td>
      <td>0.0</td>
      <td>72.0</td>
    </tr>
    <tr>
      <th>67098</th>
      <td>83728.0</td>
      <td>2.501436</td>
      <td>1.439835</td>
      <td>4.415220</td>
      <td>3.555348</td>
      <td>2.525729</td>
      <td>6.089045</td>
      <td>0.368386</td>
      <td>1.491060</td>
      <td>-0.786579</td>
      <td>-1.554950</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>67099</th>
      <td>83729.0</td>
      <td>2.501436</td>
      <td>1.425515</td>
      <td>4.489759</td>
      <td>3.490429</td>
      <td>2.646175</td>
      <td>5.361292</td>
      <td>1.149052</td>
      <td>0.899185</td>
      <td>-0.456337</td>
      <td>-2.107018</td>
      <td>2.0</td>
      <td>42.0</td>
      <td>0.0</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>67100</th>
      <td>83730.0</td>
      <td>2.617396</td>
      <td>1.615420</td>
      <td>4.390739</td>
      <td>3.517498</td>
      <td>2.595255</td>
      <td>5.863631</td>
      <td>1.378741</td>
      <td>1.611316</td>
      <td>-0.504347</td>
      <td>-1.319384</td>
      <td>1.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>67101 rows × 15 columns</p>
</div></div></div>
</div>
<p>Altogether, the training subset comprised participants aged 40 y.o. and older. All CBC parameters were log-transformed and normalized to zero-mean and unit-variance based on data of NHANES participants aged 40 y.o. and older to further carry out PCA and train Cox proportional hazards model.
In Cox used log-transformed CBC measurements and sex variable (but not age) as covariates.</p>
</section>
<section id="train-test-split-as-in-the-article">
<h3>Train-test split as in the article:<a class="headerlink" href="#train-test-split-as-in-the-article" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train</span> <span class="o">=</span> <span class="n">data_all</span><span class="p">[</span><span class="n">data_all</span><span class="o">.</span><span class="n">RIDAGEYR</span> <span class="o">&gt;=</span> <span class="mi">40</span><span class="p">]</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">data_all</span><span class="p">[</span><span class="n">data_all</span><span class="o">.</span><span class="n">RIDAGEYR</span> <span class="o">&lt;</span> <span class="mi">40</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(25794, 15)
(41307, 15)
</pre></div>
</div>
</div>
</div>
</section>
<section id="scaling">
<h3>Scaling<a class="headerlink" href="#scaling" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">CBC_params</span><span class="p">])</span>  

<span class="n">train</span><span class="p">[</span><span class="n">CBC_params</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">CBC_params</span><span class="p">])</span>
<span class="n">test</span><span class="p">[</span><span class="n">CBC_params</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">CBC_params</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\sidma\anaconda3\lib\site-packages\pandas\core\frame.py:3678: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self[col] = igetitem(value, i)
C:\Users\sidma\anaconda3\lib\site-packages\pandas\core\frame.py:3678: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self[col] = igetitem(value, i)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="a-pca">
<h2>1A: PCA<a class="headerlink" href="#a-pca" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">PCA_data_X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">train</span><span class="p">[</span><span class="n">CBC_params</span><span class="p">],</span> <span class="n">test</span><span class="p">[</span><span class="n">CBC_params</span><span class="p">]],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">PCA_data_Y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">train</span><span class="p">[[</span><span class="s2">&quot;RIDAGEYR&quot;</span><span class="p">]],</span> <span class="n">test</span><span class="p">[[</span><span class="s2">&quot;RIDAGEYR&quot;</span><span class="p">]]],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">PCA_result</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">PCA_data_X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">PCA_result_age</span> <span class="o">=</span>  <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">PCA_result</span><span class="p">),</span><span class="n">PCA_data_Y</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">PCA_result_age</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">PCA_result_age</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">PCA_itog</span> <span class="o">=</span> <span class="n">PCA_result_age</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;RIDAGEYR&#39;</span><span class="p">)[[</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">PCA_itog</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RIDAGEYR</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>2.927260</td>
      <td>-0.514077</td>
      <td>0.136926</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.0</td>
      <td>2.170844</td>
      <td>-0.138190</td>
      <td>0.248139</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3.0</td>
      <td>1.740090</td>
      <td>-0.008529</td>
      <td>0.380440</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.0</td>
      <td>1.399080</td>
      <td>-0.048027</td>
      <td>0.407578</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>1.227580</td>
      <td>-0.029302</td>
      <td>0.363167</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>80</th>
      <td>81.0</td>
      <td>-0.854237</td>
      <td>0.207380</td>
      <td>0.301759</td>
    </tr>
    <tr>
      <th>81</th>
      <td>82.0</td>
      <td>-0.716904</td>
      <td>0.132620</td>
      <td>0.509531</td>
    </tr>
    <tr>
      <th>82</th>
      <td>83.0</td>
      <td>-0.734880</td>
      <td>-0.010363</td>
      <td>0.337265</td>
    </tr>
    <tr>
      <th>83</th>
      <td>84.0</td>
      <td>-0.503010</td>
      <td>-0.069912</td>
      <td>0.587524</td>
    </tr>
    <tr>
      <th>84</th>
      <td>85.0</td>
      <td>-0.626147</td>
      <td>0.351162</td>
      <td>0.648506</td>
    </tr>
  </tbody>
</table>
<p>85 rows × 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits</span> <span class="kn">import</span> <span class="n">mplot3d</span>
<span class="kn">import</span> <span class="nn">matplotlib.cm</span> <span class="k">as</span> <span class="nn">cm</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span> <span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
 
<span class="n">p</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">PCA_itog</span><span class="p">[</span><span class="s2">&quot;0&quot;</span><span class="p">],</span> <span class="n">PCA_itog</span><span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">],</span> <span class="n">PCA_itog</span><span class="p">[</span><span class="s2">&quot;2&quot;</span><span class="p">],</span> <span class="n">c</span> <span class="o">=</span> <span class="n">PCA_itog</span><span class="p">[</span><span class="s2">&quot;RIDAGEYR&quot;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">plasma_r</span> <span class="p">)</span>
 
    
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;3d Scatter plot geeks for geeks&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;PC1&#39;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;PC2&quot;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s2">&quot;PC3&quot;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">6</span><span class="p">)</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">zaxis</span><span class="o">.</span><span class="n">get_major_ticks</span><span class="p">():</span> <span class="n">t</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_size</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.41</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">zaxis</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.41</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">))</span>

<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">get_proj</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Axes3D</span><span class="o">.</span><span class="n">get_proj</span><span class="p">(</span><span class="n">ax</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/code_40_0.png" src="../../../_images/code_40_0.png" />
</div>
</div>
</section>
<section id="cox">
<h2>Cox<a class="headerlink" href="#cox" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SEQN</th>
      <th>LBXHGB</th>
      <th>LBXRBCSI</th>
      <th>LBXMCVSI</th>
      <th>LBXMC</th>
      <th>LBXRDW</th>
      <th>LBXPLTSI</th>
      <th>LBXNEPCT</th>
      <th>LBXLYPCT</th>
      <th>LBXMOPCT</th>
      <th>LBXEOPCT</th>
      <th>RIAGENDR</th>
      <th>RIDAGEYR</th>
      <th>mortstat</th>
      <th>permth_exm</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.0</td>
      <td>0.052801</td>
      <td>0.271317</td>
      <td>-0.254006</td>
      <td>-0.328618</td>
      <td>0.505580</td>
      <td>-0.433887</td>
      <td>0.665549</td>
      <td>-0.529913</td>
      <td>0.083342</td>
      <td>0.157256</td>
      <td>1.0</td>
      <td>77.0</td>
      <td>1.0</td>
      <td>177.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5.0</td>
      <td>0.303057</td>
      <td>1.002898</td>
      <td>-0.875611</td>
      <td>-0.644740</td>
      <td>0.011453</td>
      <td>-0.518236</td>
      <td>-0.631315</td>
      <td>0.381771</td>
      <td>-1.068364</td>
      <td>0.068833</td>
      <td>1.0</td>
      <td>49.0</td>
      <td>0.0</td>
      <td>244.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>7.0</td>
      <td>-0.402732</td>
      <td>0.020168</td>
      <td>-0.441217</td>
      <td>-0.644740</td>
      <td>0.978523</td>
      <td>0.034180</td>
      <td>-1.598215</td>
      <td>0.458768</td>
      <td>-0.683812</td>
      <td>-0.213664</td>
      <td>2.0</td>
      <td>59.0</td>
      <td>0.0</td>
      <td>236.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>10.0</td>
      <td>0.841777</td>
      <td>0.771586</td>
      <td>0.375280</td>
      <td>-0.433677</td>
      <td>0.505580</td>
      <td>-1.318636</td>
      <td>-1.732354</td>
      <td>-0.061419</td>
      <td>-0.244954</td>
      <td>0.025766</td>
      <td>1.0</td>
      <td>43.0</td>
      <td>1.0</td>
      <td>231.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>13.0</td>
      <td>1.620185</td>
      <td>1.679523</td>
      <td>0.179401</td>
      <td>-0.644740</td>
      <td>1.055413</td>
      <td>-0.207797</td>
      <td>2.307305</td>
      <td>-0.678628</td>
      <td>-0.515816</td>
      <td>-0.184487</td>
      <td>1.0</td>
      <td>70.0</td>
      <td>1.0</td>
      <td>16.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>67091</th>
      <td>83718.0</td>
      <td>-0.605292</td>
      <td>-1.284509</td>
      <td>1.211004</td>
      <td>-0.223871</td>
      <td>0.744585</td>
      <td>-0.009958</td>
      <td>0.356941</td>
      <td>0.487903</td>
      <td>0.085537</td>
      <td>-0.056002</td>
      <td>2.0</td>
      <td>60.0</td>
      <td>0.0</td>
      <td>84.0</td>
    </tr>
    <tr>
      <th>67093</th>
      <td>83721.0</td>
      <td>0.241146</td>
      <td>-0.218043</td>
      <td>0.584629</td>
      <td>0.500770</td>
      <td>-0.244164</td>
      <td>-1.654413</td>
      <td>0.290061</td>
      <td>-0.890244</td>
      <td>0.489089</td>
      <td>0.149423</td>
      <td>1.0</td>
      <td>52.0</td>
      <td>0.0</td>
      <td>76.0</td>
    </tr>
    <tr>
      <th>67094</th>
      <td>83723.0</td>
      <td>0.178804</td>
      <td>-1.127388</td>
      <td>1.454394</td>
      <td>1.610221</td>
      <td>0.011453</td>
      <td>-1.031417</td>
      <td>-0.026343</td>
      <td>1.103076</td>
      <td>1.106975</td>
      <td>-0.015521</td>
      <td>1.0</td>
      <td>61.0</td>
      <td>0.0</td>
      <td>82.0</td>
    </tr>
    <tr>
      <th>67095</th>
      <td>83724.0</td>
      <td>-1.540267</td>
      <td>-1.893329</td>
      <td>0.616578</td>
      <td>-0.015306</td>
      <td>0.261282</td>
      <td>-1.051183</td>
      <td>0.175397</td>
      <td>-1.427371</td>
      <td>0.294691</td>
      <td>-0.045335</td>
      <td>1.0</td>
      <td>80.0</td>
      <td>0.0</td>
      <td>80.0</td>
    </tr>
    <tr>
      <th>67099</th>
      <td>83729.0</td>
      <td>-1.242038</td>
      <td>-0.885888</td>
      <td>-0.152869</td>
      <td>-1.177993</td>
      <td>0.823117</td>
      <td>-0.450598</td>
      <td>-0.568557</td>
      <td>0.650140</td>
      <td>0.559114</td>
      <td>-0.017782</td>
      <td>2.0</td>
      <td>42.0</td>
      <td>0.0</td>
      <td>75.0</td>
    </tr>
  </tbody>
</table>
<p>25794 rows × 15 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Cox</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;SEQN&quot;</span><span class="p">,</span> <span class="s2">&quot;RIDAGEYR&quot;</span><span class="p">],</span>  <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">Cox</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LBXHGB        25794
LBXRBCSI      25794
LBXMCVSI      25794
LBXMC         25794
LBXRDW        25794
LBXPLTSI      25794
LBXNEPCT      25794
LBXLYPCT      25794
LBXMOPCT      25794
LBXEOPCT      25794
RIAGENDR      25794
mortstat      25761
permth_exm    25761
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Cox</span> <span class="o">=</span> <span class="n">Cox</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">Cox</span> <span class="o">=</span> <span class="n">Cox</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;mortstat&#39;</span> <span class="p">:</span> <span class="s1">&#39;event_col&#39;</span><span class="p">,</span> <span class="s1">&#39;permth_exm&#39;</span> <span class="p">:</span> <span class="s1">&#39;duration_col&#39;</span><span class="p">})</span>
<span class="n">Cox</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(25761, 13)
</pre></div>
</div>
</div>
</div>
<section id="train-test-split">
<h3>Train-test split<a class="headerlink" href="#train-test-split" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">Cox_train</span><span class="p">,</span> <span class="n">Cox_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">Cox</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> 
                                       <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                        <span class="n">stratify</span><span class="o">=</span><span class="n">Cox</span><span class="p">[</span><span class="s2">&quot;RIAGENDR&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Cox_train</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(12880, 13)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Cox_train</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LBXHGB</th>
      <th>LBXRBCSI</th>
      <th>LBXMCVSI</th>
      <th>LBXMC</th>
      <th>LBXRDW</th>
      <th>LBXPLTSI</th>
      <th>LBXNEPCT</th>
      <th>LBXLYPCT</th>
      <th>LBXMOPCT</th>
      <th>LBXEOPCT</th>
      <th>RIAGENDR</th>
      <th>event_col</th>
      <th>duration_col</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>54138</th>
      <td>-0.270195</td>
      <td>-0.650692</td>
      <td>0.947990</td>
      <td>-0.644740</td>
      <td>-0.864694</td>
      <td>-0.569819</td>
      <td>-1.054517</td>
      <td>-0.623166</td>
      <td>0.693491</td>
      <td>0.033130</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>93.0</td>
    </tr>
    <tr>
      <th>45897</th>
      <td>1.349891</td>
      <td>1.125035</td>
      <td>0.680272</td>
      <td>-0.644740</td>
      <td>-0.594469</td>
      <td>-0.972767</td>
      <td>-0.370480</td>
      <td>-1.398664</td>
      <td>-1.867689</td>
      <td>-0.236769</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>121.0</td>
    </tr>
    <tr>
      <th>36164</th>
      <td>-0.469744</td>
      <td>-0.421478</td>
      <td>-0.544328</td>
      <td>1.110250</td>
      <td>0.343317</td>
      <td>-0.501206</td>
      <td>-1.573508</td>
      <td>-0.023561</td>
      <td>-1.597203</td>
      <td>-0.045669</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>144.0</td>
    </tr>
    <tr>
      <th>45802</th>
      <td>-0.336218</td>
      <td>-1.060880</td>
      <td>0.979174</td>
      <td>0.398158</td>
      <td>0.823117</td>
      <td>-0.747358</td>
      <td>-1.774419</td>
      <td>0.845512</td>
      <td>1.168895</td>
      <td>-0.007829</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>88.0</td>
    </tr>
    <tr>
      <th>43299</th>
      <td>-0.673845</td>
      <td>-1.038819</td>
      <td>0.759511</td>
      <td>-0.328618</td>
      <td>-0.505844</td>
      <td>0.408622</td>
      <td>-0.410946</td>
      <td>0.996013</td>
      <td>-0.784374</td>
      <td>-0.211907</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>115.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>20895</th>
      <td>-0.742926</td>
      <td>-0.545780</td>
      <td>-0.561582</td>
      <td>0.398158</td>
      <td>0.901093</td>
      <td>0.830310</td>
      <td>-0.153382</td>
      <td>-0.724664</td>
      <td>-0.327679</td>
      <td>0.189372</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>63.0</td>
    </tr>
    <tr>
      <th>6122</th>
      <td>0.303057</td>
      <td>0.515656</td>
      <td>-0.203352</td>
      <td>-0.433677</td>
      <td>-1.048593</td>
      <td>0.106552</td>
      <td>-0.070964</td>
      <td>-0.898110</td>
      <td>-0.845339</td>
      <td>0.012671</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>240.0</td>
    </tr>
    <tr>
      <th>21298</th>
      <td>0.606341</td>
      <td>0.136953</td>
      <td>0.632527</td>
      <td>0.295246</td>
      <td>-0.773882</td>
      <td>-0.622159</td>
      <td>-0.427093</td>
      <td>-0.631736</td>
      <td>0.309480</td>
      <td>-0.023570</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>198.0</td>
    </tr>
    <tr>
      <th>30923</th>
      <td>1.726056</td>
      <td>1.481816</td>
      <td>0.536577</td>
      <td>-0.433677</td>
      <td>-0.683810</td>
      <td>0.205467</td>
      <td>0.131002</td>
      <td>-0.385519</td>
      <td>0.233219</td>
      <td>0.072249</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>168.0</td>
    </tr>
    <tr>
      <th>3340</th>
      <td>1.183706</td>
      <td>1.159629</td>
      <td>0.423852</td>
      <td>-0.857074</td>
      <td>0.011453</td>
      <td>-0.972767</td>
      <td>0.287106</td>
      <td>-0.119642</td>
      <td>0.517677</td>
      <td>0.084885</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>129.0</td>
    </tr>
  </tbody>
</table>
<p>12880 rows × 13 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="ch">#!pip install lifelines</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lifelines</span> <span class="kn">import</span> <span class="n">CoxPHFitter</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cph</span> <span class="o">=</span> <span class="n">CoxPHFitter</span><span class="p">()</span>
<span class="n">cph</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Cox_train</span><span class="p">,</span> <span class="n">duration_col</span> <span class="o">=</span> <span class="s2">&quot;duration_col&quot;</span><span class="p">,</span> <span class="n">event_col</span> <span class="o">=</span> <span class="s1">&#39;event_col&#39;</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;lifelines.CoxPHFitter: fitted with 12880 total observations, 9333 right-censored observations&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cph</span><span class="o">.</span><span class="n">print_summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <tbody>
    <tr>
      <th>model</th>
      <td>lifelines.CoxPHFitter</td>
    </tr>
    <tr>
      <th>duration col</th>
      <td>'duration_col'</td>
    </tr>
    <tr>
      <th>event col</th>
      <td>'event_col'</td>
    </tr>
    <tr>
      <th>baseline estimation</th>
      <td>breslow</td>
    </tr>
    <tr>
      <th>number of observations</th>
      <td>12880</td>
    </tr>
    <tr>
      <th>number of events observed</th>
      <td>3547</td>
    </tr>
    <tr>
      <th>partial log-likelihood</th>
      <td>-30677.18</td>
    </tr>
    <tr>
      <th>time fit was run</th>
      <td>2023-03-19 09:29:54 UTC</td>
    </tr>
  </tbody>
</table>
</div><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th style="min-width: 12px;"></th>
      <th style="min-width: 12px;">coef</th>
      <th style="min-width: 12px;">exp(coef)</th>
      <th style="min-width: 12px;">se(coef)</th>
      <th style="min-width: 12px;">coef lower 95%</th>
      <th style="min-width: 12px;">coef upper 95%</th>
      <th style="min-width: 12px;">exp(coef) lower 95%</th>
      <th style="min-width: 12px;">exp(coef) upper 95%</th>
      <th style="min-width: 12px;">cmp to</th>
      <th style="min-width: 12px;">z</th>
      <th style="min-width: 12px;">p</th>
      <th style="min-width: 12px;">-log2(p)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>LBXHGB</th>
      <td>-0.15</td>
      <td>0.86</td>
      <td>0.32</td>
      <td>-0.78</td>
      <td>0.49</td>
      <td>0.46</td>
      <td>1.62</td>
      <td>0.00</td>
      <td>-0.45</td>
      <td>0.65</td>
      <td>0.62</td>
    </tr>
    <tr>
      <th>LBXRBCSI</th>
      <td>-0.12</td>
      <td>0.88</td>
      <td>0.32</td>
      <td>-0.75</td>
      <td>0.50</td>
      <td>0.47</td>
      <td>1.65</td>
      <td>0.00</td>
      <td>-0.39</td>
      <td>0.70</td>
      <td>0.52</td>
    </tr>
    <tr>
      <th>LBXMCVSI</th>
      <td>0.37</td>
      <td>1.45</td>
      <td>0.19</td>
      <td>-0.01</td>
      <td>0.75</td>
      <td>0.99</td>
      <td>2.11</td>
      <td>0.00</td>
      <td>1.93</td>
      <td>0.05</td>
      <td>4.21</td>
    </tr>
    <tr>
      <th>LBXMC</th>
      <td>-0.13</td>
      <td>0.88</td>
      <td>0.08</td>
      <td>-0.29</td>
      <td>0.03</td>
      <td>0.75</td>
      <td>1.03</td>
      <td>0.00</td>
      <td>-1.63</td>
      <td>0.10</td>
      <td>3.27</td>
    </tr>
    <tr>
      <th>LBXRDW</th>
      <td>0.32</td>
      <td>1.38</td>
      <td>0.02</td>
      <td>0.29</td>
      <td>0.35</td>
      <td>1.34</td>
      <td>1.42</td>
      <td>0.00</td>
      <td>20.95</td>
      <td>&lt;0.005</td>
      <td>321.34</td>
    </tr>
    <tr>
      <th>LBXPLTSI</th>
      <td>-0.16</td>
      <td>0.85</td>
      <td>0.02</td>
      <td>-0.19</td>
      <td>-0.13</td>
      <td>0.83</td>
      <td>0.88</td>
      <td>0.00</td>
      <td>-10.13</td>
      <td>&lt;0.005</td>
      <td>77.72</td>
    </tr>
    <tr>
      <th>LBXNEPCT</th>
      <td>0.19</td>
      <td>1.21</td>
      <td>0.02</td>
      <td>0.16</td>
      <td>0.23</td>
      <td>1.17</td>
      <td>1.26</td>
      <td>0.00</td>
      <td>10.36</td>
      <td>&lt;0.005</td>
      <td>81.12</td>
    </tr>
    <tr>
      <th>LBXLYPCT</th>
      <td>-0.29</td>
      <td>0.75</td>
      <td>0.02</td>
      <td>-0.32</td>
      <td>-0.25</td>
      <td>0.72</td>
      <td>0.78</td>
      <td>0.00</td>
      <td>-16.05</td>
      <td>&lt;0.005</td>
      <td>190.13</td>
    </tr>
    <tr>
      <th>LBXMOPCT</th>
      <td>0.27</td>
      <td>1.31</td>
      <td>0.02</td>
      <td>0.23</td>
      <td>0.31</td>
      <td>1.26</td>
      <td>1.36</td>
      <td>0.00</td>
      <td>13.27</td>
      <td>&lt;0.005</td>
      <td>131.01</td>
    </tr>
    <tr>
      <th>LBXEOPCT</th>
      <td>0.09</td>
      <td>1.09</td>
      <td>0.06</td>
      <td>-0.04</td>
      <td>0.21</td>
      <td>0.96</td>
      <td>1.23</td>
      <td>0.00</td>
      <td>1.37</td>
      <td>0.17</td>
      <td>2.55</td>
    </tr>
    <tr>
      <th>RIAGENDR</th>
      <td>-0.35</td>
      <td>0.71</td>
      <td>0.04</td>
      <td>-0.42</td>
      <td>-0.27</td>
      <td>0.65</td>
      <td>0.76</td>
      <td>0.00</td>
      <td>-8.73</td>
      <td>&lt;0.005</td>
      <td>58.47</td>
    </tr>
  </tbody>
</table><br><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <tbody>
    <tr>
      <th>Concordance</th>
      <td>0.72</td>
    </tr>
    <tr>
      <th>Partial AIC</th>
      <td>61376.36</td>
    </tr>
    <tr>
      <th>log-likelihood ratio test</th>
      <td>2052.07 on 11 df</td>
    </tr>
    <tr>
      <th>-log2(p) of ll-ratio test</th>
      <td>inf</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#cph.plot(hazard_ratios=False)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cph</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hazard_ratios</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;HR (95% CI)&#39;&gt;
</pre></div>
</div>
<img alt="../../../_images/code_54_1.png" src="../../../_images/code_54_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Cox_train</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LBXHGB</th>
      <th>LBXRBCSI</th>
      <th>LBXMCVSI</th>
      <th>LBXMC</th>
      <th>LBXRDW</th>
      <th>LBXPLTSI</th>
      <th>LBXNEPCT</th>
      <th>LBXLYPCT</th>
      <th>LBXMOPCT</th>
      <th>LBXEOPCT</th>
      <th>RIAGENDR</th>
      <th>event_col</th>
      <th>duration_col</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>12880.000000</td>
      <td>12880.000000</td>
      <td>12880.000000</td>
      <td>12880.000000</td>
      <td>12880.000000</td>
      <td>12880.000000</td>
      <td>12880.000000</td>
      <td>12880.000000</td>
      <td>12880.000000</td>
      <td>12880.000000</td>
      <td>12880.000000</td>
      <td>12880.000000</td>
      <td>12880.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>-0.006079</td>
      <td>-0.004546</td>
      <td>-0.002950</td>
      <td>0.002191</td>
      <td>-0.003168</td>
      <td>-0.004241</td>
      <td>0.000526</td>
      <td>-0.000097</td>
      <td>0.007138</td>
      <td>0.000144</td>
      <td>1.509317</td>
      <td>0.275388</td>
      <td>127.825854</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.008042</td>
      <td>1.004348</td>
      <td>0.994428</td>
      <td>1.008663</td>
      <td>1.006602</td>
      <td>0.998465</td>
      <td>1.004849</td>
      <td>0.998748</td>
      <td>0.990335</td>
      <td>1.000494</td>
      <td>0.499933</td>
      <td>0.446727</td>
      <td>58.703695</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-7.442962</td>
      <td>-9.110873</td>
      <td>-8.651593</td>
      <td>-7.007641</td>
      <td>-2.325014</td>
      <td>-10.712949</td>
      <td>-10.682425</td>
      <td>-4.586342</td>
      <td>-6.307882</td>
      <td>-31.365633</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-0.605292</td>
      <td>-0.629612</td>
      <td>-0.458353</td>
      <td>-0.644740</td>
      <td>-0.594469</td>
      <td>-0.604627</td>
      <td>-0.627275</td>
      <td>-0.602563</td>
      <td>-0.619779</td>
      <td>-0.042193</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>82.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.052801</td>
      <td>0.039738</td>
      <td>0.097023</td>
      <td>0.088516</td>
      <td>-0.158299</td>
      <td>0.034180</td>
      <td>0.040354</td>
      <td>0.023678</td>
      <td>0.028201</td>
      <td>0.035656</td>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>122.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.665784</td>
      <td>0.681014</td>
      <td>0.600612</td>
      <td>0.603085</td>
      <td>0.424747</td>
      <td>0.625693</td>
      <td>0.655307</td>
      <td>0.639915</td>
      <td>0.658430</td>
      <td>0.110216</td>
      <td>2.000000</td>
      <td>1.000000</td>
      <td>171.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>3.044750</td>
      <td>6.227398</td>
      <td>4.950555</td>
      <td>25.339866</td>
      <td>11.703782</td>
      <td>5.066864</td>
      <td>7.919148</td>
      <td>9.952183</td>
      <td>8.784012</td>
      <td>0.714875</td>
      <td>2.000000</td>
      <td>1.000000</td>
      <td>249.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cph</span><span class="o">.</span><span class="n">plot_partial_effects_on_outcome</span><span class="p">(</span><span class="n">covariates</span><span class="o">=</span><span class="s1">&#39;LBXMCVSI&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">8.651593</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.458353</span><span class="p">,</span> <span class="mf">0.097023</span><span class="p">,</span> <span class="mf">0.600612</span><span class="p">,</span> <span class="mf">4.950555</span>  <span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../../../_images/code_56_1.png" src="../../../_images/code_56_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cph</span><span class="o">.</span><span class="n">baseline_cumulative_hazard_</span><span class="p">,</span> <span class="n">drawstyle</span><span class="o">=</span><span class="s2">&quot;steps-post&quot;</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x1bbf5fbaa00&gt;]
</pre></div>
</div>
<img alt="../../../_images/code_57_1.png" src="../../../_images/code_57_1.png" />
</div>
</div>
</section>
<section id="evaluation-metrics">
<h3>Evaluation metrics<a class="headerlink" href="#evaluation-metrics" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Loglikelihood</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cph</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">Cox_train</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cph</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">Cox_test</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-2.381768817744922
-2.3713571287851862
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#AIC</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cph</span><span class="o">.</span><span class="n">AIC_partial_</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>61376.3647451092
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Concordance index</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cph</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">Cox_train</span><span class="p">,</span> <span class="n">scoring_method</span><span class="o">=</span><span class="s2">&quot;concordance_index&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cph</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">Cox_test</span><span class="p">,</span> <span class="n">scoring_method</span><span class="o">=</span><span class="s2">&quot;concordance_index&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7235763405968183
0.7199926560341724
</pre></div>
</div>
</div>
</div>
<p>Concordance index evaluates the accuracy of the ranking of predicted time. It is in fact a generalization of AUC, another common loss function, and is interpreted similarly:</p>
<p>0.5 is the expected result from random predictions,</p>
<p>1.0 is perfect concordance,</p>
<p>0.0 is perfect anti-concordance (multiply predictions with -1 to get 1.0)</p>
</section>
<section id="cox-predictions-for-all-patients">
<h3>Cox predictions for all patients<a class="headerlink" href="#cox-predictions-for-all-patients" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Cox_all_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Cox_all</span> <span class="o">=</span> <span class="n">Cox_all_data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;SEQN&quot;</span><span class="p">,</span> <span class="s2">&quot;RIDAGEYR&quot;</span><span class="p">],</span>  <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">Cox_all</span> <span class="o">=</span> <span class="n">Cox_all</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;mortstat&#39;</span> <span class="p">:</span> <span class="s1">&#39;event_col&#39;</span><span class="p">,</span> <span class="s1">&#39;permth_exm&#39;</span> <span class="p">:</span> <span class="s1">&#39;duration_col&#39;</span><span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="n">Cox_all_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Cox_all</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(67101, 15)
(67101, 13)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Cox_all</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LBXHGB</th>
      <th>LBXRBCSI</th>
      <th>LBXMCVSI</th>
      <th>LBXMC</th>
      <th>LBXRDW</th>
      <th>LBXPLTSI</th>
      <th>LBXNEPCT</th>
      <th>LBXLYPCT</th>
      <th>LBXMOPCT</th>
      <th>LBXEOPCT</th>
      <th>RIAGENDR</th>
      <th>event_col</th>
      <th>duration_col</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.052801</td>
      <td>0.271317</td>
      <td>-0.254006</td>
      <td>-0.328618</td>
      <td>0.505580</td>
      <td>-0.433887</td>
      <td>0.665549</td>
      <td>-0.529913</td>
      <td>0.083342</td>
      <td>0.157256</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>177.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.303057</td>
      <td>1.002898</td>
      <td>-0.875611</td>
      <td>-0.644740</td>
      <td>0.011453</td>
      <td>-0.518236</td>
      <td>-0.631315</td>
      <td>0.381771</td>
      <td>-1.068364</td>
      <td>0.068833</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>244.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.402732</td>
      <td>0.020168</td>
      <td>-0.441217</td>
      <td>-0.644740</td>
      <td>0.978523</td>
      <td>0.034180</td>
      <td>-1.598215</td>
      <td>0.458768</td>
      <td>-0.683812</td>
      <td>-0.213664</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>236.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.841777</td>
      <td>0.771586</td>
      <td>0.375280</td>
      <td>-0.433677</td>
      <td>0.505580</td>
      <td>-1.318636</td>
      <td>-1.732354</td>
      <td>-0.061419</td>
      <td>-0.244954</td>
      <td>0.025766</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>231.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.620185</td>
      <td>1.679523</td>
      <td>0.179401</td>
      <td>-0.644740</td>
      <td>1.055413</td>
      <td>-0.207797</td>
      <td>2.307305</td>
      <td>-0.678628</td>
      <td>-0.515816</td>
      <td>-0.184487</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>16.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>67096</th>
      <td>-0.010872</td>
      <td>0.117594</td>
      <td>-0.085822</td>
      <td>-0.223871</td>
      <td>1.131771</td>
      <td>-1.318636</td>
      <td>0.428308</td>
      <td>0.778047</td>
      <td>-0.011498</td>
      <td>-0.214549</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>77.0</td>
    </tr>
    <tr>
      <th>67097</th>
      <td>-0.882711</td>
      <td>-0.019099</td>
      <td>-1.106579</td>
      <td>-0.644740</td>
      <td>0.178633</td>
      <td>0.395433</td>
      <td>-0.937020</td>
      <td>1.133553</td>
      <td>-0.252324</td>
      <td>0.364792</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>67098</th>
      <td>0.546501</td>
      <td>0.896876</td>
      <td>-0.186506</td>
      <td>-1.070695</td>
      <td>-0.330703</td>
      <td>-0.239231</td>
      <td>-0.772052</td>
      <td>-0.490041</td>
      <td>-1.405997</td>
      <td>0.062866</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>72.0</td>
    </tr>
    <tr>
      <th>67099</th>
      <td>-1.242038</td>
      <td>-0.756839</td>
      <td>-1.268593</td>
      <td>1.110250</td>
      <td>-0.505844</td>
      <td>2.145874</td>
      <td>-2.594136</td>
      <td>2.286090</td>
      <td>-0.419278</td>
      <td>0.077743</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>67100</th>
      <td>-0.204656</td>
      <td>0.825495</td>
      <td>-1.635030</td>
      <td>-0.223871</td>
      <td>0.261282</td>
      <td>1.341645</td>
      <td>0.027412</td>
      <td>2.618481</td>
      <td>0.416879</td>
      <td>0.118503</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>67101 rows × 13 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cph</span><span class="o">.</span><span class="n">predict_partial_hazard</span><span class="p">(</span><span class="n">Cox_all</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0        1.880782
1        0.517633
2        0.591318
3        1.156117
4        2.107190
           ...   
67096    1.770426
67097    0.566165
67098    0.676137
67099    0.102192
67100    0.292573
Length: 67101, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Cox_all_data</span><span class="p">[</span><span class="s2">&quot;Hazards_predicted&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cph</span><span class="o">.</span><span class="n">predict_partial_hazard</span><span class="p">(</span><span class="n">Cox_all</span><span class="p">)</span>
<span class="n">Cox_all_data</span><span class="p">[</span><span class="s2">&quot;log-hazards&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">Cox_all_data</span><span class="p">[</span><span class="s2">&quot;Hazards_predicted&quot;</span><span class="p">])</span>
<span class="n">Cox_all_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SEQN</th>
      <th>LBXHGB</th>
      <th>LBXRBCSI</th>
      <th>LBXMCVSI</th>
      <th>LBXMC</th>
      <th>LBXRDW</th>
      <th>LBXPLTSI</th>
      <th>LBXNEPCT</th>
      <th>LBXLYPCT</th>
      <th>LBXMOPCT</th>
      <th>LBXEOPCT</th>
      <th>RIAGENDR</th>
      <th>RIDAGEYR</th>
      <th>mortstat</th>
      <th>permth_exm</th>
      <th>Hazards_predicted</th>
      <th>log-hazards</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.0</td>
      <td>0.052801</td>
      <td>0.271317</td>
      <td>-0.254006</td>
      <td>-0.328618</td>
      <td>0.505580</td>
      <td>-0.433887</td>
      <td>0.665549</td>
      <td>-0.529913</td>
      <td>0.083342</td>
      <td>0.157256</td>
      <td>1.0</td>
      <td>77.0</td>
      <td>1.0</td>
      <td>177.0</td>
      <td>1.880782</td>
      <td>0.631688</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5.0</td>
      <td>0.303057</td>
      <td>1.002898</td>
      <td>-0.875611</td>
      <td>-0.644740</td>
      <td>0.011453</td>
      <td>-0.518236</td>
      <td>-0.631315</td>
      <td>0.381771</td>
      <td>-1.068364</td>
      <td>0.068833</td>
      <td>1.0</td>
      <td>49.0</td>
      <td>0.0</td>
      <td>244.0</td>
      <td>0.517633</td>
      <td>-0.658489</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.0</td>
      <td>-0.402732</td>
      <td>0.020168</td>
      <td>-0.441217</td>
      <td>-0.644740</td>
      <td>0.978523</td>
      <td>0.034180</td>
      <td>-1.598215</td>
      <td>0.458768</td>
      <td>-0.683812</td>
      <td>-0.213664</td>
      <td>2.0</td>
      <td>59.0</td>
      <td>0.0</td>
      <td>236.0</td>
      <td>0.591318</td>
      <td>-0.525401</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10.0</td>
      <td>0.841777</td>
      <td>0.771586</td>
      <td>0.375280</td>
      <td>-0.433677</td>
      <td>0.505580</td>
      <td>-1.318636</td>
      <td>-1.732354</td>
      <td>-0.061419</td>
      <td>-0.244954</td>
      <td>0.025766</td>
      <td>1.0</td>
      <td>43.0</td>
      <td>1.0</td>
      <td>231.0</td>
      <td>1.156117</td>
      <td>0.145067</td>
    </tr>
    <tr>
      <th>4</th>
      <td>13.0</td>
      <td>1.620185</td>
      <td>1.679523</td>
      <td>0.179401</td>
      <td>-0.644740</td>
      <td>1.055413</td>
      <td>-0.207797</td>
      <td>2.307305</td>
      <td>-0.678628</td>
      <td>-0.515816</td>
      <td>-0.184487</td>
      <td>1.0</td>
      <td>70.0</td>
      <td>1.0</td>
      <td>16.0</td>
      <td>2.107190</td>
      <td>0.745355</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>67096</th>
      <td>83720.0</td>
      <td>-0.010872</td>
      <td>0.117594</td>
      <td>-0.085822</td>
      <td>-0.223871</td>
      <td>1.131771</td>
      <td>-1.318636</td>
      <td>0.428308</td>
      <td>0.778047</td>
      <td>-0.011498</td>
      <td>-0.214549</td>
      <td>1.0</td>
      <td>36.0</td>
      <td>0.0</td>
      <td>77.0</td>
      <td>1.770426</td>
      <td>0.571220</td>
    </tr>
    <tr>
      <th>67097</th>
      <td>83725.0</td>
      <td>-0.882711</td>
      <td>-0.019099</td>
      <td>-1.106579</td>
      <td>-0.644740</td>
      <td>0.178633</td>
      <td>0.395433</td>
      <td>-0.937020</td>
      <td>1.133553</td>
      <td>-0.252324</td>
      <td>0.364792</td>
      <td>1.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.566165</td>
      <td>-0.568870</td>
    </tr>
    <tr>
      <th>67098</th>
      <td>83727.0</td>
      <td>0.546501</td>
      <td>0.896876</td>
      <td>-0.186506</td>
      <td>-1.070695</td>
      <td>-0.330703</td>
      <td>-0.239231</td>
      <td>-0.772052</td>
      <td>-0.490041</td>
      <td>-1.405997</td>
      <td>0.062866</td>
      <td>1.0</td>
      <td>26.0</td>
      <td>0.0</td>
      <td>72.0</td>
      <td>0.676137</td>
      <td>-0.391360</td>
    </tr>
    <tr>
      <th>67099</th>
      <td>83728.0</td>
      <td>-1.242038</td>
      <td>-0.756839</td>
      <td>-1.268593</td>
      <td>1.110250</td>
      <td>-0.505844</td>
      <td>2.145874</td>
      <td>-2.594136</td>
      <td>2.286090</td>
      <td>-0.419278</td>
      <td>0.077743</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.102192</td>
      <td>-2.280899</td>
    </tr>
    <tr>
      <th>67100</th>
      <td>83730.0</td>
      <td>-0.204656</td>
      <td>0.825495</td>
      <td>-1.635030</td>
      <td>-0.223871</td>
      <td>0.261282</td>
      <td>1.341645</td>
      <td>0.027412</td>
      <td>2.618481</td>
      <td>0.416879</td>
      <td>0.118503</td>
      <td>1.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.292573</td>
      <td>-1.229040</td>
    </tr>
  </tbody>
</table>
<p>67101 rows × 17 columns</p>
</div></div></div>
</div>
</section>
<section id="get-weight-data">
<h3>Get weight data<a class="headerlink" href="#get-weight-data" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path3</span> <span class="o">=</span> <span class="s1">&#39;C:</span><span class="se">\\</span><span class="s1">Users</span><span class="se">\\</span><span class="s1">sidma</span><span class="se">\\</span><span class="s1">Downloads</span><span class="se">\\</span><span class="s1">Weight</span><span class="se">\\</span><span class="s1">&#39;</span>
<span class="n">files3</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">files3</span><span class="p">)</span>

<span class="n">data3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sas</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">path3</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">files3</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
<span class="k">for</span> <span class="n">file3</span> <span class="ow">in</span> <span class="n">files3</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
    <span class="n">data_new3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sas</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">path3</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file3</span><span class="p">)))</span> 
    <span class="n">data3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">data3</span><span class="p">,</span> <span class="n">data_new3</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    
<span class="n">weight</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;SEQN&quot;</span><span class="p">,</span><span class="s2">&quot;BMXWT&quot;</span><span class="p">]</span>
<span class="n">data_weight</span> <span class="o">=</span> <span class="n">data3</span><span class="p">[</span><span class="n">weight</span><span class="p">]</span>
<span class="n">data_weight</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;BMX_A.XPT&#39;, &#39;BMX_B.XPT&#39;, &#39;BMX_C.XPT&#39;, &#39;BMX_D.XPT&#39;, &#39;BMX_E.XPT&#39;, &#39;BMX_F.XPT&#39;, &#39;BMX_G.XPT&#39;, &#39;BMX_H.XPT&#39;]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(78518, 2)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ids_Cox</span> <span class="o">=</span> <span class="n">Cox_all_data</span><span class="p">[</span><span class="s2">&quot;SEQN&quot;</span><span class="p">]</span>
<span class="n">ids_weight</span> <span class="o">=</span> <span class="n">data_weight</span><span class="p">[</span><span class="s2">&quot;SEQN&quot;</span><span class="p">]</span>
<span class="n">data_weight</span> <span class="o">=</span> <span class="n">data_weight</span><span class="p">[</span><span class="n">ids_weight</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">ids_Cox</span><span class="p">)]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">data_weight</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>


<span class="n">Cox_all_data</span> <span class="o">=</span> <span class="n">Cox_all_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;SEQN&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data_weight</span> <span class="o">=</span> <span class="n">data_weight</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;SEQN&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Cox_all_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">Cox_all_data</span><span class="p">,</span><span class="n">data_weight</span><span class="p">[[</span><span class="s2">&quot;BMXWT&quot;</span><span class="p">]]],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">Cox_all_data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(67101, 2)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(67101, 18)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scaler_weight</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">scaler_weight</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Cox_all_data</span><span class="p">[[</span><span class="s2">&quot;BMXWT&quot;</span><span class="p">]])</span>  

<span class="n">Cox_all_data</span><span class="p">[</span><span class="s2">&quot;weight_normalised&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaler_weight</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">Cox_all_data</span><span class="p">[[</span><span class="s2">&quot;BMXWT&quot;</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="dosi-log-hazards">
<h3>DOSI = log-hazards<a class="headerlink" href="#dosi-log-hazards" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bins</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">Cox_all_data</span><span class="p">[</span><span class="s1">&#39;age_binned&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">Cox_all_data</span><span class="p">[</span><span class="s2">&quot;RIDAGEYR&quot;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Cox_final_binned</span> <span class="o">=</span> <span class="n">Cox_all_data</span><span class="p">[[</span><span class="s1">&#39;age_binned&#39;</span><span class="p">,</span> <span class="s2">&quot;log-hazards&quot;</span><span class="p">,</span> <span class="s2">&quot;BMXWT&quot;</span><span class="p">,</span> <span class="s2">&quot;weight_normalised&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;age_binned&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1">#Cox_final_binned.columns</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Cox_final_binned</span> <span class="p">[(</span> <span class="s1">&#39;age_binned&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)],</span> <span class="n">Cox_final_binned</span> <span class="p">[(</span><span class="s1">&#39;log-hazards&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">)],</span> <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Real log-HR&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Cox_final_binned</span> <span class="p">[(</span> <span class="s1">&#39;age_binned&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)],</span> <span class="n">Cox_final_binned</span> <span class="p">[(</span><span class="s1">&#39;log-hazards&#39;</span><span class="p">,</span> <span class="s1">&#39;25%&#39;</span><span class="p">)],</span> <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;pink&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Real log-HR IQR&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Cox_final_binned</span> <span class="p">[(</span> <span class="s1">&#39;age_binned&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)],</span> <span class="n">Cox_final_binned</span> <span class="p">[(</span><span class="s1">&#39;log-hazards&#39;</span><span class="p">,</span> <span class="s1">&#39;75%&#39;</span><span class="p">)],</span> <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;pink&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">Cox_final_binned</span> <span class="p">[(</span> <span class="s1">&#39;age_binned&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)],</span> <span class="n">Cox_final_binned</span> <span class="p">[(</span><span class="s1">&#39;log-hazards&#39;</span><span class="p">,</span> <span class="s1">&#39;25%&#39;</span><span class="p">)],</span> <span class="n">Cox_final_binned</span> <span class="p">[(</span><span class="s1">&#39;log-hazards&#39;</span><span class="p">,</span> <span class="s1">&#39;75%&#39;</span><span class="p">)],</span> <span class="n">facecolor</span><span class="o">=</span> <span class="s2">&quot;pink&quot;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=-</span><span class="mf">0.3</span><span class="p">,</span>  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;log-HR&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Age, years&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Age influence&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/code_75_0.png" src="../../../_images/code_75_0.png" />
</div>
</div>
</section>
<section id="body-mass-and-treoretical-projectory">
<h3>Body mass and treoretical projectory<a class="headerlink" href="#body-mass-and-treoretical-projectory" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Cox_final_binned</span> <span class="p">[(</span> <span class="s1">&#39;age_binned&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)],</span> <span class="n">Cox_final_binned</span> <span class="p">[(</span><span class="s2">&quot;BMXWT&quot;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">)],</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;purple&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Real body mass&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Cox_final_binned</span> <span class="p">[(</span> <span class="s1">&#39;age_binned&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)],</span> <span class="n">Cox_final_binned</span> <span class="p">[(</span><span class="s2">&quot;BMXWT&quot;</span><span class="p">,</span> <span class="s1">&#39;25%&#39;</span><span class="p">)],</span> <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;purple&quot;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Real body mass IQR&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Cox_final_binned</span> <span class="p">[(</span> <span class="s1">&#39;age_binned&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)],</span> <span class="n">Cox_final_binned</span> <span class="p">[(</span><span class="s2">&quot;BMXWT&quot;</span><span class="p">,</span> <span class="s1">&#39;75%&#39;</span><span class="p">)],</span> <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;purple&quot;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">Cox_final_binned</span> <span class="p">[(</span> <span class="s1">&#39;age_binned&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)],</span> <span class="n">Cox_final_binned</span> <span class="p">[(</span><span class="s2">&quot;BMXWT&quot;</span><span class="p">,</span> <span class="s1">&#39;25%&#39;</span><span class="p">)],</span> <span class="n">Cox_final_binned</span> <span class="p">[(</span><span class="s2">&quot;BMXWT&quot;</span><span class="p">,</span> <span class="s1">&#39;75%&#39;</span><span class="p">)],</span> <span class="n">facecolor</span><span class="o">=</span> <span class="s2">&quot;purple&quot;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.15</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span>  <span class="n">X</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="p">(</span><span class="n">x0</span><span class="o">/</span><span class="n">X</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="o">/</span><span class="n">t0</span><span class="p">))</span><span class="o">**</span><span class="mi">4</span>  

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
<span class="n">t0</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">X</span> <span class="o">=</span> <span class="mi">83</span>
<span class="n">x0</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">x0</span> <span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Theoretical body mass&#39;</span><span class="p">,</span>  <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">2</span><span class="p">);</span>

<span class="c1">#plt.axvline(x=20,  color=&#39;lightgrey&#39;, ls=&#39;--&#39;, lw=2)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#plt.axhline(y=83,  color=&#39;grey&#39;, ls=&#39;--&#39;, lw=1)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Body mass&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Age, years&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Body mass changes with age&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/code_77_0.png" src="../../../_images/code_77_0.png" />
</div>
</div>
</section>
<section id="b-hazard-and-bogy-mass-on-one-plot">
<h3>1B: Hazard and bogy mass on one plot<a class="headerlink" href="#b-hazard-and-bogy-mass-on-one-plot" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Cox_final_binned</span> <span class="p">[(</span> <span class="s1">&#39;age_binned&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)],</span> <span class="n">Cox_final_binned</span> <span class="p">[(</span><span class="s1">&#39;log-hazards&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">)],</span> <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Real log-HR&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Cox_final_binned</span> <span class="p">[(</span> <span class="s1">&#39;age_binned&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)],</span> <span class="n">Cox_final_binned</span> <span class="p">[(</span><span class="s1">&#39;log-hazards&#39;</span><span class="p">,</span> <span class="s1">&#39;25%&#39;</span><span class="p">)],</span> <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;pink&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Real log-HR IQR&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Cox_final_binned</span> <span class="p">[(</span> <span class="s1">&#39;age_binned&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)],</span> <span class="n">Cox_final_binned</span> <span class="p">[(</span><span class="s1">&#39;log-hazards&#39;</span><span class="p">,</span> <span class="s1">&#39;75%&#39;</span><span class="p">)],</span> <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;pink&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">Cox_final_binned</span> <span class="p">[(</span> <span class="s1">&#39;age_binned&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)],</span> <span class="n">Cox_final_binned</span> <span class="p">[(</span><span class="s1">&#39;log-hazards&#39;</span><span class="p">,</span> <span class="s1">&#39;25%&#39;</span><span class="p">)],</span> <span class="n">Cox_final_binned</span> <span class="p">[(</span><span class="s1">&#39;log-hazards&#39;</span><span class="p">,</span> <span class="s1">&#39;75%&#39;</span><span class="p">)],</span> <span class="n">facecolor</span><span class="o">=</span> <span class="s2">&quot;pink&quot;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=-</span><span class="mf">0.3</span><span class="p">,</span>  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Cox_final_binned</span> <span class="p">[(</span> <span class="s1">&#39;age_binned&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)],</span> <span class="n">Cox_final_binned</span> <span class="p">[(</span><span class="s2">&quot;BMXWT&quot;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">)]</span> <span class="o">/</span><span class="mi">80</span> <span class="o">-</span> <span class="mf">1.35</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;purple&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Real body mass&#39;</span> <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;log-HR / scaled body mass&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Age, years&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Hazard and Body mass are influenced by age&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/code_79_0.png" src="../../../_images/code_79_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Cox_all_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SEQN</th>
      <th>LBXHGB</th>
      <th>LBXRBCSI</th>
      <th>LBXMCVSI</th>
      <th>LBXMC</th>
      <th>LBXRDW</th>
      <th>LBXPLTSI</th>
      <th>LBXNEPCT</th>
      <th>LBXLYPCT</th>
      <th>LBXMOPCT</th>
      <th>LBXEOPCT</th>
      <th>RIAGENDR</th>
      <th>RIDAGEYR</th>
      <th>mortstat</th>
      <th>permth_exm</th>
      <th>Hazards_predicted</th>
      <th>log-hazards</th>
      <th>BMXWT</th>
      <th>weight_normalised</th>
      <th>age_binned</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.0</td>
      <td>0.052801</td>
      <td>0.271317</td>
      <td>-0.254006</td>
      <td>-0.328618</td>
      <td>0.505580</td>
      <td>-0.433887</td>
      <td>0.665549</td>
      <td>-0.529913</td>
      <td>0.083342</td>
      <td>0.157256</td>
      <td>1.0</td>
      <td>77.0</td>
      <td>1.0</td>
      <td>177.0</td>
      <td>1.880782</td>
      <td>0.631688</td>
      <td>75.4</td>
      <td>0.322719</td>
      <td>76</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.0</td>
      <td>-0.204656</td>
      <td>-0.137938</td>
      <td>-0.527093</td>
      <td>0.908259</td>
      <td>-1.235608</td>
      <td>0.395433</td>
      <td>-0.765124</td>
      <td>1.044998</td>
      <td>0.434488</td>
      <td>0.366020</td>
      <td>2.0</td>
      <td>10.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.300238</td>
      <td>-1.203180</td>
      <td>32.9</td>
      <td>-1.143486</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.0</td>
      <td>-3.670187</td>
      <td>0.347206</td>
      <td>-5.701905</td>
      <td>-2.491711</td>
      <td>1.724324</td>
      <td>2.380682</td>
      <td>-1.599316</td>
      <td>2.655858</td>
      <td>0.116103</td>
      <td>0.347350</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.141818</td>
      <td>-1.953211</td>
      <td>13.3</td>
      <td>-1.819665</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5.0</td>
      <td>0.303057</td>
      <td>1.002898</td>
      <td>-0.875611</td>
      <td>-0.644740</td>
      <td>0.011453</td>
      <td>-0.518236</td>
      <td>-0.631315</td>
      <td>0.381771</td>
      <td>-1.068364</td>
      <td>0.068833</td>
      <td>1.0</td>
      <td>49.0</td>
      <td>0.0</td>
      <td>244.0</td>
      <td>0.517633</td>
      <td>-0.658489</td>
      <td>92.5</td>
      <td>0.912651</td>
      <td>46</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6.0</td>
      <td>-0.605292</td>
      <td>-0.756839</td>
      <td>0.277661</td>
      <td>-0.223871</td>
      <td>-0.244164</td>
      <td>2.241660</td>
      <td>1.582488</td>
      <td>-0.116375</td>
      <td>-1.405997</td>
      <td>0.061251</td>
      <td>2.0</td>
      <td>19.0</td>
      <td>0.0</td>
      <td>245.0</td>
      <td>0.724123</td>
      <td>-0.322794</td>
      <td>59.2</td>
      <td>-0.236164</td>
      <td>16</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>67096</th>
      <td>83725.0</td>
      <td>-0.882711</td>
      <td>-0.019099</td>
      <td>-1.106579</td>
      <td>-0.644740</td>
      <td>0.178633</td>
      <td>0.395433</td>
      <td>-0.937020</td>
      <td>1.133553</td>
      <td>-0.252324</td>
      <td>0.364792</td>
      <td>1.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.566165</td>
      <td>-0.568870</td>
      <td>22.8</td>
      <td>-1.491925</td>
      <td>6</td>
    </tr>
    <tr>
      <th>67097</th>
      <td>83727.0</td>
      <td>0.546501</td>
      <td>0.896876</td>
      <td>-0.186506</td>
      <td>-1.070695</td>
      <td>-0.330703</td>
      <td>-0.239231</td>
      <td>-0.772052</td>
      <td>-0.490041</td>
      <td>-1.405997</td>
      <td>0.062866</td>
      <td>1.0</td>
      <td>26.0</td>
      <td>0.0</td>
      <td>72.0</td>
      <td>0.676137</td>
      <td>-0.391360</td>
      <td>71.8</td>
      <td>0.198523</td>
      <td>26</td>
    </tr>
    <tr>
      <th>67098</th>
      <td>83728.0</td>
      <td>-1.242038</td>
      <td>-0.756839</td>
      <td>-1.268593</td>
      <td>1.110250</td>
      <td>-0.505844</td>
      <td>2.145874</td>
      <td>-2.594136</td>
      <td>2.286090</td>
      <td>-0.419278</td>
      <td>0.077743</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.102192</td>
      <td>-2.280899</td>
      <td>11.3</td>
      <td>-1.888663</td>
      <td>1</td>
    </tr>
    <tr>
      <th>67099</th>
      <td>83729.0</td>
      <td>-1.242038</td>
      <td>-0.885888</td>
      <td>-0.152869</td>
      <td>-1.177993</td>
      <td>0.823117</td>
      <td>-0.450598</td>
      <td>-0.568557</td>
      <td>0.650140</td>
      <td>0.559114</td>
      <td>-0.017782</td>
      <td>2.0</td>
      <td>42.0</td>
      <td>0.0</td>
      <td>75.0</td>
      <td>1.496126</td>
      <td>0.402879</td>
      <td>89.6</td>
      <td>0.812604</td>
      <td>41</td>
    </tr>
    <tr>
      <th>67100</th>
      <td>83730.0</td>
      <td>-0.204656</td>
      <td>0.825495</td>
      <td>-1.635030</td>
      <td>-0.223871</td>
      <td>0.261282</td>
      <td>1.341645</td>
      <td>0.027412</td>
      <td>2.618481</td>
      <td>0.416879</td>
      <td>0.118503</td>
      <td>1.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.292573</td>
      <td>-1.229040</td>
      <td>22.8</td>
      <td>-1.491925</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
<p>67101 rows × 20 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Cox_all_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;Cox_all_data&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="frialty-investigation">
<h1>Frialty investigation<a class="headerlink" href="#frialty-investigation" title="Permalink to this headline">#</a></h1>
<section id="id1">
<h2>Data preparation<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h2>
<section id="get-frial-data">
<h3>Get frial data<a class="headerlink" href="#get-frial-data" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Cox_all_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;.../Cox_all_data.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Cox_all_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-e2d85d29-8742-4bdf-a3a8-5ba2038c529d">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SEQN</th>
      <th>LBXHGB</th>
      <th>LBXRBCSI</th>
      <th>LBXMCVSI</th>
      <th>LBXMC</th>
      <th>LBXRDW</th>
      <th>LBXPLTSI</th>
      <th>LBXNEPCT</th>
      <th>LBXLYPCT</th>
      <th>LBXMOPCT</th>
      <th>LBXEOPCT</th>
      <th>RIAGENDR</th>
      <th>RIDAGEYR</th>
      <th>mortstat</th>
      <th>permth_exm</th>
      <th>Hazards_predicted</th>
      <th>log-hazards</th>
      <th>BMXWT</th>
      <th>weight_normalised</th>
      <th>age_binned</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.0</td>
      <td>0.052801</td>
      <td>0.271317</td>
      <td>-0.254006</td>
      <td>-0.328618</td>
      <td>0.505580</td>
      <td>-0.433887</td>
      <td>0.665549</td>
      <td>-0.529913</td>
      <td>0.083342</td>
      <td>0.157256</td>
      <td>1.0</td>
      <td>77.0</td>
      <td>1.0</td>
      <td>177.0</td>
      <td>1.880782</td>
      <td>0.631688</td>
      <td>75.4</td>
      <td>0.322719</td>
      <td>76</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.0</td>
      <td>-0.204656</td>
      <td>-0.137938</td>
      <td>-0.527093</td>
      <td>0.908259</td>
      <td>-1.235608</td>
      <td>0.395433</td>
      <td>-0.765124</td>
      <td>1.044998</td>
      <td>0.434488</td>
      <td>0.366020</td>
      <td>2.0</td>
      <td>10.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.300238</td>
      <td>-1.203180</td>
      <td>32.9</td>
      <td>-1.143486</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.0</td>
      <td>-3.670187</td>
      <td>0.347206</td>
      <td>-5.701905</td>
      <td>-2.491711</td>
      <td>1.724324</td>
      <td>2.380682</td>
      <td>-1.599316</td>
      <td>2.655858</td>
      <td>0.116103</td>
      <td>0.347350</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.141818</td>
      <td>-1.953211</td>
      <td>13.3</td>
      <td>-1.819665</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5.0</td>
      <td>0.303057</td>
      <td>1.002898</td>
      <td>-0.875611</td>
      <td>-0.644740</td>
      <td>0.011453</td>
      <td>-0.518236</td>
      <td>-0.631315</td>
      <td>0.381771</td>
      <td>-1.068364</td>
      <td>0.068833</td>
      <td>1.0</td>
      <td>49.0</td>
      <td>0.0</td>
      <td>244.0</td>
      <td>0.517633</td>
      <td>-0.658489</td>
      <td>92.5</td>
      <td>0.912651</td>
      <td>46</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6.0</td>
      <td>-0.605292</td>
      <td>-0.756839</td>
      <td>0.277661</td>
      <td>-0.223871</td>
      <td>-0.244164</td>
      <td>2.241660</td>
      <td>1.582488</td>
      <td>-0.116375</td>
      <td>-1.405997</td>
      <td>0.061251</td>
      <td>2.0</td>
      <td>19.0</td>
      <td>0.0</td>
      <td>245.0</td>
      <td>0.724123</td>
      <td>-0.322794</td>
      <td>59.2</td>
      <td>-0.236164</td>
      <td>16</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>67096</th>
      <td>83725.0</td>
      <td>-0.882711</td>
      <td>-0.019099</td>
      <td>-1.106579</td>
      <td>-0.644740</td>
      <td>0.178633</td>
      <td>0.395433</td>
      <td>-0.937020</td>
      <td>1.133553</td>
      <td>-0.252324</td>
      <td>0.364792</td>
      <td>1.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.566165</td>
      <td>-0.568870</td>
      <td>22.8</td>
      <td>-1.491925</td>
      <td>6</td>
    </tr>
    <tr>
      <th>67097</th>
      <td>83727.0</td>
      <td>0.546501</td>
      <td>0.896876</td>
      <td>-0.186506</td>
      <td>-1.070695</td>
      <td>-0.330703</td>
      <td>-0.239231</td>
      <td>-0.772052</td>
      <td>-0.490041</td>
      <td>-1.405997</td>
      <td>0.062866</td>
      <td>1.0</td>
      <td>26.0</td>
      <td>0.0</td>
      <td>72.0</td>
      <td>0.676137</td>
      <td>-0.391360</td>
      <td>71.8</td>
      <td>0.198523</td>
      <td>26</td>
    </tr>
    <tr>
      <th>67098</th>
      <td>83728.0</td>
      <td>-1.242038</td>
      <td>-0.756839</td>
      <td>-1.268593</td>
      <td>1.110250</td>
      <td>-0.505844</td>
      <td>2.145874</td>
      <td>-2.594136</td>
      <td>2.286090</td>
      <td>-0.419278</td>
      <td>0.077743</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.102192</td>
      <td>-2.280899</td>
      <td>11.3</td>
      <td>-1.888663</td>
      <td>1</td>
    </tr>
    <tr>
      <th>67099</th>
      <td>83729.0</td>
      <td>-1.242038</td>
      <td>-0.885888</td>
      <td>-0.152869</td>
      <td>-1.177993</td>
      <td>0.823117</td>
      <td>-0.450598</td>
      <td>-0.568557</td>
      <td>0.650140</td>
      <td>0.559114</td>
      <td>-0.017782</td>
      <td>2.0</td>
      <td>42.0</td>
      <td>0.0</td>
      <td>75.0</td>
      <td>1.496126</td>
      <td>0.402879</td>
      <td>89.6</td>
      <td>0.812604</td>
      <td>41</td>
    </tr>
    <tr>
      <th>67100</th>
      <td>83730.0</td>
      <td>-0.204656</td>
      <td>0.825495</td>
      <td>-1.635030</td>
      <td>-0.223871</td>
      <td>0.261282</td>
      <td>1.341645</td>
      <td>0.027412</td>
      <td>2.618481</td>
      <td>0.416879</td>
      <td>0.118503</td>
      <td>1.0</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.292573</td>
      <td>-1.229040</td>
      <td>22.8</td>
      <td>-1.491925</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
<p>67101 rows × 20 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-e2d85d29-8742-4bdf-a3a8-5ba2038c529d')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-e2d85d29-8742-4bdf-a3a8-5ba2038c529d button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-e2d85d29-8742-4bdf-a3a8-5ba2038c529d');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;.../MCQ/XPT/&#39;</span>
<span class="n">files</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>

<span class="n">data_frial</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sas</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
    <span class="n">data_new</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sas</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file</span><span class="p">)))</span>
    <span class="n">data_frial</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">data_frial</span><span class="p">,</span> <span class="n">data_new</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;MCQ_05_06.XPT&#39;, &#39;MCQ_13_14.XPT&#39;, &#39;MCQ_03_04.XPT&#39;, &#39;MCQ_09_10.XPT&#39;, &#39;MCQ_99_00.XPT&#39;, &#39;MCQ_01_02.XPT&#39;, &#39;MCQ_07_08.XPT&#39;, &#39;MCQ_11_12.XPT&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
&lt;ipython-input-103-f7523ed17793&gt;:7: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  data_new = pd.read_sas(join(path, &#39;{}&#39;.format(file)))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_frial</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-652beb35-3891-41ac-b93b-22a42e574d49">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SEQN</th>
      <th>MCQ010</th>
      <th>MCQ025</th>
      <th>MCQ035</th>
      <th>MCQ040</th>
      <th>MCQ050</th>
      <th>MCQ053</th>
      <th>MCQ080</th>
      <th>MCQ092</th>
      <th>MCD093</th>
      <th>...</th>
      <th>MCQ260DD</th>
      <th>MCQ260DE</th>
      <th>MCQ260DF</th>
      <th>MCQ260DG</th>
      <th>MCQ260DH</th>
      <th>MCQ260DI</th>
      <th>MCD147</th>
      <th>MCD160M</th>
      <th>MCD170M</th>
      <th>MCD180M</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>31128.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>31129.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>31130.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>9.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>31131.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>31132.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>78334</th>
      <td>71912.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>78335</th>
      <td>71913.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>78336</th>
      <td>71914.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>78337</th>
      <td>71915.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>78338</th>
      <td>71916.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>78339 rows × 220 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-652beb35-3891-41ac-b93b-22a42e574d49')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-652beb35-3891-41ac-b93b-22a42e574d49 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-652beb35-3891-41ac-b93b-22a42e574d49');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
</div></div>
</div>
<p>Data coded in following way:
1 - Yes; 2 - No; 7 - Refused; 9 - Don’t know</p>
<p>MCQ100 - hypertension;
MCQ160A - arthritis;
MCQ220 - cancer;
MCQ160C - coronary heart disease;
MCQ160D - angina/angina pectoris;
MCQ160G - emphysema;
MCQ160E - heart attack;
MCQ160F - stroke;
MCQ160B - congestive heart failure;
MCQ160K - chronic bronchitis;</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col_fr</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;SEQN&quot;</span><span class="p">,</span> <span class="s2">&quot;MCQ100&quot;</span><span class="p">,</span><span class="s2">&quot;MCQ160A&quot;</span><span class="p">,</span><span class="s2">&quot;MCQ220&quot;</span><span class="p">,</span><span class="s2">&quot;MCQ160C&quot;</span><span class="p">,</span><span class="s2">&quot;MCQ160D&quot;</span><span class="p">,</span><span class="s2">&quot;MCQ160G&quot;</span><span class="p">,</span><span class="s2">&quot;MCQ160E&quot;</span><span class="p">,</span><span class="s2">&quot;MCQ160F&quot;</span><span class="p">,</span><span class="s2">&quot;MCQ160B&quot;</span><span class="p">,</span><span class="s2">&quot;MCQ160K&quot;</span><span class="p">]</span>
<span class="n">data_frial</span> <span class="o">=</span> <span class="n">data_frial</span><span class="p">[</span><span class="n">col_fr</span><span class="p">]</span>
<span class="n">data_frial</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(78339, 11)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_frial_sum</span> <span class="o">=</span> <span class="n">data_frial</span><span class="p">[</span><span class="n">data_frial</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">data_frial_sum</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0    61843
1.0    10140
2.0     3799
3.0     1388
4.0      699
5.0      291
6.0      116
7.0       53
8.0        9
9.0        1
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>####CMI calculation</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_frial</span><span class="p">[</span><span class="s1">&#39;n_diagnoses&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_frial_sum</span>
<span class="n">data_frial</span><span class="p">[</span><span class="s1">&#39;CMI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_frial</span><span class="p">[</span><span class="s1">&#39;n_diagnoses&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">10</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-107-5c99dfe8f6cc&gt;:1: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_frial[&#39;n_diagnoses&#39;] = data_frial_sum
&lt;ipython-input-107-5c99dfe8f6cc&gt;:2: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_frial[&#39;CMI&#39;] = data_frial[&#39;n_diagnoses&#39;]/10
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_frial</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-0283a554-b6e9-4230-ada0-3ee76c3f6fe5">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SEQN</th>
      <th>MCQ100</th>
      <th>MCQ160A</th>
      <th>MCQ220</th>
      <th>MCQ160C</th>
      <th>MCQ160D</th>
      <th>MCQ160G</th>
      <th>MCQ160E</th>
      <th>MCQ160F</th>
      <th>MCQ160B</th>
      <th>MCQ160K</th>
      <th>n_diagnoses</th>
      <th>CMI</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>31128.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>31129.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>31130.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>31131.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>31132.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>78334</th>
      <td>71912.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>78335</th>
      <td>71913.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>78336</th>
      <td>71914.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>78337</th>
      <td>71915.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>78338</th>
      <td>71916.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>78339 rows × 13 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-0283a554-b6e9-4230-ada0-3ee76c3f6fe5')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-0283a554-b6e9-4230-ada0-3ee76c3f6fe5 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-0283a554-b6e9-4230-ada0-3ee76c3f6fe5');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
</div></div>
</div>
<p>####Merge with previous data</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ids</span> <span class="o">=</span> <span class="n">Cox_all_data</span><span class="p">[</span><span class="s2">&quot;SEQN&quot;</span><span class="p">]</span>
<span class="n">ids_frial</span> <span class="o">=</span> <span class="n">data_frial</span><span class="p">[</span><span class="s2">&quot;SEQN&quot;</span><span class="p">]</span>
<span class="n">data_frial</span> <span class="o">=</span> <span class="n">data_frial</span><span class="p">[</span><span class="n">ids_frial</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">ids</span><span class="p">)]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;SEQN&quot;</span><span class="p">])</span>
<span class="n">data_frial</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(67101, 13)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_frial</span> <span class="o">=</span> <span class="n">data_frial</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Cox_all_data</span> <span class="o">=</span> <span class="n">Cox_all_data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Cox_all_data_fr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">Cox_all_data</span><span class="p">,</span><span class="n">data_frial</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">Cox_all_data_fr</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(67101, 32)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Cox_all_data_fr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-b67a9891-b080-423b-8a3d-ff17f4b398c3">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SEQN</th>
      <th>LBXHGB</th>
      <th>LBXRBCSI</th>
      <th>LBXMCVSI</th>
      <th>LBXMC</th>
      <th>LBXRDW</th>
      <th>LBXPLTSI</th>
      <th>LBXNEPCT</th>
      <th>LBXLYPCT</th>
      <th>LBXMOPCT</th>
      <th>...</th>
      <th>MCQ220</th>
      <th>MCQ160C</th>
      <th>MCQ160D</th>
      <th>MCQ160G</th>
      <th>MCQ160E</th>
      <th>MCQ160F</th>
      <th>MCQ160B</th>
      <th>MCQ160K</th>
      <th>n_diagnoses</th>
      <th>CMI</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.0</td>
      <td>0.052801</td>
      <td>0.271317</td>
      <td>-0.254006</td>
      <td>-0.328618</td>
      <td>0.505580</td>
      <td>-0.433887</td>
      <td>0.665549</td>
      <td>-0.529913</td>
      <td>0.083342</td>
      <td>...</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.0</td>
      <td>-0.204656</td>
      <td>-0.137938</td>
      <td>-0.527093</td>
      <td>0.908259</td>
      <td>-1.235608</td>
      <td>0.395433</td>
      <td>-0.765124</td>
      <td>1.044998</td>
      <td>0.434488</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.0</td>
      <td>-3.670187</td>
      <td>0.347206</td>
      <td>-5.701905</td>
      <td>-2.491711</td>
      <td>1.724324</td>
      <td>2.380682</td>
      <td>-1.599316</td>
      <td>2.655858</td>
      <td>0.116103</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5.0</td>
      <td>0.303057</td>
      <td>1.002898</td>
      <td>-0.875611</td>
      <td>-0.644740</td>
      <td>0.011453</td>
      <td>-0.518236</td>
      <td>-0.631315</td>
      <td>0.381771</td>
      <td>-1.068364</td>
      <td>...</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6.0</td>
      <td>-0.605292</td>
      <td>-0.756839</td>
      <td>0.277661</td>
      <td>-0.223871</td>
      <td>-0.244164</td>
      <td>2.241660</td>
      <td>1.582488</td>
      <td>-0.116375</td>
      <td>-1.405997</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>67096</th>
      <td>83725.0</td>
      <td>-0.882711</td>
      <td>-0.019099</td>
      <td>-1.106579</td>
      <td>-0.644740</td>
      <td>0.178633</td>
      <td>0.395433</td>
      <td>-0.937020</td>
      <td>1.133553</td>
      <td>-0.252324</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>67097</th>
      <td>83727.0</td>
      <td>0.546501</td>
      <td>0.896876</td>
      <td>-0.186506</td>
      <td>-1.070695</td>
      <td>-0.330703</td>
      <td>-0.239231</td>
      <td>-0.772052</td>
      <td>-0.490041</td>
      <td>-1.405997</td>
      <td>...</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>67098</th>
      <td>83728.0</td>
      <td>-1.242038</td>
      <td>-0.756839</td>
      <td>-1.268593</td>
      <td>1.110250</td>
      <td>-0.505844</td>
      <td>2.145874</td>
      <td>-2.594136</td>
      <td>2.286090</td>
      <td>-0.419278</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>67099</th>
      <td>83729.0</td>
      <td>-1.242038</td>
      <td>-0.885888</td>
      <td>-0.152869</td>
      <td>-1.177993</td>
      <td>0.823117</td>
      <td>-0.450598</td>
      <td>-0.568557</td>
      <td>0.650140</td>
      <td>0.559114</td>
      <td>...</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>67100</th>
      <td>83730.0</td>
      <td>-0.204656</td>
      <td>0.825495</td>
      <td>-1.635030</td>
      <td>-0.223871</td>
      <td>0.261282</td>
      <td>1.341645</td>
      <td>0.027412</td>
      <td>2.618481</td>
      <td>0.416879</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>67101 rows × 32 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-b67a9891-b080-423b-8a3d-ff17f4b398c3')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-b67a9891-b080-423b-8a3d-ff17f4b398c3 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-b67a9891-b080-423b-8a3d-ff17f4b398c3');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Cox_all_data_fr</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;Cox_all_data_fr.csv&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bins2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">labels2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">Cox_all_data_fr</span><span class="p">[</span><span class="s1">&#39;age_binned2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">Cox_all_data_fr</span><span class="p">[</span><span class="s2">&quot;RIDAGEYR&quot;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins2</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels2</span><span class="p">)</span>

<span class="n">Cox_frail_binned</span> <span class="o">=</span> <span class="n">Cox_all_data_fr</span><span class="p">[</span><span class="n">Cox_all_data_fr</span><span class="o">.</span><span class="n">CMI</span><span class="o">&gt;=</span><span class="mf">0.6</span><span class="p">][[</span><span class="s1">&#39;age_binned2&#39;</span><span class="p">,</span> <span class="s2">&quot;log-hazards&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;age_binned2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">Cox_frail_binned</span>


<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Cox_final_binned</span> <span class="p">[(</span> <span class="s1">&#39;age_binned&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)],</span> <span class="n">Cox_final_binned</span> <span class="p">[(</span><span class="s1">&#39;log-hazards&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">)],</span> <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Real log-HR&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Cox_final_binned</span> <span class="p">[(</span> <span class="s1">&#39;age_binned&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)],</span> <span class="n">Cox_final_binned</span> <span class="p">[(</span><span class="s1">&#39;log-hazards&#39;</span><span class="p">,</span> <span class="s1">&#39;25%&#39;</span><span class="p">)],</span> <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;pink&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Real log-HR IQR&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Cox_final_binned</span> <span class="p">[(</span> <span class="s1">&#39;age_binned&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)],</span> <span class="n">Cox_final_binned</span> <span class="p">[(</span><span class="s1">&#39;log-hazards&#39;</span><span class="p">,</span> <span class="s1">&#39;75%&#39;</span><span class="p">)],</span> <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;pink&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">Cox_final_binned</span> <span class="p">[(</span> <span class="s1">&#39;age_binned&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)],</span> <span class="n">Cox_final_binned</span> <span class="p">[(</span><span class="s1">&#39;log-hazards&#39;</span><span class="p">,</span> <span class="s1">&#39;25%&#39;</span><span class="p">)],</span> <span class="n">Cox_final_binned</span> <span class="p">[(</span><span class="s1">&#39;log-hazards&#39;</span><span class="p">,</span> <span class="s1">&#39;75%&#39;</span><span class="p">)],</span> <span class="n">facecolor</span><span class="o">=</span> <span class="s2">&quot;pink&quot;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=-</span><span class="mf">0.3</span><span class="p">,</span>  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1">#plt.plot(Cox_final_binned [( &#39;age_binned&#39;, &#39;&#39;)], Cox_final_binned [(&quot;BMXWT&quot;, &#39;mean&#39;)] /80 - 1.35, c = &quot;purple&quot;, ls=&#39;:&#39;, lw=4, label = &#39;Real body mass&#39; )</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Cox_frail_binned</span> <span class="p">[</span><span class="s1">&#39;age_binned2&#39;</span><span class="p">],</span> <span class="n">Cox_frail_binned</span> <span class="p">[</span><span class="s1">&#39;log-hazards&#39;</span><span class="p">],</span> <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Most frail log-HR &quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;log-HR&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Age, years&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Hazard is influenced by age&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bins2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">labels2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">Cox_all_data_fr</span><span class="p">[</span><span class="s1">&#39;age_binned2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">Cox_all_data_fr</span><span class="p">[</span><span class="s2">&quot;RIDAGEYR&quot;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins2</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels2</span><span class="p">)</span>

<span class="n">Cox_frail_binned</span> <span class="o">=</span> <span class="n">Cox_all_data_fr</span><span class="p">[</span><span class="n">Cox_all_data_fr</span><span class="o">.</span><span class="n">CMI</span><span class="o">&gt;=</span><span class="mf">0.6</span><span class="p">][[</span><span class="s1">&#39;age_binned2&#39;</span><span class="p">,</span> <span class="s2">&quot;log-hazards&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;age_binned2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">Cox_frail_binned</span>


<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Cox_final_binned</span> <span class="p">[(</span> <span class="s1">&#39;age_binned&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)],</span> <span class="n">Cox_final_binned</span> <span class="p">[(</span><span class="s1">&#39;log-hazards&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">)],</span> <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Real log-HR&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Cox_final_binned</span> <span class="p">[(</span> <span class="s1">&#39;age_binned&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)],</span> <span class="n">Cox_final_binned</span> <span class="p">[(</span><span class="s1">&#39;log-hazards&#39;</span><span class="p">,</span> <span class="s1">&#39;25%&#39;</span><span class="p">)],</span> <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;pink&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Real log-HR IQR&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Cox_final_binned</span> <span class="p">[(</span> <span class="s1">&#39;age_binned&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)],</span> <span class="n">Cox_final_binned</span> <span class="p">[(</span><span class="s1">&#39;log-hazards&#39;</span><span class="p">,</span> <span class="s1">&#39;75%&#39;</span><span class="p">)],</span> <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;pink&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">Cox_final_binned</span> <span class="p">[(</span> <span class="s1">&#39;age_binned&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)],</span> <span class="n">Cox_final_binned</span> <span class="p">[(</span><span class="s1">&#39;log-hazards&#39;</span><span class="p">,</span> <span class="s1">&#39;25%&#39;</span><span class="p">)],</span> <span class="n">Cox_final_binned</span> <span class="p">[(</span><span class="s1">&#39;log-hazards&#39;</span><span class="p">,</span> <span class="s1">&#39;75%&#39;</span><span class="p">)],</span> <span class="n">facecolor</span><span class="o">=</span> <span class="s2">&quot;pink&quot;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=-</span><span class="mf">0.3</span><span class="p">,</span>  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Cox_final_binned</span> <span class="p">[(</span> <span class="s1">&#39;age_binned&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)],</span> <span class="n">Cox_final_binned</span> <span class="p">[(</span><span class="s2">&quot;BMXWT&quot;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">)]</span> <span class="o">/</span><span class="mi">80</span> <span class="o">-</span> <span class="mf">1.35</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;purple&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Real body mass&#39;</span> <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Cox_frail_binned</span> <span class="p">[</span><span class="s1">&#39;age_binned2&#39;</span><span class="p">],</span> <span class="n">Cox_frail_binned</span> <span class="p">[</span><span class="s1">&#39;log-hazards&#39;</span><span class="p">],</span> <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Most frail log-HR &quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;log-HR / scaled body mass&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Age, years&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Hazard and Body mass are influenced by age&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="c-distribution-of-dosi-in-cohorts-by-frialty">
<h2>1C: Distribution of DOSI in cohorts by frialty<a class="headerlink" href="#c-distribution-of-dosi-in-cohorts-by-frialty" title="Permalink to this headline">#</a></h2>
<section id="normalization-of-dosi-by-age-sex-group">
<h3>Normalization of DOSI by age- sex- group<a class="headerlink" href="#normalization-of-dosi-by-age-sex-group" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Cox_all_data_fr</span><span class="p">[</span><span class="s1">&#39;DOSI_mean_age_gen&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Cox_all_data_fr</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;RIAGENDR&#39;</span><span class="p">,</span> <span class="s1">&#39;age_binned&#39;</span><span class="p">])[</span><span class="s1">&#39;log-hazards&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_plot</span> <span class="o">=</span> <span class="n">Cox_all_data_fr</span><span class="p">[[</span><span class="s1">&#39;DOSI_mean_age_gen&#39;</span><span class="p">,</span><span class="s1">&#39;log-hazards&#39;</span><span class="p">,</span><span class="s1">&#39;n_diagnoses&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_plot</span><span class="p">[</span><span class="s1">&#39;DOSI - DOSI_mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_plot</span><span class="p">[</span><span class="s1">&#39;log-hazards&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data_plot</span><span class="p">[</span><span class="s1">&#39;DOSI_mean_age_gen&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-116-696c9d3d32f1&gt;:1: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_plot[&#39;DOSI - DOSI_mean&#39;] = data_plot[&#39;log-hazards&#39;] - data_plot[&#39;DOSI_mean_age_gen&#39;]
</pre></div>
</div>
</div>
</div>
<p>####Distribution plot</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_plot</span><span class="p">[</span><span class="s1">&#39;n_diagnoses&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_plot</span><span class="p">[</span><span class="s1">&#39;n_diagnoses&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;N diagnoses = 0-1&#39;</span><span class="p">)</span>
<span class="n">data_plot</span><span class="p">[</span><span class="s1">&#39;n_diagnoses&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_plot</span><span class="p">[</span><span class="s1">&#39;n_diagnoses&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span><span class="s1">&#39;N diagnoses = 2-5&#39;</span><span class="p">)</span>
<span class="n">data_plot</span><span class="p">[</span><span class="s1">&#39;n_diagnoses&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_plot</span><span class="p">[</span><span class="s1">&#39;n_diagnoses&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span><span class="s1">&#39;N diagnoses &gt; 5&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-117-9eee1283799c&gt;:1: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_plot[&#39;n_diagnoses&#39;] = data_plot[&#39;n_diagnoses&#39;].replace([0,1],&#39;N diagnoses = 0-1&#39;)
&lt;ipython-input-117-9eee1283799c&gt;:2: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_plot[&#39;n_diagnoses&#39;] = data_plot[&#39;n_diagnoses&#39;].replace([2,3,4,5],&#39;N diagnoses = 2-5&#39;)
&lt;ipython-input-117-9eee1283799c&gt;:3: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data_plot[&#39;n_diagnoses&#39;] = data_plot[&#39;n_diagnoses&#39;].replace([6,7,8,9],&#39;N diagnoses &gt; 5&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_plot</span> <span class="o">=</span> <span class="n">data_plot</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;n_diagnoses&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_plot</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_plot</span><span class="p">[</span><span class="s1">&#39;n_diagnoses&#39;</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data_plot</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;DOSI - DOSI_mean&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;N&quot;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">common_norm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">palette</span> <span class="o">=</span> <span class="s1">&#39;plasma_r&#39;</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">legend</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/code_110_0.png" src="../../../_images/code_110_0.png" />
</div>
</div>
</section>
</section>
<section id="a-excess-dosi-depends-on-frail-fraction">
<h2>2A: Excess DOSI depends on frail fraction<a class="headerlink" href="#a-excess-dosi-depends-on-frail-fraction" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_10</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;for_plot_all_frail_10.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">all_10</span> <span class="o">=</span> <span class="n">all_10</span><span class="p">[</span><span class="n">all_10</span><span class="p">[</span><span class="s1">&#39;age_binned&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">28</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.cm</span> <span class="k">as</span> <span class="nn">cm</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span> <span class="p">(</span><span class="n">all_10</span><span class="p">[</span><span class="s1">&#39;frail_fraction&#39;</span><span class="p">],</span> <span class="n">all_10</span><span class="p">[</span><span class="s1">&#39;excess_DOSI&#39;</span><span class="p">],</span> <span class="mi">1</span> <span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span> <span class="p">(</span><span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyError</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="nn">/usr/local/lib/python3.9/dist-packages/pandas/core/indexes/base.py</span> in <span class="ni">get_loc</span><span class="nt">(self, key, method, tolerance)</span>
<span class="g g-Whitespace">   </span><span class="mi">3628</span>             <span class="k">try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">3629</span>                 <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">casted_key</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3630</span>             <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>

<span class="nn">/usr/local/lib/python3.9/dist-packages/pandas/_libs/index.pyx</span> in <span class="ni">pandas._libs.index.IndexEngine.get_loc</span><span class="nt">()</span>

<span class="nn">/usr/local/lib/python3.9/dist-packages/pandas/_libs/index.pyx</span> in <span class="ni">pandas._libs.index.IndexEngine.get_loc</span><span class="nt">()</span>

<span class="nn">pandas/_libs/hashtable_class_helper.pxi</span> in <span class="ni">pandas._libs.hashtable.PyObjectHashTable.get_item</span><span class="nt">()</span>

<span class="nn">pandas/_libs/hashtable_class_helper.pxi</span> in <span class="ni">pandas._libs.hashtable.PyObjectHashTable.get_item</span><span class="nt">()</span>

<span class="ne">KeyError</span>: &#39;frail_fraction&#39;

<span class="n">The</span> <span class="n">above</span> <span class="n">exception</span> <span class="n">was</span> <span class="n">the</span> <span class="n">direct</span> <span class="n">cause</span> <span class="n">of</span> <span class="n">the</span> <span class="n">following</span> <span class="n">exception</span><span class="p">:</span>

<span class="ne">KeyError</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">35</span><span class="o">-</span><span class="n">d578dac756b0</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span> <span class="p">(</span><span class="n">all_10</span><span class="p">[</span><span class="s1">&#39;frail_fraction&#39;</span><span class="p">],</span> <span class="n">all_10</span><span class="p">[</span><span class="s1">&#39;excess_DOSI&#39;</span><span class="p">],</span> <span class="mi">1</span> <span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span> <span class="p">(</span><span class="n">z</span><span class="p">)</span>

<span class="nn">/usr/local/lib/python3.9/dist-packages/pandas/core/frame.py</span> in <span class="ni">__getitem__</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">   </span><span class="mi">3503</span>             <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">nlevels</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">3504</span>                 <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getitem_multilevel</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">3505</span>             <span class="n">indexer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3506</span>             <span class="k">if</span> <span class="n">is_integer</span><span class="p">(</span><span class="n">indexer</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">3507</span>                 <span class="n">indexer</span> <span class="o">=</span> <span class="p">[</span><span class="n">indexer</span><span class="p">]</span>

<span class="nn">/usr/local/lib/python3.9/dist-packages/pandas/core/indexes/base.py</span> in <span class="ni">get_loc</span><span class="nt">(self, key, method, tolerance)</span>
<span class="g g-Whitespace">   </span><span class="mi">3629</span>                 <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">casted_key</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3630</span>             <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">3631</span>                 <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">err</span>
<span class="g g-Whitespace">   </span><span class="mi">3632</span>             <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">3633</span>                 <span class="c1"># If we have a listlike key, _check_indexing_error will raise</span>

<span class="ne">KeyError</span>: &#39;frail_fraction&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig10a</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax10a</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">all_10</span><span class="p">[</span><span class="n">all_10</span><span class="p">[</span><span class="s1">&#39;frail_fraction&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span>
<span class="n">p10a</span> <span class="o">=</span> <span class="n">ax10a</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x1</span><span class="p">[</span><span class="s1">&#39;frail_fraction&#39;</span><span class="p">],</span> <span class="n">x1</span><span class="p">[</span><span class="s1">&#39;excess_DOSI&#39;</span><span class="p">],</span> <span class="n">c</span> <span class="o">=</span> <span class="n">x1</span><span class="p">[</span><span class="s1">&#39;age_binned&#39;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">plasma_r</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">[</span><span class="s1">&#39;frail_fraction&#39;</span><span class="p">],</span> <span class="n">p</span><span class="p">(</span><span class="n">x1</span><span class="p">[</span><span class="s1">&#39;frail_fraction&#39;</span><span class="p">]),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Excess DOSI&#39;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fraction of frail population&#39;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;All frail&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">fig10a</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">p10a</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax10a</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/code_115_0.png" src="../../../_images/code_115_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span><span class="o">.</span><span class="n">pearsonr</span><span class="p">(</span><span class="n">x1</span><span class="p">[</span><span class="s1">&#39;excess_DOSI&#39;</span><span class="p">],</span> <span class="n">p</span><span class="p">(</span><span class="n">x1</span><span class="p">[</span><span class="s1">&#39;frail_fraction&#39;</span><span class="p">]))</span> <span class="c1">#DOSI vs trendline</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PearsonRResult(statistic=0.9471339911982491, pvalue=8.094641292699463e-10)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span><span class="o">.</span><span class="n">pearsonr</span><span class="p">(</span><span class="n">x1</span><span class="p">[</span><span class="s1">&#39;excess_DOSI&#39;</span><span class="p">],</span> <span class="n">x1</span><span class="p">[</span><span class="s1">&#39;frail_fraction&#39;</span><span class="p">])</span> <span class="c1">#DOSI vs frail fraction</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PearsonRResult(statistic=0.9471339911982491, pvalue=8.094641292699463e-10)
</pre></div>
</div>
</div>
</div>
</section>
<section id="b-frail-fraction-depends-on-age">
<h2>2B: Frail fraction depends on age<a class="headerlink" href="#b-frail-fraction-depends-on-age" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_2b</span> <span class="o">=</span> <span class="n">all_10</span><span class="p">[</span><span class="n">all_10</span><span class="p">[</span><span class="s1">&#39;age_binned&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">40</span><span class="p">]</span>
<span class="n">all_2b</span> <span class="o">=</span> <span class="n">all_2b</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;age_binned&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span> <span class="p">(</span><span class="n">all_2b</span><span class="p">[</span><span class="s1">&#39;age_binned&#39;</span><span class="p">],</span> <span class="n">all_2b</span><span class="p">[</span><span class="s1">&#39;frail_fraction&#39;</span><span class="p">],</span> <span class="mi">1</span> <span class="p">)</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span> <span class="p">(</span><span class="n">z1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">all_2b</span><span class="p">[</span><span class="s1">&#39;age_binned&#39;</span><span class="p">],</span> <span class="n">all_2b</span><span class="p">[</span><span class="s1">&#39;frail_fraction&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">all_2b</span><span class="p">[</span><span class="s1">&#39;age_binned&#39;</span><span class="p">],</span> <span class="n">p1</span><span class="p">(</span><span class="n">all_2b</span><span class="p">[</span><span class="s1">&#39;age_binned&#39;</span><span class="p">]),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;All frail&#39;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Age, years&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Fraction of frail population&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/code_121_0.png" src="../../../_images/code_121_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span><span class="o">.</span><span class="n">pearsonr</span><span class="p">(</span><span class="n">all_2b</span><span class="p">[</span><span class="s1">&#39;frail_fraction&#39;</span><span class="p">],</span> <span class="n">p1</span><span class="p">(</span><span class="n">all_2b</span><span class="p">[</span><span class="s1">&#39;age_binned&#39;</span><span class="p">]))</span> <span class="c1">#Frail fraction vs trendline</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PearsonRResult(statistic=0.9878323142666585, pvalue=6.83198091215499e-12)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span><span class="o">.</span><span class="n">pearsonr</span><span class="p">(</span><span class="n">all_2b</span><span class="p">[</span><span class="s1">&#39;frail_fraction&#39;</span><span class="p">],</span> <span class="n">all_2b</span><span class="p">[</span><span class="s1">&#39;age_binned&#39;</span><span class="p">])</span> <span class="c1">#Frail fraction vs Age</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PearsonRResult(statistic=0.9878323142666585, pvalue=6.83198091215499e-12)
</pre></div>
</div>
</div>
</div>
</section>
<section id="dosi-level-depends-on-smoking-habits">
<h2>2С: DOSI level depends on smoking habits<a class="headerlink" href="#dosi-level-depends-on-smoking-habits" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">smoke</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;smoke.csv&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">smoke_non</span> <span class="o">=</span> <span class="n">smoke</span><span class="p">[</span><span class="n">smoke</span><span class="p">[</span><span class="s2">&quot;Frail&quot;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;NonF&#39;</span><span class="p">]</span>
<span class="n">smoke_frail</span> <span class="o">=</span> <span class="n">smoke</span><span class="p">[</span><span class="n">smoke</span><span class="p">[</span><span class="s2">&quot;Frail&quot;</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;NonF&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">value1</span> <span class="o">=</span> <span class="n">smoke_non</span><span class="p">[</span><span class="n">smoke_non</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Never&#39;</span><span class="p">][</span><span class="s2">&quot;log-hazards&quot;</span><span class="p">]</span>
<span class="n">value2</span> <span class="o">=</span> <span class="n">smoke_non</span><span class="p">[</span><span class="n">smoke_non</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Previous&#39;</span><span class="p">][</span><span class="s2">&quot;log-hazards&quot;</span><span class="p">]</span>
<span class="n">value3</span> <span class="o">=</span> <span class="n">smoke_non</span><span class="p">[</span><span class="n">smoke_non</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Current&#39;</span><span class="p">][</span><span class="s2">&quot;log-hazards&quot;</span><span class="p">]</span>

<span class="n">box_plot_data</span><span class="o">=</span><span class="p">[</span><span class="n">value1</span><span class="p">,</span><span class="n">value2</span><span class="p">,</span><span class="n">value3</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Non-frail&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">box_plot_data</span><span class="p">,</span><span class="n">patch_artist</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Never&#39;</span><span class="p">,</span><span class="s1">&#39;Previous&#39;</span><span class="p">,</span><span class="s1">&#39;Current&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Smoking status&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;DOSI level&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/code_127_0.png" src="../../../_images/code_127_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">value1</span> <span class="o">=</span> <span class="n">smoke_frail</span><span class="p">[</span><span class="n">smoke_frail</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Never&#39;</span><span class="p">][</span><span class="s2">&quot;log-hazards&quot;</span><span class="p">]</span>
<span class="n">value2</span> <span class="o">=</span> <span class="n">smoke_frail</span><span class="p">[</span><span class="n">smoke_frail</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Previous&#39;</span><span class="p">][</span><span class="s2">&quot;log-hazards&quot;</span><span class="p">]</span>
<span class="n">value3</span> <span class="o">=</span> <span class="n">smoke_frail</span><span class="p">[</span><span class="n">smoke_frail</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Current&#39;</span><span class="p">][</span><span class="s2">&quot;log-hazards&quot;</span><span class="p">]</span>

<span class="n">box_plot_data</span><span class="o">=</span><span class="p">[</span><span class="n">value1</span><span class="p">,</span><span class="n">value2</span><span class="p">,</span><span class="n">value3</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Frail&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">box_plot_data</span><span class="p">,</span><span class="n">patch_artist</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Never&#39;</span><span class="p">,</span><span class="s1">&#39;Previous&#39;</span><span class="p">,</span><span class="s1">&#39;Current&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Smoking status&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;DOSI level&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/code_128_0.png" src="../../../_images/code_128_0.png" />
</div>
</div>
</section>
<section id="d-distribution-of-the-inverse-variance-of-dosi-and-activity">
<h2>3D: Distribution of the inverse variance of DOSI and activity<a class="headerlink" href="#d-distribution-of-the-inverse-variance-of-dosi-and-activity" title="Permalink to this headline">#</a></h2>
<section id="add-steps-data">
<h3>Add steps data<a class="headerlink" href="#add-steps-data" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_steps</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sas</span><span class="p">(</span><span class="s2">&quot;.../paxraw_d.xpt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Missing values were coded with number 62</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_steps</span> <span class="o">=</span> <span class="n">data_steps</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">62</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_steps</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-607166a5-7c6a-4c96-a517-7ade7bc41680">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SEQN</th>
      <th>PAXSTAT</th>
      <th>PAXCAL</th>
      <th>PAXDAY</th>
      <th>PAXN</th>
      <th>PAXHOUR</th>
      <th>PAXMINUT</th>
      <th>PAXINTEN</th>
      <th>PAXSTEP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>31128.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>5.397605e-79</td>
      <td>5.397605e-79</td>
      <td>1.660000e+02</td>
      <td>4.000000e+00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>31128.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>5.397605e-79</td>
      <td>1.000000e+00</td>
      <td>2.700000e+01</td>
      <td>5.397605e-79</td>
    </tr>
    <tr>
      <th>2</th>
      <td>31128.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>5.397605e-79</td>
      <td>2.000000e+00</td>
      <td>5.397605e-79</td>
      <td>5.397605e-79</td>
    </tr>
    <tr>
      <th>3</th>
      <td>31128.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>5.397605e-79</td>
      <td>3.000000e+00</td>
      <td>2.760000e+02</td>
      <td>4.000000e+00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>31128.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>5.397605e-79</td>
      <td>4.000000e+00</td>
      <td>5.397605e-79</td>
      <td>5.397605e-79</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5373897</th>
      <td>31854.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>6934.0</td>
      <td>1.900000e+01</td>
      <td>3.300000e+01</td>
      <td>4.910000e+02</td>
      <td>4.000000e+00</td>
    </tr>
    <tr>
      <th>5373898</th>
      <td>31854.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>6935.0</td>
      <td>1.900000e+01</td>
      <td>3.400000e+01</td>
      <td>4.780000e+02</td>
      <td>5.000000e+00</td>
    </tr>
    <tr>
      <th>5373899</th>
      <td>31854.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>6936.0</td>
      <td>1.900000e+01</td>
      <td>3.500000e+01</td>
      <td>4.160000e+02</td>
      <td>5.000000e+00</td>
    </tr>
    <tr>
      <th>5373900</th>
      <td>31854.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>6937.0</td>
      <td>1.900000e+01</td>
      <td>3.600000e+01</td>
      <td>3.190000e+02</td>
      <td>4.000000e+00</td>
    </tr>
    <tr>
      <th>5373901</th>
      <td>31854.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>6938.0</td>
      <td>1.900000e+01</td>
      <td>3.700000e+01</td>
      <td>5.120000e+02</td>
      <td>1.000000e+01</td>
    </tr>
  </tbody>
</table>
<p>5373902 rows × 9 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-607166a5-7c6a-4c96-a517-7ade7bc41680')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-607166a5-7c6a-4c96-a517-7ade7bc41680 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-607166a5-7c6a-4c96-a517-7ade7bc41680');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_steps</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_steps</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;SEQN&#39;</span><span class="p">])[</span><span class="s1">&#39;PAXSTEP&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">data_steps</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-3a4d5924-8d01-4ace-a3fc-4029638d0129">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PAXSTEP</th>
    </tr>
    <tr>
      <th>SEQN</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>31128.0</th>
      <td>84304.0</td>
    </tr>
    <tr>
      <th>31129.0</th>
      <td>44998.0</td>
    </tr>
    <tr>
      <th>31131.0</th>
      <td>67947.0</td>
    </tr>
    <tr>
      <th>31132.0</th>
      <td>85181.0</td>
    </tr>
    <tr>
      <th>31133.0</th>
      <td>36550.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>31847.0</th>
      <td>26114.0</td>
    </tr>
    <tr>
      <th>31848.0</th>
      <td>8298.0</td>
    </tr>
    <tr>
      <th>31849.0</th>
      <td>71079.0</td>
    </tr>
    <tr>
      <th>31850.0</th>
      <td>72908.0</td>
    </tr>
    <tr>
      <th>31854.0</th>
      <td>71762.0</td>
    </tr>
  </tbody>
</table>
<p>535 rows × 1 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-3a4d5924-8d01-4ace-a3fc-4029638d0129')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-3a4d5924-8d01-4ace-a3fc-4029638d0129 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-3a4d5924-8d01-4ace-a3fc-4029638d0129');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_steps</span><span class="p">[</span><span class="s1">&#39;SEQN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_steps</span><span class="o">.</span><span class="n">index</span>
<span class="n">data_steps</span> <span class="o">=</span> <span class="n">data_steps</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_steps</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-59486987-f1a7-44c9-8e65-6c3aeeb5e40e">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PAXSTEP</th>
      <th>SEQN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>84304.0</td>
      <td>31128.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>44998.0</td>
      <td>31129.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>67947.0</td>
      <td>31131.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>85181.0</td>
      <td>31132.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>36550.0</td>
      <td>31133.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>530</th>
      <td>26114.0</td>
      <td>31847.0</td>
    </tr>
    <tr>
      <th>531</th>
      <td>8298.0</td>
      <td>31848.0</td>
    </tr>
    <tr>
      <th>532</th>
      <td>71079.0</td>
      <td>31849.0</td>
    </tr>
    <tr>
      <th>533</th>
      <td>72908.0</td>
      <td>31850.0</td>
    </tr>
    <tr>
      <th>534</th>
      <td>71762.0</td>
      <td>31854.0</td>
    </tr>
  </tbody>
</table>
<p>535 rows × 2 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-59486987-f1a7-44c9-8e65-6c3aeeb5e40e')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-59486987-f1a7-44c9-8e65-6c3aeeb5e40e button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-59486987-f1a7-44c9-8e65-6c3aeeb5e40e');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ids</span> <span class="o">=</span> <span class="n">Cox_all_data_fr</span><span class="p">[</span><span class="s2">&quot;SEQN&quot;</span><span class="p">]</span>
<span class="n">ids_frial</span> <span class="o">=</span> <span class="n">data_steps</span><span class="p">[</span><span class="s2">&quot;SEQN&quot;</span><span class="p">]</span>
<span class="n">data_steps_2</span> <span class="o">=</span> <span class="n">data_steps</span><span class="p">[</span><span class="n">ids_frial</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">ids</span><span class="p">)]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;SEQN&quot;</span><span class="p">])</span>
<span class="n">data_steps_2</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(495, 2)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_steps_2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-43828859-b7c5-4072-a6a8-c6e3cc56751d">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PAXSTEP</th>
      <th>SEQN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>84304.0</td>
      <td>31128.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>44998.0</td>
      <td>31129.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>67947.0</td>
      <td>31131.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>85181.0</td>
      <td>31132.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>36550.0</td>
      <td>31133.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>530</th>
      <td>26114.0</td>
      <td>31847.0</td>
    </tr>
    <tr>
      <th>531</th>
      <td>8298.0</td>
      <td>31848.0</td>
    </tr>
    <tr>
      <th>532</th>
      <td>71079.0</td>
      <td>31849.0</td>
    </tr>
    <tr>
      <th>533</th>
      <td>72908.0</td>
      <td>31850.0</td>
    </tr>
    <tr>
      <th>534</th>
      <td>71762.0</td>
      <td>31854.0</td>
    </tr>
  </tbody>
</table>
<p>495 rows × 2 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-43828859-b7c5-4072-a6a8-c6e3cc56751d')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-43828859-b7c5-4072-a6a8-c6e3cc56751d button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-43828859-b7c5-4072-a6a8-c6e3cc56751d');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
</div></div>
</div>
</section>
<section id="add-age-column-number-of-diagnosis">
<h3>Add age column, number of diagnosis<a class="headerlink" href="#add-age-column-number-of-diagnosis" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_steps_2</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">Cox_all_data_fr</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">Cox_all_data_fr</span><span class="p">[</span><span class="s1">&#39;SEQN&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">,</span><span class="s1">&#39;age_binned&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data_steps_2</span><span class="p">[</span><span class="s1">&#39;SEQN&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_steps_2</span><span class="p">[</span><span class="s1">&#39;n_diagnoses&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">Cox_all_data_fr</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">Cox_all_data_fr</span><span class="p">[</span><span class="s1">&#39;SEQN&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">,</span><span class="s1">&#39;n_diagnoses&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data_steps_2</span><span class="p">[</span><span class="s1">&#39;SEQN&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="log-transformation-removement-of-most-frial">
<h3>Log-transformation, removement of most frial<a class="headerlink" href="#log-transformation-removement-of-most-frial" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_steps_2</span><span class="p">[</span><span class="s1">&#39;ln&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">data_steps_2</span><span class="p">[</span><span class="s1">&#39;PAXSTEP&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_steps_2</span> <span class="o">=</span> <span class="n">data_steps_2</span><span class="p">[</span><span class="n">data_steps_2</span><span class="p">[</span><span class="s1">&#39;n_diagnoses&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plotting-steps">
<h3>Plotting steps<a class="headerlink" href="#plotting-steps" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_plot</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_steps_2</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;age&#39;</span><span class="p">])[</span><span class="s1">&#39;ln&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">var</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_plot</span><span class="p">[</span><span class="s1">&#39;1/var&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">data_plot</span><span class="p">[</span><span class="s1">&#39;ln&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">data_plot</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">data_plot</span><span class="p">[</span><span class="s2">&quot;1/var&quot;</span><span class="p">],</span> <span class="n">line_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span><span class="s2">&quot;r&quot;</span><span class="p">,</span><span class="s2">&quot;alpha&quot;</span><span class="p">:</span><span class="mf">0.7</span><span class="p">,</span><span class="s2">&quot;lw&quot;</span><span class="p">:</span><span class="mi">5</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/code_149_0.png" src="../../../_images/code_149_0.png" />
</div>
</div>
<p>Unfortunarly, the result differs from the result at paper.</p>
</section>
<section id="plotting-dosi">
<h3>Plotting DOSI<a class="headerlink" href="#plotting-dosi" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Cox_all_data_fr_2</span> <span class="o">=</span> <span class="n">Cox_all_data_fr</span><span class="p">[</span><span class="n">Cox_all_data_fr</span><span class="p">[</span><span class="s1">&#39;n_diagnoses&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">]</span>
<span class="n">Cox_all_data_fr_2</span> <span class="o">=</span> <span class="n">Cox_all_data_fr_2</span><span class="p">[</span><span class="n">Cox_all_data_fr_2</span><span class="p">[</span><span class="s1">&#39;age_binned&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">40</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_plot_dosi</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">Cox_all_data_fr_2</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;age_binned&#39;</span><span class="p">])[</span><span class="s1">&#39;log-hazards&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">var</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_plot_dosi</span><span class="p">[</span><span class="s1">&#39;1/var&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">data_plot_dosi</span><span class="p">[</span><span class="s1">&#39;log-hazards&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">data_plot_dosi</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">data_plot_dosi</span><span class="p">[</span><span class="s2">&quot;1/var&quot;</span><span class="p">],</span> <span class="n">line_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span><span class="s2">&quot;r&quot;</span><span class="p">,</span><span class="s2">&quot;alpha&quot;</span><span class="p">:</span><span class="mf">0.7</span><span class="p">,</span><span class="s2">&quot;lw&quot;</span><span class="p">:</span><span class="mi">5</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/code_155_0.png" src="../../../_images/code_155_0.png" />
</div>
</div>
</section>
<section id="lifespan-prediction">
<h3>Lifespan prediction<a class="headerlink" href="#lifespan-prediction" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data_plot_dosi</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">data_plot_dosi</span><span class="p">[</span><span class="s1">&#39;1/var&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Point of Age axis intersection:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">float</span><span class="p">(</span><span class="o">-</span><span class="n">model</span><span class="o">.</span><span class="n">intercept_</span><span class="o">/</span><span class="n">model</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>145.39184263980115
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./projects/2023/dosi"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Kriukov Dmitrii<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>