
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>13. System resilience &#8212; Computational aging book</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="shortcut icon" href="../_static/symbol.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Dynamic Organism State Indicator" href="../projects/2023/dosi/report.html" />
    <link rel="prev" title="12. Complex systems approach" href="complex_systems.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/symbol.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Computational aging book</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to the Computational Biology of Aging coursebook
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Biology of Aging
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../bio/intro_aging_biology.html">
   1. Introduction to Aging Biology
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Statistical view
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../stat/differential_analysis_practice.html">
   2. Differential expression analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../meth/meth.html">
   3. Omics Data Analysis in Aging: Methylomics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://colab.research.google.com/drive/1mCak-0KTZkISR7ptyBvIOBj1MpewOwDx?usp=sharing">
   Practice - WGCNA for Methylomics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../stat/survival_analysis.html">
   4. Survival analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../stat/survival_analysis_part2.html">
   5. Survival analysis. Advanced methods.
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Machine learning view
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../ml/aging_clocks.html">
   11. Aging Clocks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://colab.research.google.com/drive/1h1D35mKJ1-7YlBRW7tLAIO2mviHIAMuj?usp=sharing">
   Practice - DIY Aging Clocks
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Dynamic system view
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="complex_systems.html">
   12. Complex systems approach
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   13. System resilience
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Student projects
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../projects/2023/dosi/report.html">
   Dynamic Organism State Indicator
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../projects/2023/meta/report.html">
   Meta-analysis of aging transcriptomes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../projects/2023/parkinson/report.html">
   Computational Model of Parkinson’s Disease
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../projects/2023/unsupervized/report.html">
   Unsupervised aging
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/ComputationalAgingLab/computational_aging_course/master?urlpath=tree/dyn/system_resilience.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/ComputationalAgingLab/computational_aging_course"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/ComputationalAgingLab/computational_aging_course/issues/new?title=Issue%20on%20page%20%2Fdyn/system_resilience.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/dyn/system_resilience.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#recap-differential-equations">
   13.1. Recap differential equations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#linear-ordinary-differential-equations">
     13.1.1. Linear ordinary differential equations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#non-linear-ordinary-differential-equations">
     13.1.2. Non-linear ordinary differential equations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#numerical-integration">
     13.1.3. Numerical integration
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#stability-theory-and-bifurcations">
   13.2. Stability theory and bifurcations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stability-intuition">
     13.2.1. Stability intuition
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#potential-function">
     13.2.2. Potential function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#catastrophic-bifurcation">
     13.2.3. Catastrophic bifurcation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#system-of-differential-equations">
   13.3. System of differential equations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stability-in-linear-multidimensional-case">
     13.3.1. Stability in linear multidimensional case
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stability-in-non-linear-multidimensional-case">
     13.3.2. Stability in non-linear multidimensional case
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#universality-and-resilience">
     13.3.3. Universality and resilience
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-remark-on-complex-system-aging">
     13.3.4. The remark on complex system aging
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#critical-slowing-down">
   13.4. Critical slowing down
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#introduce-a-stochastic-model">
     13.4.1. Introduce a stochastic model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slowing-down-intuition">
     13.4.2. Slowing down intuition
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#construct-a-resilience-indicator-from-data">
     13.4.3. Construct a resilience indicator from data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conclusion">
   13.5. Conclusion
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#learn-more">
   13.6. Learn More
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#credits">
   13.7. Credits
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>System resilience</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#recap-differential-equations">
   13.1. Recap differential equations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#linear-ordinary-differential-equations">
     13.1.1. Linear ordinary differential equations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#non-linear-ordinary-differential-equations">
     13.1.2. Non-linear ordinary differential equations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#numerical-integration">
     13.1.3. Numerical integration
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#stability-theory-and-bifurcations">
   13.2. Stability theory and bifurcations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stability-intuition">
     13.2.1. Stability intuition
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#potential-function">
     13.2.2. Potential function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#catastrophic-bifurcation">
     13.2.3. Catastrophic bifurcation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#system-of-differential-equations">
   13.3. System of differential equations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stability-in-linear-multidimensional-case">
     13.3.1. Stability in linear multidimensional case
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stability-in-non-linear-multidimensional-case">
     13.3.2. Stability in non-linear multidimensional case
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#universality-and-resilience">
     13.3.3. Universality and resilience
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-remark-on-complex-system-aging">
     13.3.4. The remark on complex system aging
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#critical-slowing-down">
   13.4. Critical slowing down
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#introduce-a-stochastic-model">
     13.4.1. Introduce a stochastic model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slowing-down-intuition">
     13.4.2. Slowing down intuition
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#construct-a-resilience-indicator-from-data">
     13.4.3. Construct a resilience indicator from data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conclusion">
   13.5. Conclusion
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#learn-more">
   13.6. Learn More
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#credits">
   13.7. Credits
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="system-resilience">
<h1><a class="toc-backref" href="#id11"><span class="section-number">13. </span>System resilience</a><a class="headerlink" href="#system-resilience" title="Permalink to this headline">#</a></h1>
<p><em>What distinguishes biological systems from physical ones? - Biological systems perform computations.</em></p>
<p>In this chapter, you will learn:</p>
<ul class="simple">
<li><p>A step-by-step brief introduction to the theory of dynamical systems from one-dimensional to multidimensional;</p></li>
<li><p>Concepts of network, bifurcation, criticality, resilience, and stability will find a mathematical embodiment;</p></li>
<li><p>Build a simple dummy dynamical model of biological age;</p></li>
<li><p>Build a resilience indicator from real data;</p></li>
<li><p>Develop a complex system intuition and understand how they can be described with universal laws.</p></li>
</ul>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#system-resilience" id="id11">System resilience</a></p>
<ul>
<li><p><a class="reference internal" href="#recap-differential-equations" id="id12">Recap differential equations</a></p>
<ul>
<li><p><a class="reference internal" href="#linear-ordinary-differential-equations" id="id13">Linear ordinary differential equations</a></p></li>
<li><p><a class="reference internal" href="#non-linear-ordinary-differential-equations" id="id14">Non-linear ordinary differential equations</a></p></li>
<li><p><a class="reference internal" href="#numerical-integration" id="id15">Numerical integration</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#stability-theory-and-bifurcations" id="id16">Stability theory and bifurcations</a></p>
<ul>
<li><p><a class="reference internal" href="#stability-intuition" id="id17">Stability intuition</a></p></li>
<li><p><a class="reference internal" href="#potential-function" id="id18">Potential function</a></p></li>
<li><p><a class="reference internal" href="#catastrophic-bifurcation" id="id19">Catastrophic bifurcation</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#system-of-differential-equations" id="id20">System of differential equations</a></p>
<ul>
<li><p><a class="reference internal" href="#stability-in-linear-multidimensional-case" id="id21">Stability in linear multidimensional case</a></p></li>
<li><p><a class="reference internal" href="#stability-in-non-linear-multidimensional-case" id="id22">Stability in non-linear multidimensional case</a></p></li>
<li><p><a class="reference internal" href="#universality-and-resilience" id="id23">Universality and resilience</a></p></li>
<li><p><a class="reference internal" href="#the-remark-on-complex-system-aging" id="id24">The remark on complex system aging</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#critical-slowing-down" id="id25">Critical slowing down</a></p>
<ul>
<li><p><a class="reference internal" href="#introduce-a-stochastic-model" id="id26">Introduce a stochastic model</a></p></li>
<li><p><a class="reference internal" href="#slowing-down-intuition" id="id27">Slowing down intuition</a></p></li>
<li><p><a class="reference internal" href="#construct-a-resilience-indicator-from-data" id="id28">Construct a resilience indicator from data</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#conclusion" id="id29">Conclusion</a></p></li>
<li><p><a class="reference internal" href="#learn-more" id="id30">Learn More</a></p></li>
<li><p><a class="reference internal" href="#credits" id="id31">Credits</a></p></li>
</ul>
</li>
</ul>
</div>
<section id="recap-differential-equations">
<h2><a class="toc-backref" href="#id12"><span class="section-number">13.1. </span>Recap differential equations</a><a class="headerlink" href="#recap-differential-equations" title="Permalink to this headline">#</a></h2>
<p>The differential equation is a very useful instrument for understanding and modeling real biological processes. Once you develop a basic intuition of the differential equation you will see the world as a set of dynamic systems. What is a dynamic system? Well, everything! Everything that we may observe evolving in time could be (and possibly must be) described with this instrument.</p>
<p>In general, a differential equation is written as</p>
<div class="math notranslate nohighlight" id="equation-diff-eq">
<span class="eqno">(13.1)<a class="headerlink" href="#equation-diff-eq" title="Permalink to this equation">#</a></span>\[
  \dot{x} = f(x, t)
\]</div>
<p>where f(x, t) - given function of time <span class="math notranslate nohighlight">\(t\)</span> and state variable <span class="math notranslate nohighlight">\(x\)</span> itself. Note, that <span class="math notranslate nohighlight">\(x=x(t)\)</span> is also a function of time, hence, <span class="math notranslate nohighlight">\(\dot{x} = dx(t)/dt = dx/dt\)</span> - we omit <span class="math notranslate nohighlight">\((t)\)</span> for simplicity. A huge body of knowledge of differential equations theory has been elaborated for ages. In this tutorial, we only touch on the most important topics needed for understanding complex systems resilience introduced in the previous chapter.</p>
<section id="linear-ordinary-differential-equations">
<h3><a class="toc-backref" href="#id13"><span class="section-number">13.1.1. </span>Linear ordinary differential equations</a><a class="headerlink" href="#linear-ordinary-differential-equations" title="Permalink to this headline">#</a></h3>
<p>First, let’s start with the simplest cases of so-called growth/death models. Let:</p>
<div class="math notranslate nohighlight">
\[ 
    \dot{x} = a 
\]</div>
<p>where <span class="math notranslate nohighlight">\(a\)</span> is a constant;</p>
<div class="math notranslate nohighlight">
\[ 
    \frac{dx}{dt} = a 
\]</div>
<div class="math notranslate nohighlight">
\[ 
    dx = a\cdot dt 
\]</div>
<p>integrate both sides,</p>
<div class="math notranslate nohighlight">
\[ 
    \int dx = a \int dt 
\]</div>
<div class="math notranslate nohighlight" id="equation-ex-sol-1">
<span class="eqno">(13.2)<a class="headerlink" href="#equation-ex-sol-1" title="Permalink to this equation">#</a></span>\[
    x(t) = at + C
\]</div>
<p>where constant <span class="math notranslate nohighlight">\(C\)</span> is defined from initial conditions. This is the simplest case of a separable equation (s.t. you can separate variable <span class="math notranslate nohighlight">\(x\)</span> from <span class="math notranslate nohighlight">\(t\)</span> on both sides) that describes <strong>linear growth</strong> of <span class="math notranslate nohighlight">\(x\)</span>. For example, the amount of water accumulated in a water tank fed by a pipe. The next case:</p>
<div class="math notranslate nohighlight">
\[ 
    \dot{x} = ax 
\]</div>
<div class="math notranslate nohighlight">
\[ 
    \int \frac{dx}{x} = a\int dt 
\]</div>
<div class="math notranslate nohighlight">
\[ 
    \ln(x(t)) = at + C
\]</div>
<div class="math notranslate nohighlight" id="equation-ex-sol-2">
<span class="eqno">(13.3)<a class="headerlink" href="#equation-ex-sol-2" title="Permalink to this equation">#</a></span>\[ 
    x(t) = e^Ce^{at} = C_1e^{at}
\]</div>
<p>This equation describes the dynamics of so-called <strong>exponential growth/death</strong> depending on the sign of the coefficient <span class="math notranslate nohighlight">\(a\)</span>. One common example of a system described by this equation is the number of bacteria in a petri dish in the case when resources for growth are unlimited. Indeed, you know that number of bacteria the next day depends on the number of bacteria on the previous day. Thus, the differential equation has the form <span class="math notranslate nohighlight">\(\dot{x} = ax\)</span> and has a solution in a form of exponential growth.</p>
<p>Let’s draw the solutions <a class="reference internal" href="#equation-ex-sol-1">(13.2)</a>, <a class="reference internal" href="#equation-ex-sol-2">(13.3)</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;16&#39;</span> <span class="c1"># increase font size</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">C</span><span class="p">:</span> <span class="n">a</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">C</span>
<span class="n">x2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">C</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Value&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x1</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">C</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\dot</span><span class="si">{x}</span><span class="s1"> = 1$&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">C</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\dot</span><span class="si">{x}</span><span class="s1"> = x$&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">C</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\dot</span><span class="si">{x}</span><span class="s1"> = -x$&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/system_resilience_4_0.png" src="../_images/system_resilience_4_0.png" />
</div>
</div>
<p>Two important observations: (1) the solution of equation <a class="reference internal" href="#equation-ex-sol-1">(13.2)</a> always diverges, i.e there is no non-zero constant <span class="math notranslate nohighlight">\(Const\)</span> such that <span class="math notranslate nohighlight">\(x(\infty) \to Const\)</span>; (2) the solution of equation <a class="reference internal" href="#equation-ex-sol-2">(13.3)</a> has three regimes: one at positive constant <span class="math notranslate nohighlight">\(a\)</span> - divergence (exponential growth), one at negative <span class="math notranslate nohighlight">\(a\)</span> - convergence to zero (exponential decay), and one at <span class="math notranslate nohighlight">\(a=0\)</span> - trivial case with no dynamics. Adjusting constant <span class="math notranslate nohighlight">\(a\)</span> continuously leads to switching between regimes which is something that we call <strong>bifurcation</strong> and will study further. In other words. they say a system undergoes a bifurcation as <span class="math notranslate nohighlight">\(a\)</span> approaches zero (from the left or right side). Of course, in this case, the system changes its behavior <strong>qualitatively</strong>.</p>
</section>
<section id="non-linear-ordinary-differential-equations">
<h3><a class="toc-backref" href="#id14"><span class="section-number">13.1.2. </span>Non-linear ordinary differential equations</a><a class="headerlink" href="#non-linear-ordinary-differential-equations" title="Permalink to this headline">#</a></h3>
<p>Linear differential equations and systems of them provide a lot of possibilities for modeling technical and living systems. However, already in the case of bacteria growth modeling with limited resources, we force the need to use quadratic models. This is where the logistic model appears:</p>
<div class="math notranslate nohighlight">
\[ 
    \dot{x} = rx(1 - \frac{x}{K}) 
\]</div>
<p>here we introduced two additional parameters: <span class="math notranslate nohighlight">\(r\)</span> - growth rate, and <span class="math notranslate nohighlight">\(K\)</span> - carrying capacity. To understand this equation deeper let’s rewrite it in expanded form:</p>
<div class="math notranslate nohighlight">
\[ 
    \dot{x} = rx - \frac{rx^2}{K} =  rx - \delta x^2
\]</div>
<p>The first term is a growth term responsible for the increase of the number of bacteria with the rate <span class="math notranslate nohighlight">\(r\)</span>. The second term is more tricky and suddenly quadratic with a new parameter <span class="math notranslate nohighlight">\(\delta = r/K\)</span> which is interpreted as the death rate. The idea of the second term is that after <span class="math notranslate nohighlight">\(x\)</span> becomes quite a large number the growth must rapidly slow down modeling, thus, a deficit of resources. A good idea to use a quadratic term for that which increases faster than linear and is not so hard to compute. But the right question here is: “why not cubic or exponent or something else?”. It turns out that the quadratic term is a good approximation of the behavior of real-world cases of growth. One additional intuition behind the quadratic term is that it reflects pairwise interactions of <span class="math notranslate nohighlight">\(x\)</span> species, which can we may interpret as a competition for resources (aka crowding pressure).</p>
<p>Let’s solve it:</p>
<div class="math notranslate nohighlight">
\[ 
    \frac{dx}{dt} = rx(1 - \frac{x}{K}) 
\]</div>
<div class="math notranslate nohighlight">
\[ 
    \frac{dx}{x(1 - \frac{x}{K}) } = rdt
\]</div>
<p>split the left part by the sum of fractions with some unknown (yet) coefficients <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span>:</p>
<div class="math notranslate nohighlight">
\[ 
    \frac{Adx}{x} + \frac{Bdx}{(1 - \frac{x}{K}) } = rdt
\]</div>
<p>consider the following equation for the nominator:</p>
<div class="math notranslate nohighlight">
\[ 
    A(1 - \frac{x}{K})dx + Bxdx = dx
\]</div>
<div class="math notranslate nohighlight">
\[ 
    A(1 - \frac{x}{K}) + Bx = 1
\]</div>
<div class="math notranslate nohighlight">
\[ 
    A - A\frac{x}{K} + Bx = 1
\]</div>
<div class="math notranslate nohighlight">
\[ 
    A - x(\frac{A}{K} + B) = 1
\]</div>
<p>from the obtained equation we can compose the following system:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{cases}
    -\frac{A}{K} + B = 0 \rightarrow B = \frac{A}{K}\\
    A = 1\\
\end{cases}
\end{split}\]</div>
<p>Thus, we have</p>
<div class="math notranslate nohighlight">
\[ 
    \frac{dx}{x} + \frac{\frac{1}{K}dx}{(1 - \frac{x}{K}) } = rdt
\]</div>
<div class="math notranslate nohighlight">
\[ 
    \int\frac{dx}{x} + \frac{1}{K}\int\frac{dx}{(1 - \frac{x}{K}) } = \int rdt
\]</div>
<div class="math notranslate nohighlight">
\[ 
    \ln(x) - \ln(1 - \frac{x}{K}) = rt + C
\]</div>
<div class="math notranslate nohighlight">
\[ 
    \ln(\frac{x}{1 - \frac{x}{K}}) = rt + C
\]</div>
<div class="math notranslate nohighlight">
\[ 
    \frac{x}{1 - \frac{x}{K}} = C_1e^{rt}
\]</div>
<p>It is easy to see that <span class="math notranslate nohighlight">\(C_1\)</span> can be computed from initial value problem (at <span class="math notranslate nohighlight">\(t=0\)</span>) as following:</p>
<div class="math notranslate nohighlight">
\[ 
    C_1 = \frac{x_0}{1 - \frac{x_0}{K}} = \frac{Kx_0}{K - x_0}
\]</div>
<p>where <span class="math notranslate nohighlight">\(x_0 = x(t=0)\)</span> correspondingly. After expressing <span class="math notranslate nohighlight">\(x\)</span> from the integral above have:</p>
<div class="math notranslate nohighlight" id="equation-ex-sol-3">
<span class="eqno">(13.4)<a class="headerlink" href="#equation-ex-sol-3" title="Permalink to this equation">#</a></span>\[ 
    x(t) = \frac{K}{1 + \frac{K - x_0}{x_0}e^{-rt}}
\]</div>
<p>What regimes are possible for this solution? Let’s suppose that carrying capacity <span class="math notranslate nohighlight">\(K=1\)</span>, initial population <span class="math notranslate nohighlight">\(x_0=0.5\)</span> and explore graphically the dynamics at different <span class="math notranslate nohighlight">\(r\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x3</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span> <span class="n">K</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">K</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> <span class="o">/</span> <span class="n">x0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">r</span> <span class="o">*</span> <span class="n">t</span><span class="p">))</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Population size&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mf">3.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x3</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$r = </span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x3</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$x_0 = 1.3; r = 1.5$&#39;</span><span class="p">);</span> <span class="c1"># another initial condition</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/system_resilience_7_0.png" src="../_images/system_resilience_7_0.png" />
</div>
</div>
<p>Excellent! We solved a new kind of dynamical system describing bacterial growth with limited resources. As before we observe three different regimes for <span class="math notranslate nohighlight">\(r&gt;0\)</span> - logistic growth; <span class="math notranslate nohighlight">\(r=0\)</span> - no dynamics; <span class="math notranslate nohighlight">\(r&lt;0\)</span> - logistic decay (not exponential!). But we also see something new, our solutions for growth are bounded with carrying capacity <span class="math notranslate nohighlight">\(K=1\)</span> and, for all initial conditions (even for larger than <span class="math notranslate nohighlight">\(K\)</span>), trajectories <em>attract</em> to a fixed value <span class="math notranslate nohighlight">\(K\)</span> which is called an <strong>attractor</strong>. In the next chapter, we will discuss attractors in more detail, but before that, we need to learn what to do with non-integrable non-linear differential equations.</p>
<div class="dropdown admonition">
<p class="admonition-title">Exercise 1</p>
<p>What kind of growth exhibits equation <span class="math notranslate nohighlight">\(\dot{x} = a*x^2\)</span>? Solve the equation for positive <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(x_0 &gt; 0\)</span>. What wrong with this equation if we would try it for modeling real systems growth? What is the name of this model (try to google or chatGPT it)?</p>
</div>
</section>
<section id="numerical-integration">
<h3><a class="toc-backref" href="#id15"><span class="section-number">13.1.3. </span>Numerical integration</a><a class="headerlink" href="#numerical-integration" title="Permalink to this headline">#</a></h3>
<p>The class of integrable differential equations is very small, even so, they are extremely useful for describing complex systems dynamics. In some cases, however, you may develop a more sophisticated model of a process under study and the corresponding differential equation does not have a closed-form solution. What can we do in this case? Consider the following complication of the logistic model:</p>
<div class="math notranslate nohighlight" id="equation-eq-complex-logistic">
<span class="eqno">(13.5)<a class="headerlink" href="#equation-eq-complex-logistic" title="Permalink to this equation">#</a></span>\[
    \dot{x} = r(t) (x  - \frac{x^2}{K(t)})  =  r_0 sin^2(t) (x  - \frac{x^2}{1 + \sqrt{t}})
\]</div>
<p>now our logistic model contains two additional assumptions: (i) the growth rate changes as a sinusoidal function of time <span class="math notranslate nohighlight">\(r = r(t) = r_0 sin^2(t)\)</span> - it models a photo-sensitivity of bacteria allowing them to reproduce effectively in the day time with maximum growth rate or <span class="math notranslate nohighlight">\(r_0\)</span>; (ii) the carrying capacity slowly increases with time by square root law starting from 1, namely <span class="math notranslate nohighlight">\(K = K(t) = 1 + \sqrt{t}\)</span>. You can check that this new differential equation is non-integrable in elementary functions, so we need to obtain the solution <strong>numerically</strong>.</p>
<p>We introduce the <strong>Forward-Euler</strong> scheme of integration. without going into the details of the proof, forward Euler prescribes just to iteratively compute each next step as a sum of results from the previous step and the computed value of the function on the previous step. Let’s rewrite our new logistic equation <a class="reference internal" href="#equation-eq-complex-logistic">(13.5)</a> in the general form:</p>
<div class="math notranslate nohighlight">
\[
  \frac{dx}{dt} = f(x, t)
\]</div>
<p>rewrite the differetial equation in finite-difference form:</p>
<div class="math notranslate nohighlight">
\[
  \frac{\Delta x}{\Delta t} = \frac{x_i - x_{i-1}}{\Delta t} = f(x_{i-1}, t_{i-1})
\]</div>
<p>expressing <span class="math notranslate nohighlight">\(x_i\)</span> from the latter have:</p>
<div class="math notranslate nohighlight">
\[
  x_i = x_{i-1} + f(x_{i-1}, t_{i-1})\Delta t 
\]</div>
<p>We did it! We have a clear iterative scheme for integrating our system. Let’s code it, assuming that <span class="math notranslate nohighlight">\(x_0 = 0.5\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">r0</span><span class="p">:</span> <span class="n">r0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">t</span><span class="p">)))</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># number of integration steps</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#time difference</span>
<span class="n">r0</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">x0</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="c1">#resulting integral</span>
<span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span> <span class="c1"># assign initial condition</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span> <span class="c1">#integrate from 1-st index</span>
    <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">r0</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Population size&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Numerical solution&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Day light intensity (growth rate)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Carrying capacity&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/system_resilience_11_0.png" src="../_images/system_resilience_11_0.png" />
</div>
</div>
<p>First, it is beautiful, isn’t it? We see that daytime affects an ability to grow and expanding carrying capacity determines the limits of this growth. This simple example helps us to understand the <strong>top-down</strong> modeling approach. This means that we do not know exactly the underlying microscopic biological mechanism inducing growth in the number of bacteria, rather we try to guess the function which can <em>describe</em> the observable behavior. This is something that is also known as the <strong>phenomenological</strong> model which tries to describe a phenomenon without explicitly pointing to its mechanism of it.</p>
<div class="dropdown admonition">
<p class="admonition-title">Note</p>
<p>Surely, forward Euler’s method is not the best in terms of accuracy of approximation and speed of convergence (the famous Runge Kutta method can be much better). To dig into the plethora of algorithms for numerical integrations we recommend the following book <span id="id1">[]</span></p>
</div>
</section>
</section>
<section id="stability-theory-and-bifurcations">
<h2><a class="toc-backref" href="#id16"><span class="section-number">13.2. </span>Stability theory and bifurcations</a><a class="headerlink" href="#stability-theory-and-bifurcations" title="Permalink to this headline">#</a></h2>
<section id="stability-intuition">
<span id="id2"></span><h3><a class="toc-backref" href="#id17"><span class="section-number">13.2.1. </span>Stability intuition</a><a class="headerlink" href="#stability-intuition" title="Permalink to this headline">#</a></h3>
<p>Now we start to develop the core dynamical system property - its stability. It is a case when the mathematical framework has a strict everyday physical analogy. Let’s discuss the picture below:</p>
<figure class="align-default" id="potential">
<a class="reference internal image-reference" href="../_images/Potential.png"><img alt="../_images/Potential.png" src="../_images/Potential.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 13.1 </span><span class="caption-text">Example of potential landscape.</span><a class="headerlink" href="#potential" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>We see a ball in three positions. You can easily say which position is stable, unstable, or metastable. Indeed, the first position denoted <span class="math notranslate nohighlight">\(x^*_1\)</span> - is a stable position. Mathematically speaking, the position of <span class="math notranslate nohighlight">\(x\)</span> is called stable if after any arbitrarily small perturbation (<span class="math notranslate nohighlight">\(y\)</span>) the system returns the initial state <span class="math notranslate nohighlight">\(x^*_1\)</span>. The opposite case for <span class="math notranslate nohighlight">\(x^*_2\)</span> where any small perturbation forces the system to leave the previous state. The third case <span class="math notranslate nohighlight">\(x^*_3\)</span> is metastable (or marginally stable) that is this position is a midpoint between stable and unstable regimes of the system (remember equation <a class="reference internal" href="#equation-ex-sol-2">(13.3)</a> with <span class="math notranslate nohighlight">\(a=0\)</span>). This third case is also called <strong>critical</strong> and it is very important for our discussion of system <strong>resilience</strong>. One minor technical thing remained. We need to understand how to obtain this so-called <strong>potential landscape</strong> depicted at <a class="reference internal" href="#potential"><span class="std std-numref">Fig. 13.1</span></a>, i.e. some function whose maxima, minima and <em>saddles</em> (or flat valleys) describe the full set of fixed (or critical) points <span class="math notranslate nohighlight">\(\{x^* | \frac{dx}{dt}|_{x=x^*}=0\}\)</span>, and, what is more important, characterizes stability properties of these points.</p>
<p>Let’s use an already familiar logistic model for all derivations.</p>
<div class="math notranslate nohighlight">
\[ 
    \frac{dx}{dt} = rx(1 - \frac{x}{K}) = f_\theta(x)
\]</div>
<p>This model has two parameters <span class="math notranslate nohighlight">\(r\)</span> and <span class="math notranslate nohighlight">\(K\)</span> which we just gather in a set <span class="math notranslate nohighlight">\(\theta = \{r, K\}\)</span> and will use subscript <span class="math notranslate nohighlight">\(\theta\)</span> for the denotation pointing that our function <span class="math notranslate nohighlight">\(f_\theta\)</span> contains these two parameters. By definition, a fixed point is a point where the derivative equals zero - where the dynamics “stops”.</p>
<div class="math notranslate nohighlight">
\[ 
    \frac{dx}{dt} = 0 \Leftrightarrow f_\theta(x) = rx(1 - \frac{x}{K}) = 0
\]</div>
<p>It is easy to see that a function <span class="math notranslate nohighlight">\(rx(1 - \frac{x}{K}) = 0\)</span> has roots at points <span class="math notranslate nohighlight">\(x=0\)</span> and <span class="math notranslate nohighlight">\(x = K\)</span>. As we discussed above, the point <span class="math notranslate nohighlight">\(x=K\)</span> is an attractor but can we prove rigorously that it is also a stable point? And, what type of stability <span class="math notranslate nohighlight">\(x=0\)</span> has? Consider the following equation perturbed around a fixed point:</p>
<div class="math notranslate nohighlight">
\[ 
    \frac{d(x^* + y)}{dt} = f_\theta(x^* + y)
\]</div>
<p>expand the left term as the sum of derivatives:</p>
<div class="math notranslate nohighlight">
\[ 
    \frac{dx^*}{dt} + \frac{dy}{dt} = f_\theta(x^* + y)
\]</div>
<p>by definition, <span class="math notranslate nohighlight">\(dx^*/dt\)</span> = 0 so we have:</p>
<div class="math notranslate nohighlight">
\[ 
    \frac{dy}{dt} = f_\theta(x^* + y)
\]</div>
<p>We are interested how function <span class="math notranslate nohighlight">\(f_\theta\)</span> depends on a small perturbation <span class="math notranslate nohighlight">\(y\)</span> around <span class="math notranslate nohighlight">\(x^*\)</span>, so let’s expand it in a Taylor series around <span class="math notranslate nohighlight">\(x^*\)</span>:</p>
<div class="math notranslate nohighlight">
\[ 
    \frac{dy}{dt} = f_\theta(x^*) + ((x^* + y) - x^*)\frac{df_\theta}{dx}\bigg|_{x=x^*} + \ldots
\]</div>
<div class="math notranslate nohighlight">
\[ 
    \frac{dy}{dt} = f_\theta(x^*) + y\frac{df_\theta}{dx}\bigg|_{x=x^*} + \ldots
\]</div>
<p>Assuming that: (i) perturbation <span class="math notranslate nohighlight">\(y\)</span> is infinitesimal, (ii) function <span class="math notranslate nohighlight">\(f_\theta\)</span> is continuous and (at least) twice differentiable - it is enough to consider only linear terms in the Taylor expansion. Remember also that the constant term <span class="math notranslate nohighlight">\(f_\theta(x=x^*, y=0)=0\)</span> by definition, finally have:</p>
<div class="math notranslate nohighlight">
\[ 
    \frac{dy}{dt} \approx y\frac{df_\theta}{dx}\bigg|_{x=x^*}
\]</div>
<p>Historically, the partial derivative term is usually denoted as <span class="math notranslate nohighlight">\(\lambda_\theta\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-eq-pert">
<span class="eqno">(13.6)<a class="headerlink" href="#equation-eq-pert" title="Permalink to this equation">#</a></span>\[ 
    \frac{dy}{dt} \approx \lambda_\theta y
\]</div>
<p>We will refer to the obtained as a <strong>perturbation equation</strong>. A simple analysis is now applied to determine whether the perturbation grows or decays as time evolves (remember equation <a class="reference internal" href="#equation-ex-sol-2">(13.3)</a> with <span class="math notranslate nohighlight">\(\lambda_\theta\)</span> instead of <span class="math notranslate nohighlight">\(a\)</span>). If <span class="math notranslate nohighlight">\(\lambda_\theta &gt; 0\)</span> the initially arbitrarily small perturbation grows in time and dynamics become unstable. On the other hand, if <span class="math notranslate nohighlight">\(\lambda_\theta &lt; 0\)</span> the perturbation decays in time and stable dynamics is observed. In the intermediate case, <span class="math notranslate nohighlight">\(\lambda_\theta = 0\)</span> system is in a <strong>critical state</strong> and nothing can be said about system stability until the value of <span class="math notranslate nohighlight">\(\lambda_\theta\)</span> changes.</p>
<p>Let’s look how <span class="math notranslate nohighlight">\(\lambda_\theta\)</span> depends on its parameters <span class="math notranslate nohighlight">\(\theta\)</span>:</p>
<div class="math notranslate nohighlight">
\[
    \lambda_\theta = \frac{df_\theta}{dx}\bigg|_{x=x^*} = r - \frac{2r}{K}x^*
\]</div>
<p>one can see that for <span class="math notranslate nohighlight">\(x^*=K\)</span> the system is stable while <span class="math notranslate nohighlight">\(r&gt;0\)</span> because <span class="math notranslate nohighlight">\(r - \frac{2r}{K}K = r - 2r = -r &lt; 0\)</span>. The opposite works for <span class="math notranslate nohighlight">\(x^*=0\)</span>, then <span class="math notranslate nohighlight">\(r - \frac{2r}{K}0 = r &gt; 0\)</span> - the system is unstable (revise the plot in the non-linear system paragraph).</p>
</section>
<section id="potential-function">
<h3><a class="toc-backref" href="#id18"><span class="section-number">13.2.2. </span>Potential function</a><a class="headerlink" href="#potential-function" title="Permalink to this headline">#</a></h3>
<p>Once we studied a system’s behavior around fixed points, we are ready to formulate a potential function definition. It is rather straightforward but let us step back and discuss what drives any dynamics system. It is a funny coincidence (or not?) that symbol of function <span class="math notranslate nohighlight">\(f\)</span> is denoted with the letter “f” just like a physical force <span class="math notranslate nohighlight">\(F\)</span>. Indeed, any mechanistic dynamical system drives with some force <span class="math notranslate nohighlight">\(F\)</span>:</p>
<div class="math notranslate nohighlight">
\[
    \frac{dx}{dt} = F
\]</div>
<p>we also know from the higher school physics course that force acts on a body moving in a potential field <span class="math notranslate nohighlight">\(V\)</span>, and the force equals the negative gradient of the field i.e.</p>
<div class="math notranslate nohighlight">
\[
    \frac{dx}{dt} = F = -\frac{dV}{dx}
\]</div>
<p>Thus, remembering that in our problem <span class="math notranslate nohighlight">\(F = f_\theta\)</span> have the following equation for the potential function:</p>
<div class="math notranslate nohighlight">
\[
    V_\theta = -\int f_\theta dx
\]</div>
<p>substitution of the logistic function yields:</p>
<div class="math notranslate nohighlight">
\[
    V_\theta(x) = -\int rx(1 - \frac{x}{K}) dx = r(\frac{x^3}{3K} - \frac{x^2}{2}) + V_0
\]</div>
<p>where <span class="math notranslate nohighlight">\(V_0\)</span> is a constant which can be equal to zero (we do not bother with constant potential level, only differences and fixed points are interested in our discussion).</p>
<p>Let’s finally draw the potential landscape for the logistic growth model:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">V</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">K</span><span class="p">:</span> <span class="n">r</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">K</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.75</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="c1">#negative population size is non-physical</span>
<span class="n">K</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Population size&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Potential&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">3.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.5</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">V</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">K</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Potential landscape for r=</span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/system_resilience_16_0.png" src="../_images/system_resilience_16_0.png" />
</div>
</div>
<p>As we computed in the previous paragraph, for a positive <span class="math notranslate nohighlight">\(r\)</span> we have a convex potential landscape around the point <span class="math notranslate nohighlight">\(x=K\)</span> (attractor) such that any imaginary ball placed at this point returns to it after a small perturbation. Moreover, the point <span class="math notranslate nohighlight">\(x=0\)</span> reads as unstable, equivalently, the potential function around <span class="math notranslate nohighlight">\(x=0\)</span> is concave. However, once a parameter <span class="math notranslate nohighlight">\(r\)</span> crosses <span class="math notranslate nohighlight">\(0\)</span> towards negative values we observe an opposite picture. The point <span class="math notranslate nohighlight">\(x=K\)</span> becomes unstable and divides two different regimes: complete decay (left) and unlimited growth (right). Unlimited growth is a new property of this system which was initially assumed to model limiting a reproduction capacity. So, possibly negative values of <span class="math notranslate nohighlight">\(r\)</span> make this concrete model non-physical.</p>
<p>Interestingly that a sequence of parameters <span class="math notranslate nohighlight">\(r\)</span> changes the shape of the potential function ultimately converting it to a qualitatively different state. In the next paragraph, we consider how briefly describe the stability properties of a system with one diagram tracking its journey toward the bifurcation.</p>
<div class="dropdown admonition">
<p class="admonition-title">Exercise 2</p>
<p>Consider the model <span class="math notranslate nohighlight">\(\dot{x} = ax^2\)</span>:</p>
<ul class="simple">
<li><p>Find an analytical solution for the model, assuming that <span class="math notranslate nohighlight">\(x(0) = x_0 &gt; 0\)</span>;</p></li>
<li><p>Compute a potential function for it;</p></li>
<li><p>Compute its fixed points;</p></li>
<li><p>Make a conclusion about the stability of fixed points;</p></li>
<li><p>Look up this <a class="reference external" href="https://iopscience.iop.org/article/10.1070/PU1996v039n01ABEH000127/meta">paper</a>. Explain how the author uses the model you just learned. And it was supposed to happen in 2025? What do you think of the author’s reasoning?</p></li>
</ul>
</div>
</section>
<section id="catastrophic-bifurcation">
<h3><a class="toc-backref" href="#id19"><span class="section-number">13.2.3. </span>Catastrophic bifurcation</a><a class="headerlink" href="#catastrophic-bifurcation" title="Permalink to this headline">#</a></h3>
<p>In this paragraph, we develop our first dynamical model of organismal aging. This will be, certainly, a toy model but it helps us to formulate the aging problem in the learned dynamical system framework, study its potential functions and get acquainted with a <strong>bifurcation</strong> concept. We develop our model from scratch and step by step, based on the techniques we learned above.</p>
<p>First, we need to model the growth of an organism. We already know how to do that because the organism is a bag of cells with limited bag sizes. The important difference between a colony of unicellular organisms and a multicellular is now intercellular communication is of great importance. Following the spirit of previous chapters of this book, we will model <strong>biological age</strong> with an evolving system variable <span class="math notranslate nohighlight">\(x\)</span>. The growth term can be defined as before in the logistic model <span class="math notranslate nohighlight">\((r-x)x\)</span>, where <span class="math notranslate nohighlight">\(r\)</span> is a growth rate. Note, that the first term model does not contain the carrying capacity term explicitly, but you may easily guess that it is equal to <span class="math notranslate nohighlight">\(1\)</span>, check it out! The second term is something new for us. We want to model costs for intercellular communication which: (i) grow with the number of cells as a square of cell number (due to pairwise interactions), (ii) becomes larger with age (change in <span class="math notranslate nohighlight">\(\delta\)</span> parameter) due to the increase in the number of breakdowns, protein misfolding and epigenetic alterations within cells, an extracellular matrix degradation, other deregulations which are consequences of the previous two. We propose to model all this stuff with a term <span class="math notranslate nohighlight">\(\delta x^2\)</span>, where <span class="math notranslate nohighlight">\(\delta\)</span> reflects costs related to an organism’s maintenance. Writing them together we have:</p>
<div class="math notranslate nohighlight" id="equation-eq-aging-dummy">
<span class="eqno">(13.7)<a class="headerlink" href="#equation-eq-aging-dummy" title="Permalink to this equation">#</a></span>\[
    \dot{x} = (r - x)x + \delta x^2
\]</div>
<p>You may notice some ambiguity in this model. On the one hand, we model biological age <span class="math notranslate nohighlight">\(x\)</span>, but terms model the number of cells and costs on their pairwise communications. The reason is that biological age is a *<em>latent variable</em> describing organism’s state. This variable may be constructed, in principle, as a combination of other explicit variables that has direct physical meaning. Therefore, a latent variable may be correlated with an actual number of cells at a one-time interval and with costs for an organism interval at another time interval. Unfortunately, it is very difficult to formulate <em>aging</em> as a unimodal explicit physical process (otherwise it would have already been done), so it is convenient to use latent representation.</p>
<div class="dropdown admonition">
<p class="admonition-title">Exercise 3</p>
<p>Compute critical points, potential function and analytical solution for the equation <a class="reference internal" href="#equation-eq-aging-dummy">(13.7)</a>.</p>
</div>
<p>The fixed points for the equation <a class="reference internal" href="#equation-eq-aging-dummy">(13.7)</a> are:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{cases}
    x^*_1 = 0 \\
    x^*_2 = \frac{r}{1-\delta}
    \end{cases}
\end{split}\]</div>
<p>Apparently, something should happen once the <span class="math notranslate nohighlight">\(\delta\)</span> constant crosses zero. We will study it later, but before let’s write an expression for a potential function:</p>
<div class="math notranslate nohighlight">
\[
    V_\theta(x) = \frac{(1 - \delta) x^3}{3} - \frac{rx^2}{2}  
\]</div>
<p>And the solution for the differential equation is:</p>
<div class="math notranslate nohighlight">
\[
    x(t) = \frac{r}{1 - \delta - (1 - \delta - \frac{r}{x_0})e^{-rt}}
\]</div>
<p>As always, firstly draw them in an assumption of <em>non-aging</em> organisms:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_sol</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x0</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="n">r</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">d</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">d</span> <span class="o">-</span> <span class="n">r</span><span class="o">/</span><span class="n">x0</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">r</span><span class="o">*</span><span class="n">t</span><span class="p">))</span>
<span class="n">V</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">d</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="mi">3</span> <span class="o">-</span> <span class="n">r</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span>

<span class="n">r</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mf">2.5</span>
<span class="n">x0</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Chronological age&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Biological age&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x_sol</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Analytical solution&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">);</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Biological age&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Potential value&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$x^*_1=0$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">r</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">d</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$x^*_2=r/(1-\delta)$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">V</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Potential&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/system_resilience_19_0.png" src="../_images/system_resilience_19_0.png" />
</div>
</div>
<p>For non-aging organisms, everything looks like in the growth model with scaled biological age instead of population size. We have an attractor in a point <span class="math notranslate nohighlight">\(x^*=r/(1 - \delta)\)</span> (which is a minimum of potential function), where <span class="math notranslate nohighlight">\(delta\)</span> is a small number reflecting the small costs needed for organism maintenance. Let’s assume the first intervention. Suppose the costs suddenly increase on a value of <span class="math notranslate nohighlight">\(1\)</span> when the organism achieved chronological age <span class="math notranslate nohighlight">\(19\)</span>. To model such an intervention it’s better to use the numerical modeling we learned earlier:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="n">r</span> <span class="o">*</span> <span class="n">x</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">d</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># number of integration steps</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">19.3</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#time difference</span>
<span class="n">r</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.001</span>
<span class="n">x0</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="c1">#resulting integral</span>
<span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span> <span class="c1"># assign initial condition</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span> <span class="c1">#integrate from 1-st index</span>
    <span class="k">if</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">19</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="mf">1.001</span>
    <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">r</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Chronological Age&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Biological Age&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Numerical solution (intervention)&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x_sol</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Analytical solution (no intervention)&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/system_resilience_21_0.png" src="../_images/system_resilience_21_0.png" />
</div>
</div>
<p>Wow, it’s super fast! This intervention changes the behavior of the system making it grow. But is it stable growth? Might it be that the organism just takes a new biological age state? The answer is not, and to demonstrate it comprehensively we introduce the concept of a <strong>bifurcation diagram</strong>.</p>
<p>A bifurcation diagram is a plot with all possible <span class="math notranslate nohighlight">\(x^*\)</span> depending on some system parameter (from \theta). In our current case, we are interested in parameter <span class="math notranslate nohighlight">\(\delta\)</span> whose values determine the qualitative behavior of the system. A bifurcation diagram is better to plot by hand if possible.</p>
<figure class="align-default" id="bifurcation">
<a class="reference internal image-reference" href="../_images/bifurcation.png"><img alt="../_images/bifurcation.png" src="../_images/bifurcation.png" style="width: 500px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 13.2 </span><span class="caption-text">Bifurcation diagram for the toy aging model.</span><a class="headerlink" href="#bifurcation" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The solid blue line on the diagram is a set of stable solutions for the system <a class="reference internal" href="#equation-eq-aging-dummy">(13.7)</a>. The dashed blue line at point <span class="math notranslate nohighlight">\(x=0\)</span>, otherwise, a set of unstable solutions. The set of initial conditions taken above the stable line results in convergence to the stable solution. The set of initial conditions taken between the stable and the unstable lines results in convergence to the stable solution. Black arrows point in the direction of system evolution. When we increase <span class="math notranslate nohighlight">\(\delta\)</span> starting from <span class="math notranslate nohighlight">\(0\)</span> the stable solution increases in magnitude until we achieve point <span class="math notranslate nohighlight">\(\delta_c\)</span> which is a critical threshold after which a bifurcation occurs. After crossing the critical threshold no physically stable solutions remain (here we assume that biological age cannot accept negative values, so the red line cannot be a solution) and the system is doomed to diverge.</p>
<p>Okay, let’s gather two insights from the bifurcation diagram about our model:</p>
<ol class="simple">
<li><p>It is not necessary to cross the critical threshold to obtain an arbitrarily large biological age. It is enough that <span class="math notranslate nohighlight">\(\delta\)</span> would be close to <span class="math notranslate nohighlight">\(1\)</span>.</p></li>
<li><p>Crossing the threshold guarantees system instability (<strong>catastrophe</strong>) which we can treat as an organism’s <em>death</em>.</p></li>
</ol>
<p>The organism can, in principle, live infinitely long with non-increasing <span class="math notranslate nohighlight">\(\delta\)</span>, but it seems like in real situations delta depends on time <span class="math notranslate nohighlight">\(t\)</span> and some interventions than <span class="math notranslate nohighlight">\(x\)</span> itself. Let’s add this assumption to our model. Let <span class="math notranslate nohighlight">\(\delta\)</span> now a rate of maintenance costs, i.e.:</p>
<div class="math notranslate nohighlight" id="equation-eq-aging-dummy-time">
<span class="eqno">(13.8)<a class="headerlink" href="#equation-eq-aging-dummy-time" title="Permalink to this equation">#</a></span>\[
    \dot{x} = (r - x)x + \delta \cdot t \cdot x^2
\]</div>
<p>We solve this equation numerically, but an analytical solution exists too (try the exercise below).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="n">r</span> <span class="o">*</span> <span class="n">x</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">d</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># number of integration steps</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#time difference</span>
<span class="n">r</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">x0</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="c1">#resulting integral</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.013</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">]:</span>
    <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span> <span class="c1"># assign initial condition</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span> <span class="c1">#integrate from 1-st index</span>
        <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">r</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Numerical solution, d=</span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Chronological Age&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Biological Age&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_52289/1557638224.py:1: RuntimeWarning: overflow encountered in double_scalars
  f = lambda x, t, r, d: r * x - (1. - d * t) * x**2
</pre></div>
</div>
<img alt="../_images/system_resilience_24_1.png" src="../_images/system_resilience_24_1.png" />
</div>
</div>
<p>At value <span class="math notranslate nohighlight">\(d=0.013\)</span> this looks more realistic than the intervention case, we start aging after ending the growth proportionally to time. Indeed we grow rapidly at an earlier stage of life and, after that, start to age exponentially by a quadratic increase in costs of system maintenance. It should be emphasized that the resulting model is a toy model and rather serves the purpose of demonstrating how a slight modification of the logistic model can describe biological age. One should maintain a healthy skepticism about all such models and always question their usefulness and plausibility.</p>
<div class="dropdown admonition">
<p class="admonition-title">Exercise 5</p>
<p>Solve the equation <a class="reference internal" href="#equation-eq-aging-dummy-time">(13.8)</a> analytically and draw a bifurcation diagram (on a sheet of paper). What difference with the initial model?</p>
</div>
<p>This a good first step to the world of really complex aging models. But we already can say much even with these <em>one-dimensional</em> models. More insights are waiting for us in the multidimensional world which we will discuss below.</p>
</section>
</section>
<section id="system-of-differential-equations">
<h2><a class="toc-backref" href="#id20"><span class="section-number">13.3. </span>System of differential equations</a><a class="headerlink" href="#system-of-differential-equations" title="Permalink to this headline">#</a></h2>
<p>It’s time to expand our understanding of dynamical systems to a multidimensional case. We first introduce a new concept of <strong>state vector</strong> <span class="math notranslate nohighlight">\(x\)</span> which is a replacement for state variable <span class="math notranslate nohighlight">\(x\)</span> used above for unidimensional dynamic systems. State vector is composed from <span class="math notranslate nohighlight">\(n\)</span> vector <strong>components</strong> <span class="math notranslate nohighlight">\(\{x_i\}_n\)</span> which represents different dynamical variables of a system (organism). State vector, in principle, can be composed from any physiological state variables (blood pressure, body temperature, heart rate, etc.), but it is important to choose such of them which describes the system most “completely”. For example, when you try to build a dynamical model of a running human, it is desirable to include heart rate as variable into a state vector. On the other hand, such variable as hair length is apparently redundant to include. The same logic works for a model of aging. When we try to model it on a physiological level, tissue level or molecular level, different variables should be used. However, some models can comprise state variables from different levels of system organization. In this case, we need to bind them properly with functional relations.</p>
<p>In this section we will consider molecular model of human aging building it based on the concept of <strong>gene regulatory network</strong>, which we discuss below.</p>
<section id="stability-in-linear-multidimensional-case">
<h3><a class="toc-backref" href="#id21"><span class="section-number">13.3.1. </span>Stability in linear multidimensional case</a><a class="headerlink" href="#stability-in-linear-multidimensional-case" title="Permalink to this headline">#</a></h3>
<p>Linear systems of differential equations allows to model a countless number of complex phenomena. We start with a simple model of gene regulation, which includes feedback control loop (<a class="reference internal" href="#grn"><span class="std std-numref">Fig. 13.3</span></a>). This is a scalable model proposed in <span id="id3">[]</span> for modeling a number of genes. We restrict ourselves to a consideration only a one gene-rna-protein cascade where the protein acts as a regulator of the gene transcription.</p>
<figure class="align-default" id="grn">
<a class="reference internal image-reference" href="../_images/gene_regulatory.png"><img alt="../_images/gene_regulatory.png" src="../_images/gene_regulatory.png" style="width: 500px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 13.3 </span><span class="caption-text">Dynamic system of gene regulation.</span><a class="headerlink" href="#grn" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>We first write the system of differential equations and explain variables:</p>
<div class="math notranslate nohighlight" id="equation-eq-linear-system">
<span class="eqno">(13.9)<a class="headerlink" href="#equation-eq-linear-system" title="Permalink to this equation">#</a></span>\[\begin{split}
     \begin{cases}
          \frac{dr}{dt} = - Vr + Cp  \\
          \frac{dp}{dt} = Lr - Up 
     \end{cases}
\end{split}\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(r\)</span> and <span class="math notranslate nohighlight">\(p\)</span> are mRNA and protein relative concentrations correspondingly;</p></li>
<li><p><span class="math notranslate nohighlight">\(V\)</span> - degradation rate of mRNAs;</p></li>
<li><p><span class="math notranslate nohighlight">\(U\)</span> - degradation rate of proteins;</p></li>
<li><p><span class="math notranslate nohighlight">\(L\)</span> - translation rate;</p></li>
<li><p><span class="math notranslate nohighlight">\(C\)</span> - transcription regulation rate. This constant determines a character of feedback loop. The protein is a transcriptional activator if <span class="math notranslate nohighlight">\(C&gt;0\)</span> and a repressor if <span class="math notranslate nohighlight">\(C&lt;0\)</span>.</p></li>
</ul>
<p>Let’s combine both state variables into a state vector <span class="math notranslate nohighlight">\(x = [r, p]^T\)</span> (we will use column notation for vectors). Then the right part of the equation <a class="reference internal" href="#equation-eq-linear-system">(13.9)</a> can be written as a matrix <span class="math notranslate nohighlight">\(M\)</span> of coefficients multiplied by the state vector <span class="math notranslate nohighlight">\(x\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
     \begin{bmatrix}
          \dot{r}\\
          \dot{p}
     \end{bmatrix}
     =
     \begin{bmatrix}
          -V &amp; C \\
          L &amp; -U
     \end{bmatrix}
     \begin{bmatrix}
          r\\
          p
     \end{bmatrix}
\end{split}\]</div>
<p>or, in brief:</p>
<div class="math notranslate nohighlight">
\[
     \dot{x} = Mx
\]</div>
<p>This system can be solved analytically, but now we use numerical solution with some constants.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_linear_ODE</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">M</span><span class="p">):</span>
    <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">M</span><span class="p">:</span> <span class="n">M</span> <span class="o">@</span> <span class="n">x</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
    <span class="n">x</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span> <span class="c1">#Forward Euler integration</span>
        <span class="n">x</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">M</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span>

<span class="c1">### SYSTEM MATRIX</span>
<span class="n">V</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.1</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="n">V</span><span class="p">,</span> <span class="n">C</span><span class="p">],</span> 
              <span class="p">[</span><span class="n">L</span><span class="p">,</span> <span class="o">-</span><span class="n">U</span><span class="p">]])</span>
<span class="c1">###</span>

<span class="n">m</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># number of time steps</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
<span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span> <span class="c1">#initial condition</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">compute_linear_ODE</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_linear_system</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mf">5.5</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Relative abundance&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Time trajectory&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;mRNA&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;protein&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">);</span>
    <span class="n">sc</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;rainbow&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Phase portrait&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;mRNA&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;protein&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plot_linear_system</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/system_resilience_28_0.png" src="../_images/system_resilience_28_0.png" />
</div>
</div>
<p>The constants of matrix <span class="math notranslate nohighlight">\(M\)</span> were chosen so that system is stable, but how can we explore the stability in more general way? Previously we have seen that negative system constant <span class="math notranslate nohighlight">\(a\)</span> (in the equation <span class="math notranslate nohighlight">\(\dot{x} = ax\)</span>) guarantees the system converges. Is there the similar property for the matrix <span class="math notranslate nohighlight">\(M\)</span> making it “negative”? It turns out it is enough to require real part of all eigenvalues of matrix <span class="math notranslate nohighlight">\(M\)</span> to be negative for a system stability. Matrix with all eigenvalues are negative called <em>negatively-definite matrix</em>. Let’s find eigenvalues of matrix <span class="math notranslate nohighlight">\(M\)</span>.</p>
<p>The characteristic equation for matrix M reads as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \det{(M - \lambda I)} = 
    \begin{vmatrix}
        -V - \lambda &amp; C \\
        L &amp; -U - \lambda
    \end{vmatrix} = 0
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[
    (-V - \lambda)(-U - \lambda) - LC = 0
\]</div>
<div class="math notranslate nohighlight">
\[
    \lambda^2 + \lambda (U + V) + UV - LC = 0
\]</div>
<p>Solving this equation for <span class="math notranslate nohighlight">\(\lambda\)</span> yields the following expression for eigenvalues:</p>
<div class="math notranslate nohighlight">
\[
    \lambda_{1,2} = - \frac{U + V}{2} \pm \frac{\sqrt{(U - V)^2 + 4LC}}{2}
\]</div>
<p>Using the expression for the previous case (<span class="math notranslate nohighlight">\(V=0.7\)</span>, <span class="math notranslate nohighlight">\(U=0.7\)</span>, <span class="math notranslate nohighlight">\(C=1.0\)</span>, <span class="math notranslate nohighlight">\(L=0.1\)</span>) obtain the eigenvalues <span class="math notranslate nohighlight">\(\lambda_1=-0.384\)</span>, <span class="math notranslate nohighlight">\(\lambda_2=-1.016\)</span> which are both negative and, therefore, system is stable.</p>
<p>Let’s play with the parameters and explore which regimes are possible for the system:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_eigvals</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">L</span><span class="p">):</span>
    <span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">,</span> <span class="p">[</span><span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">L</span><span class="p">])</span> <span class="c1">#allows complex eigvals</span>
    <span class="k">return</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">U</span> <span class="o">+</span> <span class="n">V</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">U</span> <span class="o">-</span> <span class="n">V</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">L</span> <span class="o">*</span> <span class="n">C</span><span class="p">)),</span>
            <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">U</span> <span class="o">+</span> <span class="n">V</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">U</span> <span class="o">-</span> <span class="n">V</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">L</span> <span class="o">*</span> <span class="n">C</span><span class="p">)))</span>

<span class="c1">#Case 1: unstable system, mRNA boost (large C)</span>
<span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">0.1</span>
<span class="n">eigvals</span> <span class="o">=</span> <span class="n">compute_eigvals</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="n">U</span><span class="p">,</span> <span class="n">C</span><span class="p">],</span> <span class="p">[</span><span class="n">L</span><span class="p">,</span> <span class="o">-</span><span class="n">V</span><span class="p">]])</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">compute_linear_ODE</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;lmb1=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">eigvals</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s1">;&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;lmb2=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">eigvals</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plot_linear_system</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>lmb1=(0.3+0j); lmb2=(-1.7-0j)
</pre></div>
</div>
<img alt="../_images/system_resilience_30_1.png" src="../_images/system_resilience_30_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Case 2: unstable system, no decay (U=0, V=0)</span>
<span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.1</span>
<span class="n">eigvals</span> <span class="o">=</span> <span class="n">compute_eigvals</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="n">U</span><span class="p">,</span> <span class="n">C</span><span class="p">],</span> <span class="p">[</span><span class="n">L</span><span class="p">,</span> <span class="o">-</span><span class="n">V</span><span class="p">]])</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">compute_linear_ODE</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;lmb1=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">eigvals</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s1">;&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;lmb2=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">eigvals</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plot_linear_system</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>lmb1=(0.316+0j); lmb2=(-0.316-0j)
</pre></div>
</div>
<img alt="../_images/system_resilience_31_1.png" src="../_images/system_resilience_31_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Case 3: oscillation with decay, suppresion of transcription (C = -L)</span>
<span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">3.0</span>
<span class="n">eigvals</span> <span class="o">=</span> <span class="n">compute_eigvals</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="n">U</span><span class="p">,</span> <span class="n">C</span><span class="p">],</span> <span class="p">[</span><span class="n">L</span><span class="p">,</span> <span class="o">-</span><span class="n">V</span><span class="p">]])</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">compute_linear_ODE</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;lmb1=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">eigvals</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s1">;&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;lmb2=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">eigvals</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plot_linear_system</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>lmb1=(-0.7+3j); lmb2=(-0.7-3j)
</pre></div>
</div>
<img alt="../_images/system_resilience_32_1.png" src="../_images/system_resilience_32_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Case 4: no feedback and translation, radioactive decay (C=L=0)</span>
<span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span>
<span class="n">eigvals</span> <span class="o">=</span> <span class="n">compute_eigvals</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="n">U</span><span class="p">,</span> <span class="n">C</span><span class="p">],</span> <span class="p">[</span><span class="n">L</span><span class="p">,</span> <span class="o">-</span><span class="n">V</span><span class="p">]])</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">compute_linear_ODE</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;lmb1=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">eigvals</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s1">;&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;lmb2=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">eigvals</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plot_linear_system</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>lmb1=(-0.7+0j); lmb2=(-0.7-0j)
</pre></div>
</div>
<img alt="../_images/system_resilience_33_1.png" src="../_images/system_resilience_33_1.png" />
</div>
</div>
<p>Even only one positive eigenvalue makes the system unstable as you could see this from cases 1 and 2 - this is general for system of any dimensionality. The more interesting case appeared before us once eigenvalues have non-zero imaginary part. The system becomes oscillating. Most of biological systems exhibit oscillating behavior (circadian rythm, glycolisis). Note that, oscillating systems also can be stable, unstable, and meta-stable and corresponding bifurcations can switch between these states.</p>
<div class="dropdown admonition">
<p class="admonition-title">Exercise</p>
<p>Plot bifurcation diagram from parameter <span class="math notranslate nohighlight">\(C\)</span> for the system above.</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Exercise</p>
<p>Create a gene regulatory system with 2 genes (4 equations). Solve it numerically and plot trajectories. Compute eigenvalues numerically with function <code class="docutils literal notranslate"><span class="pre">numpy.linalg.eigvals</span></code>. Try to adjust parameters to make system stable.</p>
</div>
<p>One important observation is that we can say if the system will be stable or not by looking at one parameter - largest eigenvalue. Indeed, if largest eigenvalue is negative, then all others are also negative. It is a brilliant property of linear systems. But what about non-linear?</p>
</section>
<section id="stability-in-non-linear-multidimensional-case">
<h3><a class="toc-backref" href="#id22"><span class="section-number">13.3.2. </span>Stability in non-linear multidimensional case</a><a class="headerlink" href="#stability-in-non-linear-multidimensional-case" title="Permalink to this headline">#</a></h3>
<p>We start with rather simple but still tractable Michaelis-Menten gene regulatory model <span id="id4">[]</span>. We first formulate this model for <span class="math notranslate nohighlight">\(n\)</span> genes where each gene <span class="math notranslate nohighlight">\(x_i\)</span> is regulated by others including itself:</p>
<div class="math notranslate nohighlight" id="equation-eq-mm-model">
<span class="eqno">(13.10)<a class="headerlink" href="#equation-eq-mm-model" title="Permalink to this equation">#</a></span>\[
    \frac{dx_i}{dt} = -Bx_i + \sum^n_{j=1}A_{ij}\frac{x_j}{x_j + 1}
\]</div>
<p>Here, <span class="math notranslate nohighlight">\(B\)</span> - degradation rate in a linear term we have seen earlier, we assume it is the same for all genes; <span class="math notranslate nohighlight">\(A_{ij}\)</span> the regulatory constant which can take values <span class="math notranslate nohighlight">\(0\)</span> or <span class="math notranslate nohighlight">\(1\)</span> indicating the presence or absence of an activatory regulation. An element of matrix <span class="math notranslate nohighlight">\(A_{ij}\)</span> is read as <span class="math notranslate nohighlight">\(A_{i\leftarrow j}\)</span> meaning that <span class="math notranslate nohighlight">\(j\)</span>-th gene (column index) acts to <span class="math notranslate nohighlight">\(i\)</span>-th gene (row index). But wait, why the second non-linear term has so strange functional form? It is a saturating function converging to <span class="math notranslate nohighlight">\(1\)</span> as <span class="math notranslate nohighlight">\(x_j\)</span> increases. It turns out that it reflects quite simple idea of promoter regulation, namely, if some product of gene <span class="math notranslate nohighlight">\(j\)</span> binds to a promoter of gene <span class="math notranslate nohighlight">\(i\)</span> then this promoter is no more free for binding. Thus, the activatory effect is restricted with a number of different promoter binding sites for a particular gene what is reflected in the saturating functional form of the term.</p>
<p>You probably already guessed that <span class="math notranslate nohighlight">\(A\)</span> is a kind of system matrix by analogy with the previous case. In fact now we are ready to formulate a concept of <strong>network</strong> more precisely. Gene regulatory network under our scope is determined with relations written in the adjacency matrix <span class="math notranslate nohighlight">\(A\)</span> which just way to represent a graph. This matrix has a shape of <span class="math notranslate nohighlight">\(n\times n\)</span> nodes, where node is a particular gene. Each pair of nodes are coupled with an edge. If such coupling exists, i.e. gene <span class="math notranslate nohighlight">\(i\)</span> affects gene <span class="math notranslate nohighlight">\(j\)</span>, then <span class="math notranslate nohighlight">\(A_{ij}=1\)</span>. In case of the absense of a coupling - <span class="math notranslate nohighlight">\(A_{ij}=0\)</span>. One can say that matrix <span class="math notranslate nohighlight">\(A\)</span> defines <strong>topology</strong> of the network.</p>
<p>Let’s consider the simple case of <span class="math notranslate nohighlight">\(n=2\)</span> genes by plotting the dynamics:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_nonlinear_ODE</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">:</span> <span class="o">-</span><span class="n">B</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">A</span> <span class="o">@</span> <span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="p">))</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="n">x</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span> <span class="c1">#Forward Euler integration</span>
        <span class="n">x</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span>

<span class="c1">### SYSTEM MATRIX</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> 
              <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span> <span class="c1">#genes regulate themselves and each other</span>
<span class="c1">###</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">#degradation constant</span>

<span class="n">m</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># number of time steps</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
<span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span> <span class="c1">#initial condition</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">compute_nonlinear_ODE</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>


<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mf">5.5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Relative abundance&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Time trajectory&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;gene 1&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;gene 2&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/system_resilience_36_0.png" src="../_images/system_resilience_36_0.png" />
</div>
</div>
<p>There is something special in this model in a comparison with the previous. We can obtain a non-zero stationary (<span class="math notranslate nohighlight">\(t\to \infty\)</span>) solution for both genes if they cooperate enough. This means that gene regulatory network remains active for a long time until, for example, some perturbation occurs.</p>
<p>Let’s explore the stability properties of this system. As it was done for one-dimensional systems, we can start with computing fixed points for function <span class="math notranslate nohighlight">\(f\)</span>. The only difference is that now the <span class="math notranslate nohighlight">\(f\)</span> is a vector function of <span class="math notranslate nohighlight">\(x = [x_1, x_2]^T\)</span>:</p>
<div class="math notranslate nohighlight">
\[
    \frac{dx}{dt} = f(x)
\]</div>
<p>The fixed points then can be found from the equation:</p>
<div class="math notranslate nohighlight">
\[
    f(x) = 0
\]</div>
<p>or more explicitly:</p>
<div class="math notranslate nohighlight" id="equation-eq-mm-right">
<span class="eqno">(13.11)<a class="headerlink" href="#equation-eq-mm-right" title="Permalink to this equation">#</a></span>\[\begin{split}
    \begin{cases}
        f_1 = -Bx_1 + A_{11}\frac{x_1}{x_1 + 1} + A_{12}\frac{x_2}{x_2 + 1} = 0 \\
        f_2 = -Bx_2 + A_{21}\frac{x_1}{x_1 + 1} + A_{22}\frac{x_2}{x_2 + 1} = 0
    \end{cases}
\end{split}\]</div>
<p>It is not easy to get the solution in a closed form (try it), but we can try to <em>guess</em> at least one solution: <span class="math notranslate nohighlight">\(x=[0, 0]^T\)</span> which is true for any set of parameters. The plot above hints us that <span class="math notranslate nohighlight">\(x=[1, 1]^T\)</span> is also a stationary solution (check it), but only for a specific set of parameters, namely, <span class="math notranslate nohighlight">\(B=1\)</span> and matrix <span class="math notranslate nohighlight">\(A\)</span> consisting of ones. We will check their stability. It turns out we already know how to do that (remember <a class="reference internal" href="#stability-intuition"><span class="std std-ref">Stability intuition</span></a>) with a linearization of function <span class="math notranslate nohighlight">\(f\)</span>. We need only to generalize the techinique to multidimensional case. It is time to get acquainted with <strong>Hartman-Grobman theorem</strong> (we use its interpretation from <span id="id5">[]</span>):</p>
<p>To determine the stability of an equilibrium point of a vector ﬁeld <span class="math notranslate nohighlight">\(f : R^n \to R^n\)</span>:</p>
<ol class="simple">
<li><p>Find the linearization of <span class="math notranslate nohighlight">\(f\)</span> at the equilibrium point, which is the Jacobian.</p></li>
<li><p>Determine the stability of this linear function, using the method of eigenvalues.</p></li>
<li><p>Provided no eigenvalue is zero or has zero real part, conclude that the equilibrium point of
the nonlinear system is qualitatively similar to that of its linearization.</p></li>
</ol>
<p>Following this guidance, we need to find Jacobian first which is a full analog of <span class="math notranslate nohighlight">\(\lambda\)</span> coefficient for multidimensional case:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    J = 
    \begin{bmatrix}
        \frac{\partial f_1}{\partial x_1} &amp; \frac{\partial f_1}{\partial x_2} \\
        \frac{\partial f_2}{\partial x_1} &amp; \frac{\partial f_2}{\partial x_2} 
    \end{bmatrix} = 
    \begin{bmatrix}
        \frac{A_{11}}{(x_1 + 1)^2} - B &amp; \frac{A_{12}}{(x_2 + 1)^2} \\
        \frac{A_{21}}{(x_1 + 1)^2} &amp; \frac{A_{22}}{(x_2 + 1)^2} - B
    \end{bmatrix}
\end{split}\]</div>
<p>Estimate Jacobian in fixed points (remember that we need to substitute parameters <span class="math notranslate nohighlight">\(\theta = \{A_{ij}=1, B=1\}\)</span> for point <span class="math notranslate nohighlight">\(x=[1, 1]^T\)</span>):</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    J(0,0) = 
    \begin{bmatrix}
        A_{11} - B &amp; A_{12} \\
        A_{21} &amp; A_{22} - B
    \end{bmatrix}; \ 
    J(1,1|\theta) = 
    \begin{bmatrix}
        -\frac{3}{4} &amp; \frac{1}{4} \\
        \frac{1}{4} &amp; -\frac{3}{4}
    \end{bmatrix}
\end{split}\]</div>
<p>Consider the second case. By applying the method of eigenvalues learned in the previous paragraph have <span class="math notranslate nohighlight">\(\lambda_1=-0.5\)</span> and <span class="math notranslate nohighlight">\(\lambda_2=-1\)</span>. At the last step of Hartman-Grobman procedure, we use the fact that both eigenvalues are non-zero and negative. Hence, we can conclude that system has a stable behaviour around fixed point <span class="math notranslate nohighlight">\(x=[1, 1]^T\)</span>.</p>
<div class="dropdown admonition">
<p class="admonition-title">Exercise</p>
<p>Explore the stability of the system in a vicinity of point <span class="math notranslate nohighlight">\(x=[0, 0]^T\)</span>. Obtain general expression for eigenvalues.</p>
</div>
<p>The limitations of Hartman-Grobman theorem follows from its requirement. The theorem fails to predict class of stability for a fixed point in case of some of eigenvalues are zero or have zero real part. The problem is that zero eigenvalues means the sytem is in critical state and any tiny change in the system parameters may switch it to the unstable regime. The problem becomes even harder when we work with really high-dimensional systems. We would like to develop the general framework for evaluating system resilience, i.e. how far its parameters from point of bifurcation, where the system dynamics dies.</p>
</section>
<section id="universality-and-resilience">
<h3><a class="toc-backref" href="#id23"><span class="section-number">13.3.3. </span>Universality and resilience</a><a class="headerlink" href="#universality-and-resilience" title="Permalink to this headline">#</a></h3>
<p>In this section, we will demonstrate exactly how complex systems can be reduced to simple universal laws. We will see that the system that we considered above obeys a universal law that allows us to investigate its stability and resilience (yes, in this section we will consider the difference between these two concepts). We will follow a framework developed in the paper <span id="id6">[]</span> which in short can be formulated as following. Consider a system consisting of <span class="math notranslate nohighlight">\(n\)</span> components (nodes of a network) <span class="math notranslate nohighlight">\(x = (x_1, ..., x_n)^T\)</span>. The components of systems evolves according to the following general system of non-linear (in general) differential equations:</p>
<div class="math notranslate nohighlight" id="equation-eq-gao-general">
<span class="eqno">(13.12)<a class="headerlink" href="#equation-eq-gao-general" title="Permalink to this equation">#</a></span>\[
    \frac{dx_i}{dt} = F(x_i) + \sum_{j=1}^n A_{ij}G(x_i, x_j)
\]</div>
<p>The first term on the right-hand side of the equation describes the self-dynamics of each component, while the second term describes the interactions between component <span class="math notranslate nohighlight">\(i\)</span> and its interacting partners. The nonlinear functions <span class="math notranslate nohighlight">\(F(x_i)\)</span> and <span class="math notranslate nohighlight">\(G(x_i, x_j)\)</span> represent the dynamical laws that govern the system’s components, while the weighted connectivity matrix <span class="math notranslate nohighlight">\(A_{ij} &gt; 0\)</span> captures the positive interactions between the nodes. This is quite general form of non-linear equation and a lot of multidimensional dynamical systems can be described with it.</p>
<p>As we learned earlier, the stability of a system can be compromised if many system parameters are changed. This distinguishes multidimensional systems (networks) from one-dimensional ones they have a definite topology of interaction network. The brilliant discovery of the paper under consideration is that we can compute universal number which characterize a total network topology of equation <a class="reference internal" href="#equation-eq-gao-general">(13.12)</a>. The main result of the paper is that we can rewrite <a class="reference internal" href="#equation-eq-gao-general">(13.12)</a> in one-dimensional form as follows:</p>
<div class="math notranslate nohighlight" id="equation-eq-gao-1d">
<span class="eqno">(13.13)<a class="headerlink" href="#equation-eq-gao-1d" title="Permalink to this equation">#</a></span>\[
    \frac{dx_{eff}}{dt} = F(x_{eff}) + \beta_{eff}G(x_{eff}, x_{eff})
\]</div>
<p>where <span class="math notranslate nohighlight">\(x_{eff}\)</span> - is an effective dynamic component representing “average” dynamics of the whole system, and <span class="math notranslate nohighlight">\(\beta_{eff}\)</span> - is a effective topological characteristic of the network which is actually a macroscopic description of <span class="math notranslate nohighlight">\(n^2\)</span> microscopic parameters of matrix <span class="math notranslate nohighlight">\(A\)</span>. They can be computed as follows:</p>
<div class="math notranslate nohighlight">
\[
    x_{eff} = \frac{\mathbf{1}^T Ax}{\mathbf{1}^TA\mathbf{1}} = \frac{\langle s^{out}x \rangle}{\langle s \rangle};\ 
    \beta_{eff} = \frac{\mathbf{1}^T As^{in}}{\mathbf{1}^TA\mathbf{1}} = \frac{\langle s^{out}s^{in} \rangle}{\langle s \rangle}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{1}\)</span> is a vector of ones of length <span class="math notranslate nohighlight">\(n\)</span>; <span class="math notranslate nohighlight">\(s^{in}\)</span> - vector of in-degrees of matrix <span class="math notranslate nohighlight">\(A\)</span>, i.e. sum of column elements; <span class="math notranslate nohighlight">\(s^{out}\)</span> - vector of out-degrees of matrix <span class="math notranslate nohighlight">\(A\)</span>, i.e. sum of row elements. The angle brackets <span class="math notranslate nohighlight">\(\langle . \rangle\)</span> means averaging across vector elements (don’t worry the code below will make things easier). For example, <span class="math notranslate nohighlight">\(\langle s \rangle\)</span> means averaging across all degree elements of matrix <span class="math notranslate nohighlight">\(A\)</span> (in-degree or out-degree), actually <span class="math notranslate nohighlight">\(\langle s^{in} \rangle=\langle s^{out} \rangle=\langle s \rangle\)</span>.</p>
<p>So, let’s apply the framework to already familiar 2-dimensional task, namely:</p>
<div class="math notranslate nohighlight">
\[
    \frac{dx_{eff}}{dt} = -Bx_{eff} + \beta_{eff}\frac{x_{eff}}{1 + x_{eff}}
\]</div>
<p>Remember that <span class="math notranslate nohighlight">\(B=1\)</span> and <span class="math notranslate nohighlight">\(A\)</span> is a matrix of ones, then have:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> 
              <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">vec1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">sout</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1">#out-degrees </span>
<span class="n">sin</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#in-degrees </span>
<span class="n">savg</span> <span class="o">=</span> <span class="p">(</span><span class="n">vec1</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">A</span> <span class="o">@</span> <span class="n">vec1</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">/</span> <span class="n">n</span> <span class="c1"># &lt;s&gt;</span>
<span class="n">beff</span> <span class="o">=</span> <span class="p">(</span><span class="n">sout</span> <span class="o">*</span> <span class="n">sin</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">/</span> <span class="n">savg</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;beta_eff =&quot;</span><span class="p">,</span> <span class="n">beff</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>beta_eff = 2.0
</pre></div>
</div>
</div>
</div>
<p>Then obtain a separable differential equation (which has an analytical solution!).</p>
<div class="math notranslate nohighlight">
\[
    \frac{dx_{eff}}{dt} = -x_{eff} + 2\frac{x_{eff}}{1 + x_{eff}}
\]</div>
<p>You probably already see that this equation has a stable non-zero solution. But how can we deny ourselves the pleasure of exploring it?</p>
<p>The fixed points are:</p>
<div class="math notranslate nohighlight" id="equation-eq-universal-params">
<span class="eqno">(13.14)<a class="headerlink" href="#equation-eq-universal-params" title="Permalink to this equation">#</a></span>\[
    x^*_1 = 0;\ x^*_2 = \frac{\beta_{eff}}{B} - 1 = 1
\]</div>
<p>The stability parameter <span class="math notranslate nohighlight">\(\lambda\)</span> is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \lambda = -B + \frac{\beta_{eff}}{(1 + x^*)^2} \\
    \lambda|_{x^*=0} = 1; \ \lambda|_{x^*=1} = -0.5
\end{split}\]</div>
<p>Indeed, it works properly! We had a stable point at <span class="math notranslate nohighlight">\(x=[1,1]^T\)</span> and unstable at <span class="math notranslate nohighlight">\(x=[0,0]^T\)</span> in multidimensional case. As result, their one dimensional analogs have the proper stability property. Someone will say: “Well, but what about really multidimensional systems?”</p>
<p>We will use the transcriptional regulatory network in yeast proposed in <span id="id7">[]</span>. The full network contains 4441 nodes but we restricted it only to a number of 157 transcription factors (i.e. having non-zero out-degree (non-zero sum of columns) in the original matrix). We attached a file with the data to a repository of this book. Let’s take a look at it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#load numpy data array</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;data/yeast.npy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Gene-Gene interaction matrix&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">spy</span><span class="p">(</span><span class="n">A</span><span class="p">);</span> <span class="c1">#non-zero values are black pixels</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/system_resilience_42_0.png" src="../_images/system_resilience_42_0.png" />
</div>
</div>
<p>One can see that that this is actually a sparse matrix. Look at the dynamics of some of its components starting with initial conditions <span class="math notranslate nohighlight">\(x(0)=[2, ..., 2]^T\)</span>. We also compute <span class="math notranslate nohighlight">\(x_{eff}\)</span> and <span class="math notranslate nohighlight">\(\beta_{eff}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_nonlinear_ODE</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">:</span> <span class="o">-</span><span class="n">B</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">A</span> <span class="o">@</span> <span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="p">))</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="n">x</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span> <span class="c1">#Forward Euler integration</span>
        <span class="n">x</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span>

<span class="k">def</span> <span class="nf">compute_eff</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">vec1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">sout</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">sin</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">savg</span> <span class="o">=</span> <span class="p">(</span><span class="n">vec1</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">A</span> <span class="o">@</span> <span class="n">vec1</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">/</span> <span class="n">n</span>
    <span class="n">xeff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sout</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">savg</span>
    <span class="n">beff</span> <span class="o">=</span> <span class="p">(</span><span class="n">sout</span> <span class="o">*</span> <span class="n">sin</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">/</span> <span class="n">savg</span>
    <span class="k">return</span> <span class="n">xeff</span><span class="p">,</span> <span class="n">beff</span>

<span class="c1">### SYSTEM MATRIX</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;data/yeast.npy&#39;</span><span class="p">)</span> <span class="c1">#gene regulatory network</span>
<span class="c1">###</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">#degradation constant</span>

<span class="n">n</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">m</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># number of time steps</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
<span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="mf">2.</span> <span class="c1">#same initial condition</span>
<span class="c1">#x0 = np.random.random(n)*3 #random initial condition</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">compute_nonlinear_ODE</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="n">xeff</span><span class="p">,</span> <span class="n">beff</span> <span class="o">=</span> <span class="n">compute_eff</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="c1">#compute effective dynamics and topological characteristic</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;beta_eff =&quot;</span><span class="p">,</span> <span class="n">beff</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mf">5.5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Relative abundance&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Time trajectory&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">136</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;gene </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">xeff</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$x_</span><span class="si">{eff}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$&lt;x&gt;$&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>beta_eff = 3.446938775510204
</pre></div>
</div>
<img alt="../_images/system_resilience_44_1.png" src="../_images/system_resilience_44_1.png" />
</div>
</div>
<p>We observe different dynamics for genes. Some of them are upregulated by others and coverge to a stationary value, others are do not have positive regulation and exhibit a decay trajectory with a rate of <span class="math notranslate nohighlight">\(B\)</span>. Nevertheless we call this dynamics is stable and non-zero because the average dynamics is not equal to zero (<span class="math notranslate nohighlight">\(\langle x\rangle \neq 0\)</span>). Note that effective dynamics <span class="math notranslate nohighlight">\(x_{eff}\)</span> is not equal to the average one due to slightly different weighing.</p>
<p>The second interesting result of the <span id="id8">[]</span> paper is that topological characteristic <span class="math notranslate nohighlight">\(\beta_{eff}\)</span> can be decomposed in well-interpretable topological properties. Let’s write the following relation:</p>
<div class="math notranslate nohighlight" id="equation-eq-network-topology">
<span class="eqno">(13.15)<a class="headerlink" href="#equation-eq-network-topology" title="Permalink to this equation">#</a></span>\[
    \beta_{eff} = \langle s\rangle + SH
\]</div>
<p>We already know <span class="math notranslate nohighlight">\(\langle s \rangle\)</span> is a average degree of elements, but it has another name - <strong>density</strong> of a network; <span class="math notranslate nohighlight">\(S\)</span> represents the <strong>symmetry</strong> of network <span class="math notranslate nohighlight">\(A\)</span>, and <span class="math notranslate nohighlight">\(H\)</span> represents <strong>heterogeneity</strong>. They can be computed as follows:</p>
<div class="math notranslate nohighlight">
\[
    S = \frac{\langle s^{in}s^{out} \rangle - \langle s^{in} \rangle\langle s^{out} \rangle}{\sigma_{in}\sigma_{out}};\ 
    H = \frac{\sigma_{in}\sigma_{out}}{\langle s \rangle}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma_{in}\)</span> and <span class="math notranslate nohighlight">\(\sigma_{out}\)</span> are standard deviations of elements of vectors <span class="math notranslate nohighlight">\(s^{in}\)</span> and <span class="math notranslate nohighlight">\(s^{out}\)</span> correspondingly.</p>
<p>To develop a better intuition on <strong>density</strong>, <strong>symmetry</strong>, and <strong>heterogeneity</strong> of a network, look at the picture from the original paper:</p>
<figure class="align-default" id="topology">
<a class="reference internal image-reference" href="../_images/topology_properties.png"><img alt="../_images/topology_properties.png" src="../_images/topology_properties.png" style="width: 700px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 13.4 </span><span class="caption-text">The topological characteristics of a network.</span><a class="headerlink" href="#topology" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The density property is quite self-explainable - it is just an average number of in/out degrees in a network. The symmetry means that most of nodes have bi-directed edges to each other. An asymmetric network is one where nodes with a large in-degree tend to have a small out-degree. The large heterogeneity means that some nodes may have large in/out degrees and others - small. In the network with small heterogeneity, all nodes have almost equal degrees. Let’s compute them and check that hey are actually sum into <span class="math notranslate nohighlight">\(\beta_{eff}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_topological_characteristics</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">vec1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">sout</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">sin</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">sout_avg</span> <span class="o">=</span> <span class="n">sout</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">sin_avg</span> <span class="o">=</span> <span class="n">sin</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">savg</span> <span class="o">=</span> <span class="p">(</span><span class="n">vec1</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">A</span> <span class="o">@</span> <span class="n">vec1</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">/</span> <span class="n">n</span> <span class="c1">#density</span>
    <span class="n">S</span> <span class="o">=</span> <span class="p">((</span><span class="n">sout</span> <span class="o">*</span> <span class="n">sin</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="n">n</span> <span class="o">-</span> <span class="n">sin_avg</span> <span class="o">*</span> <span class="n">sout_avg</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">sin</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">sout</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span> <span class="c1">#symmetry</span>
    <span class="n">H</span> <span class="o">=</span> <span class="p">(</span><span class="n">sin</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">sout</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="n">savg</span> <span class="c1">#heterogenity</span>
    <span class="k">return</span> <span class="n">savg</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">H</span>

<span class="n">savg</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">compute_topological_characteristics</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&lt;s&gt; = &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">savg</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;S =&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;H =&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;beta_eff == &lt;s&gt; + SH:&#39;</span><span class="p">,</span> <span class="n">beff</span> <span class="o">==</span> <span class="n">savg</span> <span class="o">+</span> <span class="n">S</span> <span class="o">*</span> <span class="n">H</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;s&gt; =  3.121
S = 0.083
H = 3.938
beta_eff == &lt;s&gt; + SH: True
</pre></div>
</div>
</div>
</div>
<p>These nice network characteristics confer us an instrument for improvement <span class="math notranslate nohighlight">\(\beta_{eff}\)</span> value. You remember expression <a class="reference internal" href="#equation-eq-universal-params">(13.14)</a>? It is time to plot bifurcation diagram!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">beta0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">beta1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">x_star0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">beta0</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">x_star1</span> <span class="o">=</span> <span class="n">beta1</span> <span class="o">/</span> <span class="n">B</span> <span class="o">-</span> <span class="mi">1</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\beta_</span><span class="si">{eff}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x^*_</span><span class="si">{eff}</span><span class="s1">}$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Bifurcation diagram&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">beta0</span><span class="p">,</span> <span class="n">x_star0</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">beta1</span><span class="p">,</span> <span class="n">x_star1</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Stable&#39;</span><span class="p">,</span> <span class="s1">&#39;Unstable&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\beta_c$&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/system_resilience_48_0.png" src="../_images/system_resilience_48_0.png" />
</div>
</div>
<p>We have stable non-zero solution while <span class="math notranslate nohighlight">\(\beta_{eff} &gt; \beta_c\)</span>. The critical value of <span class="math notranslate nohighlight">\(\beta_c=1\)</span> is a root of the second expression in <a class="reference internal" href="#equation-eq-universal-params">(13.14)</a>. Of course, crossing the <span class="math notranslate nohighlight">\(\beta_c\)</span> from right to left leads to a bifurcation and a cell dies. What else interesting about value of <span class="math notranslate nohighlight">\(\beta_{eff}\)</span> is that it represents the reserve of <strong>resilience</strong> in the system. If some topological perturbation occurs (e.g. some edges are removed) then it is better to have larger value <span class="math notranslate nohighlight">\(\beta_{eff}\)</span>, otherwise the system is under risk of a killing bifurcation.</p>
<p>How can we improve the resilience? From the equation <a class="reference internal" href="#equation-eq-network-topology">(13.15)</a> we see several options:</p>
<ol class="simple">
<li><p>Make the network more dense;</p></li>
<li><p>If <span class="math notranslate nohighlight">\(S\)</span> is negative - decrease its absolute value;</p></li>
<li><p>If <span class="math notranslate nohighlight">\(S\)</span> is positive - increase its absolute value;</p></li>
<li><p>Increase <span class="math notranslate nohighlight">\(H\)</span> if <span class="math notranslate nohighlight">\(S\)</span> is positive;</p></li>
<li><p>Decrease <span class="math notranslate nohighlight">\(H\)</span> if <span class="math notranslate nohighlight">\(S\)</span> is negative.</p></li>
</ol>
<p>Let’s follow the first case and consider how random weights perturbation affects resilience on a bifurcation diagram.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_perturbed_network</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function for netwrok perturbation</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">A_pert</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">nzidx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">A_pert</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">:</span>
        <span class="n">n_pert</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nzidx</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p</span><span class="p">))</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nzidx</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">n_pert</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">A_pert</span><span class="p">[</span><span class="n">nzidx</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nzidx</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">zidx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">A_pert</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">n_pert</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nzidx</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">))</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">zidx</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">n_pert</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">A_pert</span><span class="p">[</span><span class="n">zidx</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">zidx</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">A_pert</span>

<span class="n">k</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1">#number of repetitions</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.15</span><span class="p">,</span> <span class="mf">1.35</span><span class="p">,</span> <span class="mf">1.65</span><span class="p">,</span> <span class="mf">1.9</span><span class="p">]:</span>
    <span class="n">beta_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">x_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
        <span class="n">A_pert</span> <span class="o">=</span> <span class="n">get_perturbed_network</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">compute_nonlinear_ODE</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">A_pert</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">xeff</span><span class="p">,</span> <span class="n">beff</span> <span class="o">=</span> <span class="n">compute_eff</span><span class="p">(</span><span class="n">A_pert</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="c1">#compute effective dynamics and topological characteristic</span>
        <span class="n">beta_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">beff</span><span class="p">)</span>
        <span class="n">x_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xeff</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">beta_list</span><span class="p">,</span> <span class="n">x_list</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;p=</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> 

<span class="n">beta0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">beta1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">x_star0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">beta0</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">x_star1</span> <span class="o">=</span> <span class="p">(</span><span class="n">beta1</span> <span class="o">/</span> <span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\beta_</span><span class="si">{eff}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x^*_</span><span class="si">{eff}</span><span class="s1">}$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Bifurcation diagram&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">beta0</span><span class="p">,</span> <span class="n">x_star0</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">beta1</span><span class="p">,</span> <span class="n">x_star1</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/system_resilience_50_0.png" src="../_images/system_resilience_50_0.png" />
</div>
</div>
<p>The colored points on a bifurcation diagram are values of <span class="math notranslate nohighlight">\(x_{eff}\)</span> computed from the simulations of multidimensional systems at different perturbation rates <span class="math notranslate nohighlight">\(p\)</span>. If <span class="math notranslate nohighlight">\(p&lt;0\)</span> the perturbation rate means how much non-zero weights in matrix <span class="math notranslate nohighlight">\(A\)</span> shoul be left after the perturbation, else, if <span class="math notranslate nohighlight">\(p&gt;=1\)</span> the perturbation rate means how much edges should be added in matrix <span class="math notranslate nohighlight">\(A\)</span>. Hence, by incerasing <span class="math notranslate nohighlight">\(p\)</span> we increase density of a network. Why do the points do not go strictly with the theoretical prediction, but move away from the theoretical curve, and then again approach it? The reason is a <strong>sparcity</strong>. The developed theory fails to predict a stationary behavior of too sparse networks because nodes in such networks interact weakly. However, more dense network are predictable and we can use all the fruits of the original theory (or develop something better?). In any case, we see that the theory works correctly and provides a nice one-dimensional approximation for the network providing us a resilience coefficient <span class="math notranslate nohighlight">\(\beta_{eff}\)</span> which we can directly apply in practice.</p>
<p>But wait a minute, have we come all this way through multi-dimensional dynamical systems to get back to a one-dimensional coefficient? You see that the answer is both yes and no. One-dimensional mean-field approximations are an amazing theoretical result, but not all models can achieve such an approximation. In general, we must be prepared to integrate multidimensional systems as is. It is important to recall that everything we have studied so far concerns only deterministic dynamical systems. The world is much more complicated …</p>
<div class="dropdown admonition">
<p class="admonition-title">Exercise</p>
<p>Repeat all the steps of analysis with model <span class="math notranslate nohighlight">\(\frac{dx_i}{dt} = -Bx_i + \sum^n_{j=1}A_{ij}\frac{x^2_j}{x^2_j + 1}\)</span>. Draw bifurcation diagram. What specific you can say about behavior around <span class="math notranslate nohighlight">\(\beta_c\)</span>?</p>
</div>
</section>
<section id="the-remark-on-complex-system-aging">
<h3><a class="toc-backref" href="#id24"><span class="section-number">13.3.4. </span>The remark on complex system aging</a><a class="headerlink" href="#the-remark-on-complex-system-aging" title="Permalink to this headline">#</a></h3>
<p>From the previous model, we saw that there are many ways to reduce the resilience of the system to such an extent that the system (organism) can no longer cope with the next perturbation and a catastrophic bifurcation occurs. The hypothesis of aging as a complex system in which resilience decreases is not very optimistic, in the sense that it immediately follows that aging is mostly stochastic. However, the optimistic side of this hypothesis is that if we can find a systemic effect on the body that improves its resilience, then we may well be able to avoid aging. Thus, we could improve the dynamic model by supplementing it with the mechanisms of action of various metabolites on the gene regulatory network and get a playground for testing drugs that have a systemic effect on a body resilience. In the end, it’s possible that the complex system model is simply wrong and we need to look for something better.</p>
</section>
</section>
<section id="critical-slowing-down">
<h2><a class="toc-backref" href="#id25"><span class="section-number">13.4. </span>Critical slowing down</a><a class="headerlink" href="#critical-slowing-down" title="Permalink to this headline">#</a></h2>
<p>“The bifurcation theory predicts that approaching to a critical transition boundary (aka tipping point) is accompained with the system critical slowing down and an increase in variance and temporal autocorrelations of system state variable” - do your remember this citation from the previous chapter? In this section we discuss the explicit mathematical background of the phenomenon. We also introduce one additional instrument which is widely used in dynamical modelling, namely, stochasticity. In this section we will mostly rely on the theoretical results form the paper <span id="id9">[<a class="reference internal" href="complex_systems.html#id98" title="Marten Scheffer, Jordi Bascompte, William A Brock, Victor Brovkin, Stephen R Carpenter, Vasilis Dakos, Hermann Held, Egbert H Van Nes, Max Rietkerk, and George Sugihara. Early-warning signals for critical transitions. Nature, 461(7260):53–59, 2009. URL: https://doi.org/10.1038/nature08227.">Scheffer <em>et al.</em>, 2009</a>]</span>.</p>
<section id="introduce-a-stochastic-model">
<h3><a class="toc-backref" href="#id26"><span class="section-number">13.4.1. </span>Introduce a stochastic model</a><a class="headerlink" href="#introduce-a-stochastic-model" title="Permalink to this headline">#</a></h3>
<p>In contrast to the previous section, we return to the one dimensional models, in addition, we understood that some of multidimensional models can be reduced to one-dimensional allowing to analyze system resilience in more compact form. We start with a new model which is a combination of what we learned above:</p>
<div class="math notranslate nohighlight" id="equation-eq-slowing-down">
<span class="eqno">(13.16)<a class="headerlink" href="#equation-eq-slowing-down" title="Permalink to this equation">#</a></span>\[
    \dot{x} = x(1 - \frac{x}{K}) - c \frac{x^2}{1 + x^2} + \sigma \epsilon
\]</div>
<p>We have seen all the parts of this equation. The first quadratic term describes the growth of something with a carrying capacity <span class="math notranslate nohighlight">\(K\)</span>. The second term is similar to what we have seen in the previous section (especially if you did the exercise), it describes some saturating removal of something from the system with rate <span class="math notranslate nohighlight">\(c\)</span>. For example, this model can describe a number of senescent cells in the organism which has a limited capacity for the growth and they are removed by the immune system. The last term represents the noise in the growth condition by a plephora of random factors which we do not know explicitly and just model them by random gaussian noise <span class="math notranslate nohighlight">\(\epsilon \sim \mathbf{N}(0, 1)\)</span> with average <span class="math notranslate nohighlight">\(0\)</span> and standard deviation of <span class="math notranslate nohighlight">\(1\)</span>. After multiplication with <span class="math notranslate nohighlight">\(\sigma\)</span> the standard deviation is scaled. The presented stochastic model is simple and do not require a lot of specific knowledge for modeling as we will see it below.</p>
<div class="dropdown admonition">
<p class="admonition-title">Exercise</p>
<p>Compute the potential function for the deterministic part of <a class="reference internal" href="#equation-eq-slowing-down">(13.16)</a>.</p>
</div>
</section>
<section id="slowing-down-intuition">
<h3><a class="toc-backref" href="#id27"><span class="section-number">13.4.2. </span>Slowing down intuition</a><a class="headerlink" href="#slowing-down-intuition" title="Permalink to this headline">#</a></h3>
<p>Critical slowing down arises in dynamical systems which undergoes changing in their parameters. If some parameter changes in such way that it moves the system to the bifurcation point (critical point), several interesting effects in actual dynamics can be observed. There are three such effects:</p>
<p>If the system is driven by stochastic force, the critical slowing down manifests itself in:</p>
<ol class="simple">
<li><p>Increase in variance of system variable;</p></li>
<li><p>Increase in autocorrelation of system variable;</p></li>
<li><p>Increase in cross-correlation between different system variables;</p></li>
</ol>
<p>We discuss the first and the second hallmarks of critical slowing down that can be easily observed in one-dimensional system. We will change the parameter <span class="math notranslate nohighlight">\(c\)</span> from the system above and move, therefore, system to the bifurcation. Below we write some code for simulating the equation <a class="reference internal" href="#equation-eq-slowing-down">(13.16)</a> and the potential function for the deterministic part of the equation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_nonlinear_SDE</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span>
    <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="o">/</span><span class="n">K</span><span class="p">)</span> <span class="o">-</span> <span class="n">c</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">n</span><span class="p">))</span>
    <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span> <span class="c1">#Forward Euler integration</span>
        <span class="n">eps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#N(0, 1)</span>
        <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">K</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span> <span class="o">*</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">eps</span> <span class="c1">#note about square root of dt</span>
    <span class="k">return</span> <span class="n">x</span>

<span class="n">V</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="o">-</span><span class="n">c</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">K</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span> <span class="c1">#potential function</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># number of integration steps</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="c1">#support for the potential function </span>
<span class="n">K</span> <span class="o">=</span> <span class="mf">10.</span> <span class="c1">#carrying capacity</span>
<span class="n">x0</span> <span class="o">=</span> <span class="mf">10.0</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">11</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">2.4</span><span class="p">]):</span> <span class="c1">#different removal rates (aka harvest rate)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">compute_nonlinear_SDE</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">V</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
    <span class="c1">#dynamics</span>
    <span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="p">:],</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Population size&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Dynamics, $\sigma_x=</span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">std</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="c1">##plot from the middle</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="p">:],</span> <span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="p">:],</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="c1">#potential</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Population size&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$V(x)$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Potential, $c=</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">);</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="c1">#correlation</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">:])[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x[i]$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$x[i+1]$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Correlation, r=</span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">:],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">);</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/system_resilience_57_0.png" src="../_images/system_resilience_57_0.png" />
</div>
</div>
<p>The upper plots show the actual system dynamics aroun equilibrium point under stochastic perturbations. Note that we observe dynamics from the moment <span class="math notranslate nohighlight">\(t=50\)</span>. Take a closer look! The dynamics in the right picture became a little smoother, the distances between the peaks are larger, and the range has increased. In contrast the dynamics on the left picture is more sharp and the range is smaller. In order to understand why this happens, you need to imagine the ball placed in the two potential landscapes depicted in the middle pictures. If the landscape is sharp, then the ball will quickly come to equilibrium, if the landscape is flat, then the ball will roll from side to side for a long time, until it finally converges to a minimum. Seriously, if you have a glass or metal ball and plates with different heights of sides at home - try it!</p>
<p>The first hallmark of a critical slowdown - an increase in variance can be seen in the headers to the top panels. The variance has really increased. We will demonstrate the second hallmark of a critical slowdown by correlating between neighboring values of <span class="math notranslate nohighlight">\(x\)</span> (instead of plotting a whole autocorrelation graph) - see the bottom plots on the panel. The correlation between neighboring values has indeed increased.</p>
<p>It is worth noting that there are also systems that may not show critical slowing down when approaching the bifurcation point. However, apparently, these systems are quite exotic and our search for signs of criticality can bear fruits with a high probability.</p>
</section>
<section id="construct-a-resilience-indicator-from-data">
<h3><a class="toc-backref" href="#id28"><span class="section-number">13.4.3. </span>Construct a resilience indicator from data</a><a class="headerlink" href="#construct-a-resilience-indicator-from-data" title="Permalink to this headline">#</a></h3>
<p>We have studied quite useful tools for data analysis. Can we use them to create an organism resilience indicator? The good resilience indicator should satisfy not only the all three properties mentioned above, but how one-dimensional variable can satisfy the third one? There is one way to do that by constructing a new latent variable from initial organism state variables. Moreover, the good resilience indicator is expected to be negatively correlated with age. How to deal with all of that? Let’s do it step by step.</p>
<p>First let’s get the real data of mouse complete blood count (CBC) analysis. We will use one prepared dataset from the <span id="id10">[]</span>. As authors mentioned, the samples were obtained from NIH Swiss male and female mice from Charles River Laboratories (Wilmington, MA) - please refer to the original paper for the details. We will use only one cohort of male mice to avoid batch effect.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#load the data</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/validation_data.csv&#39;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;MA0072_M&#39;</span><span class="p">]</span> <span class="c1">#filter only one male cohort</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;uid&#39;, &#39;sex&#39;, &#39;age&#39;, &#39;label&#39;, &#39;ba %&#39;, &#39;ba (k/ul)&#39;, &#39;bmi&#39;, &#39;bw&#39;, &#39;crp&#39;,
       &#39;dia&#39;, &#39;eo %&#39;, &#39;eo (k/ul)&#39;, &#39;flow&#39;, &#39;glu&#39;, &#39;gr %&#39;, &#39;gr (k/ul)&#39;, &#39;gs&#39;,
       &#39;hb (g/dl)&#39;, &#39;hct %&#39;, &#39;hr&#39;, &#39;ins&#39;, &#39;kc&#39;, &#39;ly %&#39;, &#39;ly (k/ul)&#39;,
       &#39;mch (pg)&#39;, &#39;mchc (g/dl)&#39;, &#39;mcv(fl)&#39;, &#39;mean&#39;, &#39;mo %&#39;, &#39;mo (k/ul)&#39;,
       &#39;mpv (fl)&#39;, &#39;ne %&#39;, &#39;ne (k/ul)&#39;, &#39;pct&#39;, &#39;pfi&#39;, &#39;plt (k/ul)&#39;,
       &#39;rbc (m/ul)&#39;, &#39;rdw %&#39;, &#39;retic %&#39;, &#39;retic (m/ul)&#39;, &#39;sys&#39;, &#39;tg&#39;, &#39;volume&#39;,
       &#39;wbc (k/ul)&#39;, &#39;dFI&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>The dataset contains a lot of fields describing different characteristics of mice. The detailed description of fields can be found <a class="reference external" href="https://static-content.springer.com/esm/art%3A10.1038%2Fs41467-022-34051-9/MediaObjects/41467_2022_34051_MOESM4_ESM.xlsx">here</a>.</p>
<p>Let’s consider only some of them:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># name of field (units):</span>
<span class="c1"># hb (g/dl) - hemoglobin</span>
<span class="c1"># rbc (m/ul) - red blood cell counts</span>
<span class="c1"># hct (%) - hematocrit</span>
<span class="c1"># age (weeks) - mouse age</span>
<span class="c1"># uid - mouse unique identifier</span>
<span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;hb (g/dl)&#39;</span><span class="p">,</span> <span class="s1">&#39;rbc (m/ul)&#39;</span><span class="p">,</span> <span class="s1">&#39;hct %&#39;</span><span class="p">]</span>
<span class="n">df</span><span class="p">[[</span><span class="s1">&#39;uid&#39;</span><span class="p">,</span> <span class="s1">&#39;sex&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">features</span><span class="p">]]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>uid</th>
      <th>sex</th>
      <th>age</th>
      <th>hb (g/dl)</th>
      <th>rbc (m/ul)</th>
      <th>hct %</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>233</th>
      <td>swiss-2036</td>
      <td>M</td>
      <td>109.0</td>
      <td>14.5</td>
      <td>8.55</td>
      <td>44.1</td>
    </tr>
    <tr>
      <th>230</th>
      <td>swiss-2036</td>
      <td>M</td>
      <td>66.0</td>
      <td>15.2</td>
      <td>8.75</td>
      <td>42.4</td>
    </tr>
    <tr>
      <th>207</th>
      <td>swiss-2027</td>
      <td>M</td>
      <td>81.0</td>
      <td>16.2</td>
      <td>9.30</td>
      <td>48.5</td>
    </tr>
    <tr>
      <th>280</th>
      <td>swiss-2128</td>
      <td>M</td>
      <td>66.0</td>
      <td>12.6</td>
      <td>7.56</td>
      <td>35.4</td>
    </tr>
    <tr>
      <th>260</th>
      <td>swiss-2072</td>
      <td>M</td>
      <td>94.0</td>
      <td>9.4</td>
      <td>4.11</td>
      <td>26.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot their distributions and correlations with age and each other</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">features</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/system_resilience_63_0.png" src="../_images/system_resilience_63_0.png" />
</div>
</div>
<p>All three characteristics have a high value of correlation - this is not surprisingly because all of them are related to the blood erythrocytes. However, their correlation is something that we need. We start with checking the third hallmark of criticality: variabels should show an increase in cross correlation with age. Let’s check it after data preprocessing where we first exclude all animals younger than 16 months. It is important because we have small amount of data where effects of organism growth can be prevalent over aging.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###Prepare data</span>
<span class="c1">#filtering out young mice</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">69</span><span class="p">]</span> <span class="c1">#older than 16 months</span>

<span class="c1">#remove outliers</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">features</span><span class="p">:</span>
    <span class="n">q_low</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
    <span class="n">q_hi</span>  <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.99</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">q_hi</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">q_low</span><span class="p">)]</span>

<span class="n">dff</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;uid&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="c1">#standard scaling features</span>
<span class="n">X</span> <span class="o">=</span> <span class="p">(</span><span class="n">dff</span><span class="p">[</span><span class="n">features</span><span class="p">]</span> <span class="o">-</span> <span class="n">dff</span><span class="p">[</span><span class="n">features</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">dff</span><span class="p">[</span><span class="n">features</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>We will use standard scaled data because we want no to work with side effects from different variances of variables. The below code calculates the cross correlations between pairs of selected variables at each age point.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#build cross-correlation plot</span>
<span class="n">pairs</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;hb (g/dl)&#39;</span><span class="p">,</span> <span class="s1">&#39;rbc (m/ul)&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;hb (g/dl)&#39;</span><span class="p">,</span> <span class="s1">&#39;hct %&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;rbc (m/ul)&#39;</span><span class="p">,</span> <span class="s1">&#39;hct %&#39;</span><span class="p">]]</span>
<span class="n">ages</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">dff</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">:</span>
    <span class="n">cors</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">ages</span><span class="p">:</span>
        <span class="c1"># compute pairwise correlations between variables at each age</span>
        <span class="n">cor</span> <span class="o">=</span> <span class="n">dff</span><span class="p">[</span><span class="n">dff</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">a</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;uid&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span> <span class="c1">#&lt;- method for pairwise corr-s</span>
        <span class="n">cors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cor</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ages</span><span class="p">,</span> <span class="n">cors</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1"> vs </span><span class="si">{</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Pearson $r$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Age, weeks&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/system_resilience_67_0.png" src="../_images/system_resilience_67_0.png" />
</div>
</div>
<p>Not bad! The variables pass one of the requirements. The cross correlation increase for all pairs.</p>
<p>Next we construct the unite latent variable from these three. For that it is convenient to use principal component (PC) scores as a result of principal component analysis (PCA). Since the variables are highly correlated with each other you may think about resulting <span class="math notranslate nohighlight">\(PC_1\)</span> scores as of “mean” of vector variables (we will include clarifications on PCA in future versions of the book).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">linregress</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">tmp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="o">*</span><span class="n">p</span><span class="o">.</span><span class="n">tolist</span><span class="p">()],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pca1&#39;</span><span class="p">,</span> <span class="s1">&#39;pca2&#39;</span><span class="p">,</span> <span class="s1">&#39;pca3&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dff</span><span class="p">[[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;uid&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Exercise</p>
<p>Plot the first principal component scores (<code class="docutils literal notranslate"><span class="pre">z[:,</span> <span class="pre">0]</span></code>) along with the selected data variables. Plot also average vector of variables. Compute all pairwise correlations. Make sure the <span class="math notranslate nohighlight">\(PC_1\)</span> looks like average.</p>
</div>
<p>Next, we need to check that resulting latent variable is correlated with age, we can just fit a linear model to check this.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#fit linear regression</span>
<span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_corr</span><span class="p">,</span> <span class="n">pval</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="o">=</span> <span class="n">linregress</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">],</span> <span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;pca1&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Results of linear regression:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; slope = </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2"> pearson r = </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">r_corr</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2"> P-value = </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">pval</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Results of linear regression:
 slope = 0.035
 pearson r = 0.321
 P-value = 0.0133
</pre></div>
</div>
</div>
</div>
<p>Indeed, we obtained a significant (at the level of 0.05) positive correlation with age. Let’s construct a nice plot from <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> package.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;pca1&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tmp</span><span class="p">,</span>  <span class="n">x_ci</span><span class="o">=</span><span class="s1">&#39;sd&#39;</span><span class="p">,</span> <span class="n">scatter</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;$p = </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">intercept</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1"> + </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s1">*age$&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$p=PCA_1$&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/system_resilience_73_0.png" src="../_images/system_resilience_73_0.png" />
</div>
</div>
<p>This looks like what we sought. The function <code class="docutils literal notranslate"><span class="pre">regplot</span></code> computes variances at each level of age and these variances look increasing. Can we check this more explicitly with some test? Instead of telling long story about <strong>heteroskedasticity</strong> we just propose to you to compute one additional linear regression. This is a linear regression of absolute residuals (from the previous regression) versus age. The intution behind is quite straightforward, if variance increases with age, then absolute residuals from regression fit should increase too. Let’s check:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_predict</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">slope</span> <span class="o">+</span> <span class="n">intercept</span>
<span class="n">abs_resid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;pca1&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">y_predict</span><span class="p">))</span>
<span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_corr</span><span class="p">,</span> <span class="n">pval</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="o">=</span> <span class="n">linregress</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">],</span> <span class="n">abs_resid</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Results of linear regression:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; slope = </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2"> pearson r = </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">r_corr</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2"> P-value = </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">pval</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Results of linear regression:
 slope = 0.028
 pearson r = 0.472
 P-value = 0.0002
</pre></div>
</div>
</div>
</div>
<p>It actually does! We obtained positive and significant correlation between residuals and age. Thus, we satisfied the second requirement: the increase in variance with age. The last requirement is an increase in autocorrelation.</p>
<p>There is one big problem in all computational aging biology domain: too few <strong>longitudinal data</strong>. Longitudinal data is a just multiple observations of the same organism in the same conditions across time. Unfortunately, most of the biological studies require killing an organism to take a sample. It is not so easy to take a blood sample and save life of a tiny mouse. And, of course, it is not cheap. In our dataset, however we have a few longitudinal points, let’s look at them:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#group data by mouse id</span>
<span class="n">long</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;uid&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">()[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span>
<span class="n">longmice</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="n">tmp</span><span class="p">[</span><span class="s1">&#39;uid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">long</span><span class="p">[</span><span class="n">long</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)]</span>

<span class="c1">#Look at longitudinal mice data</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">longmice</span><span class="o">.</span><span class="n">uid</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="n">longmice</span><span class="p">[</span><span class="n">longmice</span><span class="o">.</span><span class="n">uid</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tt</span><span class="o">.</span><span class="n">age</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">pca1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">tt</span><span class="o">.</span><span class="n">age</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">pca1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.03</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Mouse ID&#39;</span><span class="p">)</span>   
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Age, weeks&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$z=PCA_1$&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/system_resilience_77_0.png" src="../_images/system_resilience_77_0.png" />
</div>
</div>
<p>From 2 to 4 points per mouse - not many. It is not enough to compute autocorrelation for a particular mouse at different ages, but we still try to compute autcorrelations between pairs of ages.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">pearsonr</span>
<span class="n">unique_ages</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">longmice</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="n">ages</span> <span class="o">=</span> <span class="p">[</span><span class="n">longmice</span><span class="p">[</span><span class="n">longmice</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">a</span><span class="p">][[</span><span class="s1">&#39;uid&#39;</span><span class="p">,</span> <span class="s1">&#39;pca1&#39;</span><span class="p">]]</span> 
            <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">unique_ages</span><span class="p">]</span>
<span class="n">deltas</span> <span class="o">=</span> <span class="p">[</span><span class="n">l</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;uid&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ages</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">ages</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>

<span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">deltas</span><span class="p">):</span>
    <span class="n">r</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">pearsonr</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;pca1_x&#39;</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;pca1_y&#39;</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ages:</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">unique_ages</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">unique_ages</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="si">}</span><span class="s2">; </span><span class="se">\</span>
<span class="s2">    n=</span><span class="si">{</span><span class="n">d</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">; r=</span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">; P-value=</span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ages:81-94;     n=11; r=0.841; P-value=0.0012
ages:94-109;     n=13; r=0.716; P-value=0.006
ages:109-130;     n=6; r=0.821; P-value=0.0452
</pre></div>
</div>
</div>
</div>
<p>Oops! Something went wrong. The correlation was higher at early ages then dropped and then increase again. This is not of what we expected. Why did it happen?</p>
<p>Possible reasons:</p>
<ul class="simple">
<li><p>Cross sectional calculation instead of longitudinal - we discussed this problem above. Cross sectional calculation introduce additional noise occuring from individual differences between mice.</p></li>
<li><p>Large delta interval - the time interval between observations is 11 weeks. The correlation might disappear at so long times.</p></li>
<li><p>Not appropriately chosen variables for the resilience indicator - very possible, but we already passed two tests and it correlates with age.</p></li>
</ul>
<p>Can we do better? Yes, but if we want to check the chosen three variables we need more data or some another way to combine these three variables or choose other set of variables. Let’s now assume that everything is okay.</p>
<p><strong>Finally, what is the resilience indicator?</strong></p>
<p>The answer is <span class="math notranslate nohighlight">\(p\)</span>. But how to compute resilience of a particular organism with it. Assuming that resilience has to decrease with age, it is enough to estimate <span class="math notranslate nohighlight">\(1/\sigma_p(t)\)</span> in a particular moment of time. If the variance of indicator is high - the organism is non resilient.</p>
</section>
</section>
<section id="conclusion">
<h2><a class="toc-backref" href="#id29"><span class="section-number">13.5. </span>Conclusion</a><a class="headerlink" href="#conclusion" title="Permalink to this headline">#</a></h2>
<p>This chapter has been entirely devoted to developing an intuition about how aging can be perceived through the lens of the criticality and resilience of systems.</p>
<p>We have studied the very foundations of the theory of dynamical systems, got acquainted with their one-dimensional and multidimensional incarnations. We saw how multidimensional ones can be reduced to one-dimensional ones, the stability of which is much easier to study.</p>
<p>In addition, we have learned to better understand the language of complex systems by linking its most important concepts (criticality, bifurcation, phase transition, network, etc.) with mathematical counterparts. It is good to understand this new language, but it is important to use it. If possible, try to model biological processes explicitly, instead of just saying “associated”, “correlates”, “induces”.</p>
<p>Be quantitative, numerical relationships between variables deepen your understanding of the process. However, sometimes numbers can be confusing - don’t be a slave to numbers, think twice!</p>
</section>
<section id="learn-more">
<h2><a class="toc-backref" href="#id30"><span class="section-number">13.6. </span>Learn More</a><a class="headerlink" href="#learn-more" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://www.youtube.com/playlist?list=PLcv1wv7ZF5IXWunUDAiQym866-MntorVp">Principles of Biological Design (Lectures)</a> <br />
<a class="reference external" href="https://link.springer.com/book/10.1007/978-3-319-78145-7">Dynamical Systems with Applications using Python</a> <br />
<a class="reference external" href="https://www.amazon.com/Introduction-Systems-Biology-Mathematical-Computational/dp/1584886420">An Introduction to Systems Biology. Design Principles of Biological Circuits</a> <br />
<a class="reference external" href="https://www.amazon.com/Modeling-Life-Mathematics-Biological-Systems/dp/3319597302">Modelling Life</a></p>
</section>
<section id="credits">
<h2><a class="toc-backref" href="#id31"><span class="section-number">13.7. </span>Credits</a><a class="headerlink" href="#credits" title="Permalink to this headline">#</a></h2>
<p>This notebook was prepared by <a class="reference external" href="https://scholar.google.com/citations?user=Wo9H1f4AAAAJ&amp;hl=ru">Dmitrii Kriukov</a>.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./dyn"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="complex_systems.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">12. </span>Complex systems approach</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../projects/2023/dosi/report.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Dynamic Organism State Indicator</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Kriukov Dmitrii<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>